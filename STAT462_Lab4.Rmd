---
title: "Lab 3: Scatterplots"
subtitle: <h5 style="font-style:normal">STAT-462 - Regression Analysis</h4>
author: <h5 style="font-style:normal">Dr Helen Greatrex</h4>
output: 
  html_document:
    toc: true 
    toc_depth: 4
    toc_float:
      collapsed: no
    number_sections: no
---


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 0px;
border-radius: 5px;
font-style: normal;
}

h1.title {
  font-weight: bold;
  font-family: Arial;  
}

h2.title {
  font-family: Arial;  
}

</style>


<style type="text/css">
#TOC {
  font-size: 12px;
  font-family: Arial;
}
</style>


\


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message = FALSE)
library(tidyverse)
library(dplyr)
library(ggpubr)
library(skimr)
library(ggplot2)
library(plotly)
library(ISLR)
library(equatiomatic)
library(olsrr)
library(Stat2Data)
library(readxl)
library(corrplot)
data("HousesNY")

```

# Learning objectives 


**It's nearly spring break, so this lab is one big code showcase to get comfortable with the commands**.

By the end of this week's lab, you will be able to:

1. Feel comfortable reading in and filtering datta
2. Feel comfortable with the core regression commands.
3. Look at LINE assumptions

<br>

<p class="comment">**Assignment 4 is due by midnight before spring break.**   [See here]https://psu.instructure.com/courses/2174925/assignments/13762818) I PROVIDE HELP UNTIL THE END OF NEXT WEEK'S LAB (after next week's lab (All of Wed night/Thurs/Fri) is for your own finishing up).</p>

<br>

## I need help

1. There is a TEAMS discussion for lab help [CLICK HERE](https://teams.microsoft.com/l/team/19%3aWabo92vghie-p1jKkmYOGJIOPMUExkoPb0JQMb_9dgw1%40thread.tacv2/conversations?groupId=bbc92dcc-56df-48e6-8da3-5cd766908eeb&tenantId=7cf48d45-3ddb-4389-a9c1-c115526eb52e).  Remember to include a screenshot of the issue and a short description of the problem.  Also try googling the error first.

2. Every time you re-open R studio check you are using your project file (does it say Lab 4 at the top?).  

3. EVERY TIME YOU RE-OPEN R-STUDIO YOU NEED TO RE-RUN **ALL** YOUR CODE CHUNKS.  The easiest way to do this is to press the "Run All" button (see the Run menu at the top of your script)

4. **If the labs are causing major problems or your computer hardware is struggling (or you have any other software issue), Talk to Dr Greatrex**. We can fix this and there are other free/cheap options for using R online.
 


<br>  

# STEP1: Lab set-up. DO NOT SKIP!

<br>

## 1a. Get set up

1. Create a new project for Lab 4.  If you are stuck, see previous labs or [Tutorial 2.1](https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#21_Projects).

<br>

2. Copy your lab templae to your lab 4 folder, **rename as  STAT-462_Lab4_EMAILID.Rmd** (e.g.STAT-462_Lab4_hlg5155.Rmd) and open.  THIS LAB IS ONE BIG CODE SHOWCASE.  Delete all the headings/subheadings after Code Show case.  

3. In the library section of your lab report, add a new code chunk and use this code to load the following libraries. If some don't exist on your computer or on the cloud, use [Tutorial 2.3] (https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#23_Adding_a_new_package) to install/download them first.  To make sure they loaded OK, run the code chunk TWICE.  The second time any welcome text will disappear unless there are errors.

```{r, eval=FALSE}
library(tidyverse)
library(dplyr)
library(ggpubr)
library(GGally)
library(skimr)
library(ggplot2)
library(plotly)
library(equatiomatic)
library(olsrr)
library(Stat2Data)
library(readxl)
```

Finally, press knit to check the html works and it looks like this (with your theme)

```{r, echo=FALSE, fig.align='center'}
knitr::include_graphics("./Figures/Lab4_fig1.png")
```

<br>
<br>

# STEP 2: Code showcase

This lab is a series of mini challenges.  For each challenge, please add a new sub-heading to make it easy to grade.

*You might want to make a second .Rmd file to practice the tutorials, so you can save your practice but only write up what is needed in your report*

You will need the code from these NEW TUTORIALS:

 - Reading in data.  
 - Filtering/choosing/sub-setting data


## Challenge 1: Leaf Analysis

The aim of this question is to support you with some of the learning objectives of question 4 in the exam.

```{r, include=FALSE}
data(LeafWidth)
```

1. Use the data command to load the `LeafWidth` dataset(make sure you have run the library code chunk first).  Look at the helpfile for the dataset to understand what you are looking at and what the column names mean. In hte text, identify the *specific* unit of analysis. 

```{r, include=FALSE}
boxplot(LeafWidth$Year)
boxplot(LeafWidth$Length)
shapiro.test(LeafWidth$Year)
shapiro.test(LeafWidth$Length)
```


You are looking at two variables:
  a. Year the leaves were collected
  b. Average length of each leaf (in mm)

2. For **BOTH of the two variables above**

   a. Create a professional looking boxplot. <br>
   b. Below the boxplot, write whether you believe the variable is likely to be Normally distributed and why.   <br>
   c. Add a guess of a p-value in a Wilks Shapiro. (you are not graded on whether your answer is 'correct')  <br>
   c. After looking at the boxplots, write on which variable you *believe* will be Normal (if any) with a significance of 5% and why. <br>
   d. Formally assess the normality of the variable using a wilks shapiro test at a critical value of 5%.  Include your H0, H1 and your conclusions. Write a comment on whether the result matches your guess.  (you could also have a look at a histogram).  <br>
   
3. Is the Wilks Shapiro test one-sided or two-sided? (google it!)   

4. Someone adds a new leaf to the dataset.  Calculate the range of lengths are you 99% sure the new leaf will have.  

5. Someone collects a whole new sample from your population.  Given your data, what is your estimate of their average leaf length, with a 95% level of certainty.

6. Given the Wilks-Shapiro test results in [2], would it have been appropriate to calculate the ranges from [4] and [5], but using variable as skewed as the year the leaves were collected? Explain your answer. (Hint Lecture 9)


## Challenge 2: Filtering Data

signdist.txt





















# STEP 3: Show me something new

Remember that an A is 94%, so you can ignore this section and still easily get an A. But here is your time to shine. Also, if you are struggling in another part of the lab, you can use this to gain back points.

**To get the final 4 marks in the lab, you need to show me something new, e.g. you need to go above and beyond the lab questions in some way.** 

 - You get 2/4 for doing something new in any way BEYOND THE LAB INSTRUCTIONS/CODE
 - You get 4/4 for something really impressive or multiple small things.
 - You must tell us in your R script what you did!   

Here are some ideas:

 - You found a cool new plot from R graph gallery or flowingdata.com and made it work
 - You did something neat in Markdown such as embedding a pdf
 - You found a new package/command that did something relevant
 - You found something cool on data camp and applied it here
 - You tweaked your mapping/plotting code to be better

<br>
<br>

# Submitting your Lab

Remember to save your work throughout and to spell check your writing (next to the save button). 

Now, press the knit button for the final time. 

If you have not made any mistakes in the code then R should create a html file in your lab 2 folder which includes your answers. If you look at your lab 1 folder, you should see this there - complete with a very recent time-stamp.

In that folder, double click on the html file.  This will open it in your browser. CHECK THAT THIS IS WHAT YOU WANT TO SUBMIT.

If you are on R studio cloud, see Tutorial 1 for how to download your files

Now go to Canvas and submit BOTH your html and your .Rmd file in Lab 2.

```{r, echo=FALSE}
knitr::include_graphics("./Figures/Lab1_Basics_2022_fig1.png")
```

<br>

# Grading Rubric/checklist

See the table below for what this means - 100% is hard to get!

**HTML FILE SUBMISSION - 8 marks**

**RMD CODE SUBMISSION - 8 marks**

**WRITING/CODE STYLE - 10 MARKS**

Your code and document is neat and easy to read. LOOK AT YOUR HTML FILE IN YOUR WEB-BROWSER BEFORE YOU SUBMIT.  There is also a spell check next to the save button.  

You have written your answers below the relevant code chunk in full sentences in a way that is easy to find and grade. For example, you have written in full sentences, it is clear what your answers are referring to. You have used units and explained your workings. 
    
**MARKDOWN SHOWCASE: 10 MARKS** 

You use full sentences and units, You have great Markdown formatting

**R-CODE SHOWCASE: 20 MARKS** 

**UNIVARIATE: 20 MARKS** 

**BIVARIATE: 20 MARKS** 

You have managed to successfully complete all the code challenges
 
**Above and beyond: 4 MARKS**
 
See above for ideas on grading

[100 marks total]


Overall, here is what your lab should correspond to:

```{r, echo=FALSE}
rubric <- readxl::read_excel("STAT462_22_LRubric.xlsx")
knitr::kable(rubric) %>%   
  kable_classic_2() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive"))


```

