<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Tutorials</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">STAT-462</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="T1_R_Basics.html">Tutorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="STAT462_22_L1Basics.html">Lab 1:R-Basics</a>
    </li>
    <li>
      <a href="STAT462_Lab2.html">Lab 2: Exploratory Data Analysis (EDA)</a>
    </li>
    <li>
      <a href="STAT462_Lab3.html">Lab 3: Scatterplots</a>
    </li>
    <li>
      <a href="STAT462_Lab4.html">Lab 4: Regression Code showcase</a>
    </li>
    <li>
      <a href="STAT462_Lab5.html">Lab 5: LINE Assumptions</a>
    </li>
    <li>
      <a href="STAT462_Lab6.html">Lab 6: Outliers &amp; Transformations</a>
    </li>
  </ul>
</li>
<li>
  <a href="STAT462_LabEXAMPLE.html">LAB EXAMPLE</a>
</li>
<li>
  <a href="Worked_questions.html">Worked questions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Tutorials</h1>

</div>


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}
</style>
<div id="Tut1_WhatisR" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Accessing R &amp; Settings</h1>
<p><em>What are R and R-Studio?</em> <br> <em>How do I transfer things to and from R-Studio cloud?</em> <br> <em>What is a package and how do I install them?</em></p>
<p><br></p>
<div id="what-are-r-and-r-studio" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> What are R and R-Studio?</h2>
<p><strong>R</strong> is a free, open source statistical programming language. It is useful for data cleaning, analysis, and visualization. By a “programming language”, I mean it is a collection of commands that you can type into the computer in order to analyse and visualise data. The easiest way I find to think about R is that it is literally a language, like Spanish or Hindi, that is spoken by your computer. Learning R means learning vocabulary and grammar in order to communicate. It also means it will get easier with experience and practice..</p>
<p>When you install R on your computer, you are essentially instantly teaching your computer to “speak in R” with some very basic Notepad-like software where you can enter commands.</p>
<p><br></p>
<div class="figure" style="text-align: center">
<img src="Figures/pg_Tut1_about_fig1.png" alt="*The basic R console. You write in blue, the computer replies in black. The &gt; means it is waiting for a command*" width="80%" />
<p class="caption">
<em>The basic R console. You write in blue, the computer replies in black. The &gt; means it is waiting for a command</em>
</p>
</div>
<p><br></p>
<p>More recently, <strong>R-studio</strong> has been designed as a piece of software to make it easier to programme in R. It’s Microsoft Word is compared to notepad with many more options. For example, you can easily see help files, run code, see your output and create outputs like this lab book! R-Studio also allows us to make interactive documents called R-Markdown files.</p>
<p><br></p>
<div class="figure" style="text-align: center">
<img src="Figures/pg_Tut1_about_fig2.png" alt="*R-studio is much more sophisticated*" width="1424" />
<p class="caption">
<em>R-studio is much more sophisticated</em>
</p>
</div>
<p><br></p>
<p>To learn more about R studio, see here: <a href="https://www.rstudio.com/products/rstudio/" class="uri">https://www.rstudio.com/products/rstudio/</a> (1 minute video), or a slightly longer one here:</p>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/SdMPh5uphO0" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><br> <br></p>
</div>
<div id="accessing-r-r-studio" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Accessing R &amp; R-Studio</h2>
<p>For this course you will need TWO pieces of software, one called R and one called R studio. You have four options:</p>
<ul>
<li>Installing on your own computer (free and recommended)</li>
<li>R-Studio Cloud - you can access R studio online, but only a certain number of hours are free</li>
<li>The Penn State TLT server: (Not recommended as often crashes and loses work)</li>
<li>Lab computers (not recommended, they are out of date and R will fill up your U-Drive)</li>
</ul>
<p>More details here for each of them:</p>
<p><br></p>
<div id="Tut1Ba_Desktop" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> On your computer</h3>
<p>R is free and having it on your own computer will give you a lot more freedom to complete the labs, especially if there is social distancing later in the semester.</p>
<p class="comment">
“<strong>Your R AND R-Studio MUST be up to date, or things wont’ work</strong>. R should be a minimum of 4.1.2 (2021-11-01) –”Bird Hippie” and R-studio a minimum of Version 2021.09.1”
</p>
<p class="comment">
<strong>If you already have R and/or R-Studio, it is very important you update both of them to the most recent version. The easiest way to do this is to first uninstall both programmes, then re-install fresh.</strong> If you are worried this will affect another class, chat with Dr Greatrex before starting out.
</p>
<div id="to-install-r" class="section level4 unnumbered">
<h4 class="unnumbered">To install R:</h4>
<ol style="list-style-type: decimal">
<li><p>On a windows machine, go to: <a href="https://cloud.r-project.org/bin/windows/base/" class="uri">https://cloud.r-project.org/bin/windows/base/</a> , download R v 4.1.1 and double click to install (click next through all the options)</p></li>
<li><p>On a Mac, go to: <a href="https://cloud.r-project.org/bin/macosx/" class="uri">https://cloud.r-project.org/bin/macosx/</a> ,download the R v 4.1.1 package and double click to install (click next through all the options)</p></li>
<li><p>On anything else: <a href="https://cloud.r-project.org/bin" class="uri">https://cloud.r-project.org/bin</a></p></li>
</ol>
</div>
<div id="to-install-r-studio" class="section level4 unnumbered">
<h4 class="unnumbered">To install R-Studio:</h4>
<ol style="list-style-type: decimal">
<li><p>Go to the website here: <a href="https://www.rstudio.com/products/rstudio/download/#download" class="uri">https://www.rstudio.com/products/rstudio/download/#download</a> and download the version for your operating system.</p>
<p><em><strong>For Windows Users</strong>: Sometimes R asks you to download something called RTools. You can ignore this request as it is not relevant to our course. If you really want the warning to go away, you can download Rtools here <a href="https://cran.r-project.org/bin/windows/Rtools/" class="uri">https://cran.r-project.org/bin/windows/Rtools/</a> Follow the instructions closely and ask if you need support.</em></p></li>
</ol>
<p><br></p>
</div>
</div>
<div id="Tut1Bb_Cloud" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> R-studio cloud</h3>
<p>You can access both R and R-studio online without installing anything through R-studio cloud.</p>
<p>This is a website where you can log into an online version of R. and I believe is free for the first 25hrs each month. To do this, make an account at <a href="https://rstudio.cloud/plans/free" class="uri">https://rstudio.cloud/plans/free</a>.</p>
<p>You can also easily move files from the Cloud to your Desktop, so for example, you can work on the cloud during lab hours and on your desktop at home. Here’s how</p>
<p><br></p>
<div id="r-studio-cloud-to-your-computer" class="section level4 unnumbered">
<h4 class="unnumbered">R-Studio Cloud to your computer</h4>
<ol style="list-style-type: decimal">
<li>On your computer, go to your STAT462 folder (or make one!)</li>
<li>Make a subfolder named for that lab e.g. <em>Lab 1</em></li>
<li>On your browser, open your project in R-studio cloud</li>
<li>In the files quadrant/tab, select the checkbox of all the files.</li>
<li>Click Export. This will zip them into a folder. Save that into your lab folder</li>
<li>Unzip. Double click the project.RProj file to reopen your lab on your computer</li>
</ol>
<p><br></p>
<p><img src="Figures/pg_Tut1_about_fig3.png" width="1358" style="display: block; margin: auto;" /></p>
</div>
<div id="your-computer-to-r-studio-cloud" class="section level4 unnumbered">
<h4 class="unnumbered">Your computer to R-Studio Cloud</h4>
<ol style="list-style-type: decimal">
<li>On your browser, in R studio cloud make a new project and name it something relevant</li>
<li>Click the upload button</li>
<li>Navigate to the lab folder on your computer. Choose ONLY the .Rmd file(s) and any input data as appropriate (RStudio-Cloud will make the rest)</li>
<li>Click on the .Rmd file name in the files in RStudio and you’re good to go</li>
</ol>
<p><br></p>
<p><img src="Figures/pg_Tut1_about_fig4.png" width="1453" style="display: block; margin: auto;" /></p>
<p><br></p>
<p><img src="Figures/pg_Tut1_about_fig5.png" width="70%" /></p>
<p><br></p>
<p><img src="Figures/pg_Tut1_about_fig6.png" width="70%" /></p>
<p><br> <br></p>
</div>
</div>
<div id="Tut1Bc_Campus" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Lab computers/TLT server</h3>
<p>There is a free version of R studio cloud hosted by Penn State, that you can access here: <a href="https://lat.tlt.psu.edu/home/remoteaccess/oss-web-apps/" class="uri">https://lat.tlt.psu.edu/home/remoteaccess/oss-web-apps/</a> . However, to access off campus you will need a VPN and it can be buggy and crash. Be warned and talk to Dr G first.</p>
<p>The lab computers should have a recent version of R, but often the code “packages” you will later install fill up your U-drive. Equally, the version of R outside the lab room is going to be out of date and will likely cause issues. Be warned</p>
<p><em>If you go down these routes, proceed with care and talk to Dr Greatrex first</em></p>
<p><br> <br></p>
</div>
</div>
<div id="Tut2A_Settings" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Getting started</h2>
<p>Everything in this tutorial is a one-off to get R and R-studio set up.</p>
<p><strong>IMPORTANT! In an easy to access place on your computer, make a folder called STAT-462. This is where ALL your labs are going to live</strong></p>
<div id="on-your-own-computer" class="section level4 unnumbered">
<h4 class="unnumbered">On your own computer</h4>
<p><strong>Now everything is installed, open R-studio (NOT R!)</strong>.</p>
<p><br></p>
<p><img src="Figures/pg_Tut2_startup_fig1.png" width="80%" style="display: block; margin: auto;" /> <br></p>
</div>
<div id="on-r-studio-cloud" class="section level4 unnumbered">
<h4 class="unnumbered">On R-studio Cloud</h4>
<p>Create a new project (button on the top right).</p>
<p><br></p>
<p><img src="Figures/pg_Tut2_startup_fig1cloud.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="looking-around-r-studio" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Looking around R-studio</h3>
<p>You will be greeted by three panels:</p>
<ul>
<li>The interactive R console (entire left)</li>
<li>Environment/History (tabbed in upper right)</li>
<li>Files/Plots/Packages/Help/Viewer (tabbed in lower right)</li>
</ul>
<p><br></p>
<p><img src="Figures/pg_Tut2_startup_fig2.png" width="889" style="display: block; margin: auto;" /></p>
<p><br></p>
If you wish to learn more about what these windows do, have a look at this resource, from the Pirates Guide to R: <a href="https://bookdown.org/ndphillips/YaRrr/the-four-rstudio-windows.html" class="uri">https://bookdown.org/ndphillips/YaRrr/the-four-rstudio-windows.html</a>.<br />

<p class="comment">
If you have used R before, you might see that there are variables and plots etc already loaded**. It is always good to clear these before you start a new analysis. To do this, click the little broom symbol in your environment tab
</p>
<p><br></p>
</div>
<div id="moving-the-4-quadrants-around" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Moving the 4 quadrants around</h3>
<p>You might find you like the different quadrants in a different order. To change this, look at the menu at VERY TOP OF THE SCREEN.</p>
<ul>
<li><p>In the<code>View</code> menu, there is a <code>/Panes/Pane Layout</code> menu item, where you can move the on-screen quadrants around. I tend to like the console to be top left and scripts to be top right, with the plots and environment on the bottom - but this is personal choice.</p></li>
<li><p>There should also be a menu called <code>Help</code><br>Useful for R-studio version and Markdown cheatsheets.</p></li>
</ul>
<p><br></p>
</div>
<div id="changing-a-few-settings-lab-1-important" class="section level3" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Changing a few settings (LAB 1 IMPORTANT)</h3>
<p>R-studio wants to be helpful and will try to re-load exactly where you were in a project when you log back in. This can get confusing, so we are going to turn this off.</p>
<ul>
<li><p><strong>ON A MAC:</strong> Click on the R-studio menu button on the top left of the screen, then click Preferences.</p></li>
<li><p><strong>ON A PC/R-Studio Cloud:</strong> Click on Tools-&gt; Global Options -&gt; Preferences</p></li>
</ul>
<p>Now:</p>
<ul>
<li>UNCLICK “Restore most recently opened project at startup”</li>
<li>UNCLICK “Restore .RData into workspace on startup”</li>
<li>Set “Save workspace to .RData on” exit to Never</li>
<li>UNCLICK “Restore previously open source documents on startup”</li>
<li>You can also click the appearances tab to change how the screen looks.</li>
</ul>
<p><br> <br> <br></p>
</div>
</div>
</div>
<div id="Tut2C_Project" class="section level1" number="2">
<h1><span class="header-section-number">2</span> R-Projects &amp; Packages</h1>
<div id="projects" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Projects</h2>
<p class="comment">
<strong>You need to make a new project before you start EVERY lab!</strong>
</p>
<p>An R-project is a special folder that will store everything to do with each lab in one place on your computer. This is incredibly useful - it means that if you switch from R-Cloud, to the lab computers, to your laptop, all you have to do is to move the folder and everything will just work. Learn more here.</p>
<p><a href="https://www.linkedin.com/learning/learning-the-r-tidyverse/why-should-you-use-projects-in-rstudio?u=76811570" title="Why use R Projects"><img src="Figures/pg_Tut2_startup_fig3.png" alt="Rproject" /></a></p>
<p><br> <br></p>
<div id="Tut2Bb_CreateRproj" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Creating an R-project</h3>
<p>This step is needed for EVERY lab.</p>
<div id="on-r-studio-cloud-1" class="section level5" number="2.1.1.0.1">
<h5><span class="header-section-number">2.1.1.0.1</span> <strong>On R-Studio Cloud:</strong></h5>
<p>Note, if you are running R-Studio Cloud, you just need to click “Create Project” and name it.</p>
<p><br></p>
</div>
<div id="on-your-desktop" class="section level5" number="2.1.1.0.2">
<h5><span class="header-section-number">2.1.1.0.2</span> <strong>On your desktop</strong></h5>
<p><img src="Figures/pg_Tut2_startup_fig1.png" width="60%" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: decimal">
<li>If it’s not already open, open <strong>R-Studio</strong></li>
<li>Go to the file menu at the very top and click <code>New Project</code></li>
<li>Select <code>New Directory</code>, then <code>New Project</code></li>
<li>Name your project <em>STAT462-Lab1-PROJECT</em></li>
<li>Under “create project as a subdirectory of”, hit the browse button and go inside your STAT-462 main folder (you just need to be in the folder, you don’t need to have selected anything). Press open</li>
<li>Finally, press <code>Create Project</code></li>
</ol>
<p><img src="Figures/pg_Tut2_startup_fig4.png" width="660" /></p>
<p><br></p>
</div>
</div>
<div id="Tut2Bc_signsRproj" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> How do I know it has worked?</h3>
<p>R will change slightly. If you look at the top of the screen in the title bar, it should say <em>STAT462-Lab1-Project R Studio</em>.</p>
<p>The Files tab should have gone to your project folder. Essentially, R-Studio is now “looking” inside your Lab 1 folder, making it easier to find your data and output your results.</p>
<div class="figure">
<img src="Figures/pg_Tut2_startup_fig5.png" alt="Note, in this book you might see a few GEOG-364s instead of STAT-462s" width="845" />
<p class="caption">
Note, in this book you might see a few GEOG-364s instead of STAT-462s
</p>
</div>
<p><br></p>
<p>Essentially, R-Studio is now “looking” inside your Lab 1 folder, making it easier to find your data and output your results.</p>
<p>If you want one, final check, try typing this into the console (INCLUDING THE EMPTY PARANTHESES/BRACKETS), press enter and see if it prints out the location of Lab 1 on your computer. If not, talk to an instructor.</p>
<pre class="r"><code>getwd()</code></pre>
<p><br></p>
</div>
<div id="returning-to-your-lab-project" class="section level3" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Returning to your lab project</h3>
<p>OK, let’s imagine that you get halfway through your lab and your computer dies. How do you get back to your Lab work? Try this now. Close down R-Studio.</p>
<p>To reopen a lab:</p>
<ol style="list-style-type: decimal">
<li><strong>DO NOT RE-OPEN R-STUDIO!</strong></li>
<li>Instead navigate on your computer to your <em>STAT-462/STAT462-Lab1-Project</em> folder.<br />
</li>
<li>Double click on the STAT462-Lab1-Project.RProj file.</li>
</ol>
<p>This will reopen R for that specific lab, so you can continue where you left off.</p>
<p>It means you can also open several versions of R studio for multiple projects, which can be very useful in keeping labs separate and staying sane.</p>
<p><img src="Figures/pg_Tut2_startup_fig6.png" width="961" /></p>
<p><br> <br></p>
</div>
</div>
<div id="Tut2_Packages" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> R-Packages</h2>
<div id="Tut2Ba_whatarethey" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> What are packages?</h3>
<p>As described earlier, we program in R by typing a series of commands. R is open source meaning anyone can create a new one, so over the last 20 years,tens of millions of new custom commands have been created.</p>
<p>Commands tend to be grouped together into collections called <code>Packages</code> or <code>Libraries</code> (two names for the same thing). For example, one package contains the complete works of Shakespeare; another allows interactive website design; another allows advanced Bayesian statistics. There is a package for literally everything and there are now about 20,000 packages available. You can see the full list here: <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html" class="uri">https://cran.r-project.org/web/packages/available_packages_by_name.html</a></p>
<p>This is far too many to store on your computer, so most live on the internet in an online (free) “Package Store”. You can download the ones you want, ready to load later.</p>
<p>So to access the commands in a package we need these two steps:</p>
<ol style="list-style-type: decimal">
<li>ONCE ONLY: Download the package from the internet</li>
<li>EVERY TIME: Load the packages you want</li>
</ol>
<p class="comment">
<strong>A close analogy is your phone:</strong> There are millions of apps available from banking, to 50 different calendar apps. You don’t have every app in the world installed on your phone - and you don’t have every app you <em>do</em> download running at the same time. Instead you download the apps that you think you will need (occasionally downloading a new one on the fly) - and when you need to use an app, you click on it to open.
</p>
<p><br> <br></p>
</div>
<div id="Tut2Bc_fulllist" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> LAB 1: Bulk download main packages</h3>
<p>Now we are going to download most of the packages you need for these labs so that you do not need to do this each week.</p>
<p><strong>Copy these command into the R-CONSOLE and press enter to run</strong>.</p>
<pre class="r"><code>install.packages(c(&quot;tidyverse&quot;,&quot;abind&quot;,&quot;car&quot;,&quot;corrplot&quot;,
                  &quot;ggpubr&quot;,&quot;ggstatsplot&quot;,&quot;ggpubr&quot;,&quot;IMTest&quot;,&quot;MASS&quot;,&quot;nortest&quot;,
                  &quot;hrbrthemes&quot;, &quot;ISLR&quot;,&quot;knitr&quot;, &quot;kableExtra&quot;,&quot;lattice&quot;,&quot;matlab&quot;,
                  &quot;olsrr&quot;, &quot;plotly&quot;,&quot;RColorBrewer&quot;,&quot;readxl&quot;,&quot;remotes&quot;,
                  &quot;rmdformats&quot;,&quot;skimr&quot;, &quot;stargazer&quot;,
                  &quot;Stat2Data&quot;,&quot;units&quot;,&quot;viridis&quot;,&quot;yarrr&quot;))</code></pre>
<p>When you press enter, a load of text should stream down your console. Just let it run until the console is back to the &gt; symbol and you can type. It might take several minutes. Sometimes this will give you an error and not run, This can be because copy/pasting from the internet messes up the quote marks around each package name. In that case, you can easily manually download them by clicking the INSTALL button at the top of the packages tab, then choosing each name in turn.</p>
<pre class="r"><code># Sometimes you need to install a package from a different place, like github. 
# To do this you use a more complex command, we should not need this
# remotes::install_github(&quot;ropensci/USAboundariesData&quot;)</code></pre>
<p>When all the download text is streaming down your screen, it’s hard to know what is an error and what is just “informative”. The easiest way to check is to load all the libraries at once and see whether there are errors. This is the same as clicking every app on your phone to see if they all installed OK.</p>
<p>Copy the code below into the console TWICE. E.g.</p>
<ol style="list-style-type: decimal">
<li>Copy the commands into the console once and press enter to run, wait until it stops running (it will show a load of “welcome” text again that makes it hard to see errors).<br />
</li>
<li>The SECOND time you copy it into the console, it should just run without error or messages.</li>
</ol>
<p>You can select and copy across the whole thing, you don’t need to go line by line. If you have issues, talk to Dr G.</p>
<pre class="r"><code>library(&quot;tidyverse&quot;)
library(&quot;abind&quot;)
library(&quot;car&quot;)
library(&quot;corrplot&quot;)
library(&quot;ggpubr&quot;)
library(&quot;ggstatsplot&quot;)
library(&quot;ggpubr&quot;)
library(&quot;ISLR&quot;)
library(&quot;kableExtra&quot;)
library(&quot;knitr&quot;)
library(&quot;hrbrthemes&quot;)
library(&quot;lattice&quot;)
library(&quot;olsrr&quot;)
library(&quot;plotly&quot;)
library(&quot;RColorBrewer&quot;)
library(&quot;readxl&quot;)
library(&quot;remotes&quot;)
library(&quot;rmdformats&quot;) 
library(&quot;skimr&quot;) 
library(&quot;stargazer&quot;)
library(&quot;Stat2Data&quot;) 
library(&quot;units&quot;) 
library(&quot;viridis&quot;) 
library(&quot;yarrr&quot;)</code></pre>
<p><br> <br></p>
</div>
</div>
<div id="adding-a-new-package" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Adding a new package</h2>
<p>This is a TWO STEP PROCESS</p>
<ol style="list-style-type: decimal">
<li>You need to download it from the internet (like buying a phone app)</li>
<li>You need to tell the computer you want to use the commands in that package (like clicking on the icon to start the app)</li>
</ol>
<p>More details here:</p>
<p><br></p>
<div id="Tut2Bb_howtodownload" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> How to Download/Install a new package</h3>
<p>Look at the Packages tab next to the plot one, you can see which packages/libraries are already pre-installed onto your computer.</p>
<p>If the package you want isn’t listed then you need to download it from the internet (as a one-off), like buying it from the app store</p>
<ul>
<li>Click the INSTALL button in the Packages tab, then start typing the package name and it will show up (check the include dependencies box).</li>
</ul>
<p>OR</p>
<ul>
<li><p>IN THE CONSOLE! Run the <code>install.packages()</code> command on the package you want to download <strong>with quotes around the package name</strong> e.g. </p>
<pre class="r"><code>install.packages(&quot;bardr&quot;)</code></pre></li>
</ul>
<p>OR</p>
<ul>
<li>R will sometime tell you that you are missing a package (sometimes a little yellow ribbon), click yes to install!</li>
</ul>
<p><em>Note, if you run this command multiple times, or the packages is already loaded, R-Studio might want to restart and sometimes gets confused. If it keeps asking, close R-studio, reopen and try again. If it really doesn’t want to work, open R itself and run in the console there.</em></p>
<p><strong>Try installing the <code>bardr</code> package onto your computer</strong></p>
<p><br></p>
<div id="how-to-loaduse-a-package" class="section level4" number="2.3.1.1">
<h4><span class="header-section-number">2.3.1.1</span> How to LOAD/USE a package</h4>
<p>Installing a package don’t make the commands immediately available. For that you need to load it (like clicking on an app). This can be done with the <code>library()</code> command.</p>
<p>In the console type this to install the full works of Shakespeare in the bardr package (<a href="https://www.rdocumentation.org/packages/bardr/versions/0.0.9" class="uri">https://www.rdocumentation.org/packages/bardr/versions/0.0.9</a>)</p>
<pre class="r"><code>library(bardr)</code></pre>
<p>If you have managed to install a package successfully, often nothing happens - this is great! It means it loaded the package without errors. Otherwise, I suggest running this command TWICE! This is because loading packages will print “friendly messages” or “welcome text” the first time you load them.</p>
<p>For example, this is what shows up when you install the tidyverse package. The welcome text is indicating the sub-packages that tidyverse downloaded and also that some commands now have a different meaning.</p>
<div class="figure" style="text-align: center">
<img src="Figures/pg_Tut3_basics_fig4.png" alt="Tidyverse install messages" width="80%" />
<p class="caption">
Tidyverse install messages
</p>
</div>
<p><strong>To find out if what you are seeing is a friendly message or an error, run the command again. If you run it a second time and there is no error then nothing should happen.</strong></p>
<p><br></p>
</div>
</div>
<div id="how-to-force-the-computer-to-use-a-specific-package" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> How to force the computer to use a specific package</h3>
<p>Sometimes multiple packages name a command the same thing and you want to specify which package you want to use. You can do this using the :: symbol</p>
<p>For example, this command <em>forces</em> the computer to use the ‘dplyr package’ version of filter.</p>
<pre class="r"><code>dplyr::filter(mydata)</code></pre>
<p><br></p>
</div>
</div>
</div>
<div id="basic-commands" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Basic commands</h1>
<p class="comment">
You should now have R-Studio open and be inside an R project. If you’re having issues at this point or haven’t managed to get to this step, STOP! Ask an instructor for help.
</p>
<p><br></p>
<p>First watch this 5 min video above for some pointers. We will also go through the video more slowly here:</p>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/SWxoJqTqo08?start=41" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><br> <br></p>
<div id="first-steps" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> First steps</h2>
<p>Remember that the aim of programming is to provide a language so you can ask your computer to do complex tasks. The console window (see Figure @ref(fig:tut2afig2)) is like a phone call with your computer, where you “speak” in R.</p>
<ul>
<li>The computer has a little <code>&gt;</code> symbol to say it is listening/waiting for your command</li>
<li>You type in a command</li>
<li>The computer tries to carry it out and will print the answer directly onto the screen</li>
</ul>
<p>Let’s start by the simplest command possible. Try typing each of the following commands into your R console and pressing Enter</p>
<pre class="r"><code>1+1</code></pre>
<p>When you press enter, it should give you the answer…. 2</p>
<pre class="r"><code>1+1</code></pre>
<pre><code>## [1] 2</code></pre>
<p>Note that spacing does not matter: <code>1+1</code> will generate the same answer as <code>1      +       1</code>. When we get to text, capital letters DO matter.</p>
<p><br> <br></p>
</div>
<div id="saving-commands-in-scripts" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Saving commands in scripts</h2>
<p>You might wonder at this point about how to save your work.</p>
<p>Typing into console is like having a phone call with your computer; you’re talking but you’re not keeping records of what you say. To see previous commands, you can click the history tab (Environment quadrant) or press the up/down arrows on your keyboard, but when you close R, all record of these commands will be lost.</p>
<p>We need instead is a way to save the commands for future use - we can do this using scripts. There are several types of document, or script that you can create and save in R-Studio.</p>
<ul>
<li><p>A basic script (the filetype is .r). This is simply just a blank notepad where you can save code commands. When you “run” the commands in the script, R simply copy/pastes the commands over to the console.</p></li>
<li><p>An R-Notebook or R-Markdown document (the filetype is .Rmd). These are much more interesting - and are how I wrote this lab book. We will be getting to these later in the lab</p></li>
</ul>
<p><br></p>
<div id="creating-a-basic-r-script" class="section level4 unnumbered">
<h4 class="unnumbered">Creating a basic R script</h4>
<p>For now, let’s just create a basic R script. Go to the File menu at the very top of the screen, then new file / new script.</p>
<p>This will add a new window - which is simply a notepad file you can save. If you type your commands in there, you can save them. You run them in the console by highlighting the text on each line and pressing Ctrl-Enter (or command enter on a mac).</p>
<div class="figure" style="text-align: center">
<img src="Figures/pg_Tut3_basics_fig4b.png" alt="Running commands in a basic script" width="1250" />
<p class="caption">
Running commands in a basic script
</p>
</div>
<p>You now have a space where you can save the work below if you wish. YOU DO NOT NEED TO SUBMIT THIS. You are also welcome to simply enter the commands in the console.</p>
<p><br> <br></p>
</div>
</div>
<div id="Tut3B_Calc" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> R as a calculator</h2>
<p>When using R as a calculator, the order of operations is the same as you would have learned back in school, so use brackets to force a different order. For example, in either the console or a script, try running these two commands</p>
<pre class="r"><code>3 + 5 * 2</code></pre>
<p>and</p>
<pre class="r"><code>(3 + 5) * 2</code></pre>
<p><br></p>
<p>We can also take shortcuts with our numbers. For example <code>1:5</code> means take all the numbers <code>1 2 3 4 5</code> (e.g. increment the integers one - to - five). Try typing this command and make sure you understand the result.</p>
<pre class="r"><code>(1 + 2) * 5:3</code></pre>
<pre><code>## [1] 15 12  9</code></pre>
<p><br></p>
<p>We can use this trick to make our first plot! Try entering this command and see what happens. It should plot these numbers against each other</p>
<pre><code>##   x  y
## 1 1  6
## 2 2  7
## 3 3  8
## 4 4  9
## 5 5 10</code></pre>
<pre class="r"><code>plot(x= 1:5, y= 6:10,xlab=&quot;x-axis&quot;,ylab=&quot;y-axis&quot;)</code></pre>
<p><br> <br></p>
</div>
<div id="asking-questionscomparisons" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Asking questions/comparisons</h2>
<p>We can also do comparisons in R - using the special symbols TRUE or FALSE (no quote marks, they are special).</p>
<p>Here we are asking R whether 1 is equal to 1.</p>
<pre class="r"><code># note two equals signs is read as &quot;is equal to&quot;
1 == 1  </code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>We could also have used</p>
<ul>
<li><code>!=</code> “Not equal to”</li>
<li><code>&lt;</code> “Less than”</li>
<li><code>&lt;=</code> “Less than or equal to`</li>
<li><code>&gt;</code> “Greater than”</li>
<li><code>&gt;=</code> “Greater than or equal to”</li>
</ul>
<p>Now ask the computer if the number 12 is less than or equal to the number 10.</p>
<p><br> <br></p>
</div>
<div id="Tut3C_plus" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> The + symbol in the console</h2>
<p>If you type in an incomplete command, R will understand and wait for you to complete it. For example, if you type <code>1 +</code> and press enter, R will know that you are not finished typing. So it will move onto the next line but the <code>&gt;</code> will have changed into a <code>+</code>, which means its waiting for you to complete your command.</p>
<p><strong>If you want to cancel a command you can simply hit the “Esc” key or press the little stop symbol and R studio will reset.</strong></p>
<p>Pressing escape isn’t only useful for killing incomplete commands: you can also use it to tell R to stop running code (for example if it’s taking much longer than you expect), or to get rid of the code you’re currently writing.</p>
<p><br> <br></p>
</div>
<div id="Tut3D_functions" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Functions/Commands</h2>
<p>Watch this short video to learn three important facts about functions:</p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/220490105 " width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>The power of R lies in its many thousands of these built in commands, or <em>functions</em>. In fact, we have already come across one - the plot command. A function, or command is simply an action you can take - like pressing the square root button on a calculator.</p>
<p><strong>A command is <em>always</em> followed by parentheses ( ), inside which you put your “arguments”</strong> (e.g. the thing you want to take the square root of)</p>
<p>Try typing these EXACTLY into the console.</p>
<ul>
<li><code>nchar("hello")</code>
<ul>
<li>This will count the number of letters in the word “hello” (e.g. 5)</li>
</ul></li>
<li><code>file.choose()</code>
<ul>
<li>This will open up an interactive window (sometimes behind the studio screen), choose any file and it will print the location in the console. NOTE WE STILL NEED THE PARENTHESES, but there are no arguments so they are empty.</li>
</ul></li>
</ul>
<p>To understand what I mean about parentheses, try typing each of these commands exactly and see what happens.</p>
<pre class="r"><code># Typing this into the console will print out the underlying code
file.choose 

# Typing it WITH parentheses will run the command. Note for this command, the parentheses are empty!  
file.choose()

# Typing a ? in front will open the help file for that command in the help quadrant
?file.choose</code></pre>
<p>Sometimes we need to give the command some additional information as an argument. Anything we wish to tell the command should be included inside the inside the parentheses (separated by commas). The command literally only knows about the stuff inside the parentheses.</p>
<pre class="r"><code>sin(1) # trigonometry functions.  Apply the sine function to the number 1. 

log(10) # natural logarithm.  Take the natural logarithm of the number 10. 

nchar(&quot;hello&quot;) # Count the letters in the word hello</code></pre>
<p>We can also add optional extra arguments. For example let’s improve our plot. This following command will plot the number 1 to 10 against the numbers 12 to 20, along with some axis labels. When you run this, the plot will show up in the plots tab.</p>
<pre class="r"><code># plot the numbers 1 to 10 against the numbers 11 to 20
plot(1:10,11:20,col=&quot;dark blue&quot;, xlab=&quot;x values&quot;,ylab=&quot;STAT-462 is the best&quot;) </code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>If you are feeling lost, <a href="https://swcarpentry.github.io/r-novice-gapminder/01-rstudio-intro/" class="uri">https://swcarpentry.github.io/r-novice-gapminder/01-rstudio-intro/</a> is a good website which goes over a lot of this in more detail.</p>
<p><br> <br></p>
</div>
<div id="Tut3E_text" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Dealing with text</h2>
<p>In R, the computer interprets most words as commands. But sometimes we need to actually input text, for example for a plot title. <strong>For the computer to understand text, you need quote marks</strong>. The computer will see anything without quote marks as a command.</p>
<p>For example, try typing <code>print("Hello World")</code> into the console and the computer should just repeat it back to you.Forget about the quotes and this happens..</p>
<div class="figure">
<img src="Figures/pg_Tut3_basics_fig3.png" alt="Your screen after running the project" width="1063" />
<p class="caption">
Your screen after running the project
</p>
</div>
<p>Your first error. The “unexpected symbol” it’s talking about is the computer thinking that “Hello” and “world” must be two different commands, then getting confused by the space between Hello and World..</p>
<p><br> <br></p>
</div>
<div id="Tut3F_vars" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Variables</h2>
<p>So now we can use R as a calculator and even add a few more complex commands. What we need to be able to do now is to save the results, or load in data so we can run more complex commands. We do this through assigning our results to a variable. By this I mean we save the results and give them a name, then in the future, instead of retyping the whole command, we simply type that name and R will recall the answer.</p>
<p>The symbol to store data into a variable is using the assignment arrow <code>&lt;-</code>, which is made up of the left arrow and a dash. You can also use the equals sign, but it can cause complications later on. Try typing this command into the console:</p>
<pre class="r"><code>x &lt;- 1/50</code></pre>
<p>Notice that pressing enter did not print a value onto your screen as it did earlier. Instead, look down at the environment tab, you should notice that an x has turned up, with the result next to it.</p>
<p>So our variable <code>x</code> is now associated with the value 0.02, or 1/50. You can print a variable on screen by typing its name, no quotes, or by using the print command. Try printing out your variable.</p>
<pre class="r"><code>x

# or

print(x)

# see what happens when you do this

print(&quot;x&quot;)</code></pre>
<p>This ‘x’ variable can be used in place of a number in any calculation that expects a number. Try typing</p>
<pre class="r"><code>log(x)

# this is now the same as 
log(1/50)</code></pre>
<p>The way R works is that first it looks for the commands on the right of the arrow. It runs all of them, calculates the result, then saves that result with the name on the left of the arrow. <strong>It does not save the command itself, just the answer.</strong> For example, in this case, R has no idea that <code>x</code> was created using maths, it just knows that it is equal to the number 0.02.</p>
<p>Notice also that variables can be reassigned. Type this into your console.</p>
<pre class="r"><code>x &lt;- 100
print(x)</code></pre>
<p>x used to contain the value 0.025 and and now it has the value 100.</p>
<p><em>Note, the letter x isn’t special in any way, it’s just a variable name. You can replace it with any word you like as long as it contains no spaces and doesn’t begin with a number</em>.</p>
<p>for example</p>
<pre class="r"><code>vlogbrothers.DFTBA &lt;- &quot;Dont forget to be awesome&quot;
print(vlogbrothers.DFTBA)</code></pre>
<p>How you name stuff is up to you, , but be consistent. Different people use different conventions for long variable names, these include</p>
<ul>
<li>periods.between.words.1 (as you can see, I like this)</li>
<li>underscores_between_words</li>
<li>camelCaseToSeparateWords</li>
</ul>
<p>Finally, R IS CASE SENSITIVE. X and x are different variables! Try these and you will see both appear separately in your environment tab.</p>
<pre class="r"><code>h &lt;- 1
H &lt;- 2

ans &lt;- h+H
print(ans)</code></pre>
<pre class="r"><code>print(h)</code></pre>
<pre class="r"><code>print(H)</code></pre>
<p>To delete a variable, you can use the <code>rm()</code> command e.g.</p>
<pre class="r"><code>rm(x)</code></pre>
<p>and to clear everything, type</p>
<pre class="r"><code>rm(list=ls())</code></pre>
<div id="combining-variables" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Combining variables</h3>
<p>As I showed above, you can now use multiple variables together in more complex commands. For example, try these commands:</p>
<pre class="r"><code>x &lt;- 2

#Take the variable x, add 1 then save it to a new variable called y
y &lt;- x + 1 

# print the multiple of 2yx onto the screen
print(2*y*x)</code></pre>
<p>Now you can see that there are two variables in your environment tab, x and y. Where y is the sum of the contents of x plus 1.</p>
<p>You can even use this to change your original variable . Try typing the code below in a few times into the console and see what happens.</p>
<p><strong>A short cut to do this is to type the commands the first time, then use the up-arrow on your keyboard to cycle back through previous commands you have typed</strong></p>
<pre class="r"><code>x &lt;- x + 1 # notice how RStudio updates its description of x in the environment tab
x          # print the contents of &quot;x&quot; onto the screen</code></pre>
<p>Our variables don’t have to be numbers. They could refer to tables of data, or a spatial map, or any other complex thing. We will cover this more in future labs.</p>
<p><br> <br></p>
</div>
</div>
</div>
<div id="Tut4a_WhatIsIt" class="section level1" number="4">
<h1><span class="header-section-number">4</span> R-Markdown</h1>
<p>Typing console is a phone call to the computer, you’re talking but you’re not keeping records of what you say (you can always press the up key to see previous commands but that’s about it). When you close R, everything you have done will be lost. As you might have seen, a basic R script is only one step better!</p>
<p>In this course we are going to focus on the R-Markdown format and you are going to submit your labs as websites/html files along with your code.</p>
<p>Markdown is cool.</p>
<p>Imagine a normal Microsoft Word document, but halfway through you can press a button and a mini R console appears. You type your code inside the mini console, it runs and puts the plots/output just below - then you leave the console and continue writing about the results. Essentially you never have to take another screenshot of results and move it to your output… Rmd files are also flexible. You can turn them into reports, websites, blogs, presentations or applications with a few short commands.</p>
<p>Read more here: <a href="https://rmarkdown.rstudio.com" class="uri">https://rmarkdown.rstudio.com</a> or watch this short video</p>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/178485416" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p><br> <br></p>
<div id="Tut4B_MarkCreate" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Creating a markdown document</h2>
<p>Save your R-script to your Lab 1 folder and close it.</p>
<p>Time to make your own. Go to the File menu on the top left, then click New File - <strong>R-Markdown</strong>. If this is your first time ever, it might ask to download some packages to be able to do this. Say yes.</p>
<p>Eventually a window will open up:</p>
<p><img src="Figures/pg_Tut4_markdown_fig1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>It will ask you to name and save your file. Give it a relevant name. A new file should appear on your screen. At the top of that window (by the knit button, there is a save button. Save it as something relevant INSIDE YOUR PROJECT FOLDER!</p>
<div class="figure" style="text-align: center">
<img src="Figures/pg_Tut4_markdown_fig2.png" alt="Yours will say STAT-462 not GEOG-364.." width="867" />
<p class="caption">
Yours will say STAT-462 not GEOG-364..
</p>
</div>
<p>The new file on your screen is your first markdown script. Essentially, we have some space for text, some space for code, and a space at the top of the file where we can add information about themes/styles etc.</p>
<p><br></p>
</div>
<div id="Tut4C_Basics" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Markdown Basics</h2>
<p>Your file contains some friendly text to explain what is going on, which I have annotated here. Read the file and see what it says.</p>
<p><img src="Figures/pg_Tut4_markdown_fig3.png" width="739" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="Tut4Da_knit" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Knitting</h2>
<p>The file on your screen isn’t the finished article. To see how it will look as a final version, we need to “knit” it. Go to the top of the .Rmd file, find the <code>knit</code> button. Press it (you might have to first save your script if you haven’t already, then press it again)</p>
<p>You should see that the Markdown tab “builds” your document and you get an output as a website. The html should also be saved into your project folder. For example, from my other class, here is a file with markdown and knitted output.</p>
<p><img src="Figures/pg_Tut4_markdown_fig4.png" width="1652" style="display: block; margin: auto;" /></p>
<p><br> <br></p>
</div>
<div id="Tut4E_YAML" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> YAML Code</h2>
<p>Your YAML code is the code at the top of your file in between the — lines in the figure above. Let’s zoom in</p>
<p><img src="Figures/pg_Tut4_markdown_fig5.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>Your YAML code controls how your final output looks and which type of output it becomes. For example, this could be a website (as for ours), a pdf, a presentation or app.. The basic version is very simple with a title, an author, a self entered date and that we just want a website.</p>
<p>Let’s add in more options.</p>
<p>YAML code is annoying to edit, because here, <em>spaces really do matter</em>. Everything has to be perfect or it won’t knit.</p>
<p><strong>Select everything in my code chunk here and replace your YAML with this (remember the — on line 1 and at the end).</strong></p>
<pre class="r"><code>---
title: &quot;STAT-462 TEMPLATE&quot;
author: &quot;hlg5155&quot;
date: &quot;`r Sys.Date()`&quot;
output:
  html_document:
    toc: true 
    toc_depth: 3
    toc_float:
      collapsed: no
    number_sections: yes
    theme: lumen
    df_print: paged
---</code></pre>
<p>Replace the author ID with your user name, change the title if appropriate, then click knit and see if it works.</p>
<p>The elements we just added are:</p>
<ul>
<li>The title</li>
<li>The author (note,use your ID not your name)</li>
<li>Automatically created today’s date</li>
<li>A floating table of contents</li>
<li>Numbered sections (this won’t appear until you start typing section headings)</li>
<li>The document is now in the lumen theme.</li>
</ul>
<p><br></p>
<div id="troubleshooting" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Troubleshooting</h3>
<ul>
<li><p>Note, if you copy/paste this and it doesn’t work, sometimes the quote marks copy weirdly from the internet - try deleting and retyping the quotes.</p></li>
<li><p>If it still doesn’t work.. this might be because a space is missing (especially if you typed it out).</p>
<ul>
<li>Editing YAML code can be a pain. It is very case and space sensitive.<br>For example, the spaces at the start of some lines are important and are created using the TAB KEY, not the space bar. There is one TAB key before html_notebook (which is now on a new line). There are two TAB KEYS before toc, toc_float, number_sections and theme.</li>
</ul></li>
</ul>
<p><em>Don’t continue until you can make and view your html when you press knit. If it doesn’t work, ask for help before moving on</em></p>
<p><br></p>
</div>
<div id="changing-the-theme" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Changing the theme</h3>
<p>You don’t need to choose the lumen theme. There are many other ways you can edit your markdown documents here: <a href="https://www.datadreaming.org/post/r-markdown-theme-gallery/" class="uri">https://www.datadreaming.org/post/r-markdown-theme-gallery/</a></p>
<p>To edit, replace the word lumen with the name of your chosen theme (THIS IS CASE SENSITIVE). Now click knit and see if it works.Some themes are buggy. Try a different one if it doesn’t work.</p>
<p>The themes in “Even More Themes” on the website, require you to install/load some new packages, so they need some extra work. You’re welcome to try if you have one you fell in love with!</p>
<p><nr></p>
</div>
<div id="adding-other-yaml-options" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Adding other YAML options</h3>
<p>There are many more details about different options on these websites:</p>
<ul>
<li><a href="https://bookdown.org/yihui/rmarkdown/html-document.html" class="uri">https://bookdown.org/yihui/rmarkdown/html-document.html</a></li>
<li><a href="https://rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf" class="uri">https://rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf</a></li>
</ul>
<p>If you want to get really fancy, there is an interesting package to help you design YAML code here: <a href="https://education.rstudio.com/blog/2019/10/tools-for-teaching-yaml-with-ymlthis/" class="uri">https://education.rstudio.com/blog/2019/10/tools-for-teaching-yaml-with-ymlthis/</a></p>
<p><br></p>
</div>
</div>
<div id="Tut4F_chunk" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Code chunks</h2>
<div id="Tut4Fa_basics" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Code chunk basics</h3>
<p>The grey areas on your screen are called “code chunks” (see @ref(fig:tut2afig2)). Think of them as mini consoles. You put code inside, run them, then the result ends up directly below the chunk in</p>
<p><strong>To run the code in a code chunk, Click on the little green triangle arrow at the top-right of the code chunk itself</strong> this will run all of the commands in that code chunk and put the results underneath**.</p>
<p>Try running the 3 code chunks provided by R in your example markdown document (the top one will do nothing).</p>
<p>Code chunks can be altered. For example, on line 19, delete <code>summary(cars)</code> and type <code>1+1</code>. Now press the green arrow and the new answer should appear directly under your code chunk.</p>
<p>Click in the white space at the end of the script, press enter a few times (around line 33) and press the green insert button (top right near the Run button). Insert a new R code chunk. Inside, type <code>1+2</code> and run it.</p>
</div>
<div id="Tut4Eb_options" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Editing code chunk options</h3>
<p>At the top of every code chunk, you should see the line “```{r}”.</p>
<p>Inside the curly brackets, you can add options to the code chunk for when you press knit. For example you can justify figures, change background colors, or decide if the code even displays/runs at all.</p>
<p>You can also add options in that first code chunk we have been ignoring. These will apply the options throughout the entire script. The <code>echo</code> option means “show the code as well as the output. The <code>include</code> option means show any sign of this code chunk at all in the final option (e.g. it runs it in the background).</p>
<p><img src="Figures/pg_Tut4_markdown_fig6.png" width="695" /> <br></p>
<div id="remove-all-the-welcome-text-below-the-code-chunk-that-loads-the-libraries-when-you-press-knit." class="section level4" number="4.5.2.1">
<h4><span class="header-section-number">4.5.2.1</span> Remove all the “welcome” text below the code chunk that loads the libraries when you press knit.</h4>
<p>One useful option is to remove all the “friendly text” when you load libraries and press knit. The two options we need to turn to FALSE are <code>message</code> and <code>warning</code>.</p>
<p>We could edit the specific code chunk like this</p>
<p><img src="Figures/pg_Tut4_markdown_fig7.png" width="678" /> <br></p>
<p>But.. let’s edit the global option itself. Edit the code chunk ~line 8 to look like this:</p>
<p><img src="Figures/pg_Tut4_markdown_fig8.png" width="685" /></p>
<p><br></p>
<p>Now the loading library text will still appear in your code the first time you run that code chunk, but it should disappear when you press knit.</p>
<p>Press knit and check it works!</p>
<p><em>Don’t continue until this works. If it doesn’t work, ask for help before moving on</em></p>
<p><br></p>
</div>
<div id="other-code-chunk-options" class="section level4" number="4.5.2.2">
<h4><span class="header-section-number">4.5.2.2</span> Other code chunk options</h4>
<p>There are loads here along with a nice tutorial: <a href="https://rmarkdown.rstudio.com/lesson-3.html" class="uri">https://rmarkdown.rstudio.com/lesson-3.html</a></p>
<p><br></p>
</div>
</div>
</div>
<div id="Tut4G_format" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Formatting text</h2>
<div id="markdown-visual-editor" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Markdown visual editor</h3>
<p><img src="Figures/pg_Tut4_markdown_fig8b_Visual.png" width="989" /></p>
<p>If you are not familiar with Markdown yet, or do not prefer writing Markdown code, RStudio has included a new visual editor for Markdown documents, which feels similar to traditional programs like Word. You can find the full documentation at <a href="https://rstudio.github.io/visual-markdown-editing/" class="uri">https://rstudio.github.io/visual-markdown-editing/</a></p>
<p><br></p>
<div id="writing-text-and-paragraphs---read-this" class="section level4" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Writing text and Paragraphs - READ THIS</h4>
<p>The text part of your document is anywhere outside your YAML code or a code chunk.</p>
<p>You can treat this like a Word document, allowing you to write a report around your findings.</p>
<p>Click anywhere in the “text area” (AKA in the white space), and press enter a few times. Write some text, press knit and your changes should have been incorporated.</p>
<p>IMPORTANT!</p>
<p>R is very sensitive to blank white lines. Put them everywhere. Put a blank line between paragraphs, before/after headings, before lists, before/after code chunks…. If your formatting isn’t working well, chances are there isn’t a blank line before or after it.</p>
<p><br></p>
</div>
</div>
<div id="getting-formatting-help" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Getting formatting help:</h3>
<p>There are many ways you can format the text in your markdown document, from adding headings, to bold/italic to complex html text formats.</p>
<p>I will add in a few ideas here, but there are better guides out there!</p>
<ul>
<li>I really like this reference: <a href="https://www.markdownguide.org/basic-syntax/" class="uri">https://www.markdownguide.org/basic-syntax/</a></li>
<li>Alternatively, go to the help menu AT THE TOP OF YOUR ENTIRE SCREEN. Scroll down and you will see “Markdown Quick reference”. That will open a quick reference guide on your screen.</li>
</ul>
<p><img src="Figures/pg_Tut4_markdown_fig9.png" width="50%" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="basic-text-formats" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Basic text formats</h3>
<p>There are many ways you can format the text in your markdown document, from adding headings, to bold/italic to complex html text formats.</p>
<p>Rather than click a button to turn something bold like in Word, you have to add special characters to your text to change the formatting. For example try putting * on each side of some text you want to make italic.</p>
<p>The text formatting won’t show in the text itself, you will only see the formats when you press knit.</p>
<p>br&gt;</p>
<div id="bold-and-italic" class="section level4" number="4.6.3.1">
<h4><span class="header-section-number">4.6.3.1</span> <strong>Bold</strong> and <em>italic:</em></h4>
<p>Putting stars or _ around your text will make it bold or italic (or both). To understand how, take a look at the cheatsheets. Interestingly (and annoyingly), there is no simple way to underline text. ]</p>
<p><br></p>
</div>
</div>
<div id="headings-sub-headings-tut_headings" class="section level3" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Headings &amp; Sub-headings {Tut_Headings}</h3>
<p>You can use the # symbol to make a heading</p>
<p><em>Outside</em> a code chunk, the # symbol makes a heading, AS LONG AS YOU HAVE A WHITE LINE ABOVE AND BELOW AND A SPACE AFTER THE #. Have a look at Figure @ref(fig:tut2afig2) for an example.</p>
<p>You can have nested headings e.g.</p>
<ul>
<li><code># HeadingName</code> makes a main heading,</li>
<li><code>## SubHeadingName</code> makes a subheading,</li>
<li><code>### SubSubHeadingName</code> makes a sub-sub-heading…</li>
</ul>
<p>Including headings this way allows automatic section numbering and will allow the table of contents to automatically be created. In the script itself the headings won’t show up - you will only see them when you press knit.</p>
<p>Now let’s make your first heading.</p>
<ul>
<li>Press enter a few times so you have a blank line above and below.</li>
<li>Now make a new heading by typing <code># my new heading</code> THE SPACE AFTER THE # IS IMPORTANT.</li>
</ul>
<p>Below that leave some white space and write some more text.</p>
<p><br></p>
</div>
</div>
<div id="Tut4H_photo" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Adding photos</h2>
<p>There are many ways to do this, with a FANTASTIC tutorial here if you get stuck:</p>
<p><a href="http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/" class="uri">http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/</a></p>
<p><br></p>
<p><strong>Step 1:</strong></p>
<p>Go find your picture. If it’s on the internet the easiest way is to right click on it and press “save as”, then save the jpeg or png directly into your project folder with an easy filename.</p>
<p><br></p>
<p><strong>Step 2:</strong></p>
<p>Place your picture/photo into your project folder (e.g. your Lab 3 project folder).</p>
<p><br></p>
<p><strong>Step 3:</strong></p>
<p>Make a new code chunk.<br> REMEMER TO ADD BLANK LINES ABOVE AND BELOW THE CODE CHUNK.</p>
<p><br></p>
<p><strong>Step 4</strong></p>
<p>Inside the code chunk, use the <code>knitr::include_graphics()</code> command from the knitr package.</p>
<p><img src="Figures/pg_Tut4_markdown_fig10.png" width="836" /></p>
<p>You’ll see I also added some code chunk options:</p>
<ul>
<li>echo=FALSE : don’t show the code</li>
<li>fig.align - ‘center’ : Centre align the photo when you press knit</li>
<li>out.width - ‘60%’ : Make your photo smaller or larger on the page</li>
<li>fig.cap - “your caption” : Add a caption (IN QUOTES). I used * to make mine italic.</li>
</ul>
<p>If you run the code chunk by pressing the green arrow, you will see the picture, but not things like the caption.</p>
<p>Now press knit and you should see the picture, caption and options, but not the code (if echo=FALSE is included)</p>
<p><br></p>
<p><strong>Example</strong></p>
<p>For example, here’s an example on chipmunks. The <code>chipmunk.webp</code> file is inside my project folder. (note, the file type doesn’t matter but you have to type it)</p>
<p>Here’s how it looks in my .Rmd file.</p>
<p><img src="Figures/pg_Tut4_markdown_fig11.png" width="831" /></p>
<p>and in the actual report:</p>
<div class="figure" style="text-align: center">
<img src="chipmunk.webp" alt="*Chipmunks are cool, image from: https://mymodernmet.com/chris-mcveigh-chipmunk-adventures*" width="70%" />
<p class="caption">
<em>Chipmunks are cool, image from: <a href="https://mymodernmet.com/chris-mcveigh-chipmunk-adventures" class="uri">https://mymodernmet.com/chris-mcveigh-chipmunk-adventures</a></em>
</p>
</div>
<p><strong>For more options see the tutorial: <a href="http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/" class="uri">http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/</a> </strong></p>
</div>
<div id="inline-code" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Inline code</h2>
<p>“Inline code” is where you also include snippets of R code in your report text itself. This makes it easy to update your report if your data changes and removes the chance of typos.</p>
<p>The way to set up inline code is to contain it within SINGLE little back-apostrophes (the same symbol that you see at the start/end of a code chunk). Inside the back-apostrophes you put an r to say you want the code to be run in the R language. For example:</p>
<p><img src="Figures/pg_Tut4_markdown_fig21.png" width="835" style="display: block; margin: auto;" /> Beware! R likes to add in extra symbols to be helpful.</p>
<p>When you are in the text/code editing window, it will not do the calculation; there is no way to “run” this code chunk. But when I press knit, it will automatically calculate the result from the code e.g. </p>
<p>E.g. here is some text and I also want to include the answer to the sum 3 plus 3, which is equal to 6</p>
<div id="best-practice" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Best practice</h3>
<p>You can do all the workings inside an inline code chunk, but this is a pain and it’s easy to make a mistake. Instead, I normally do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Do all the calculations I want in a normal code chunk (either visible or hidden from the reader depending on the report)</p></li>
<li><p>Make a hidden code chunk where I assign my answer to a variable and do things like round the number of digits etc. To hide the code chunk, I use the include=FALSE code chunk option.</p></li>
<li><p>Simply use the inline code chunk to print the result.</p></li>
</ol>
<p>For example</p>
<p><img src="Figures/pg_Tut4_markdown_fig22.png" width="834" style="display: block; margin: auto;" /></p>
<p>will print as :</p>
<p>The mean height of my houseplants is 3.671 cm. Without rounding, it will look a mess! e.g. 3.6713065 cm.</p>
<p>I highly recommend you use this technique instead of typing ANY numbers from your report.</p>
<p>If you need something like a p-value from a t-test, you can often get it by saving the entire test to a variable, then using the $ sign.</p>
<p>For example in your final report you might have.</p>
<p><img src="Figures/pg_Tut4_markdown_fig23.png" width="848" style="display: block; margin: auto;" /></p>
<p>which prints as:</p>
<pre class="r"><code>t.test(HousesNY$Beds,mu=3)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  HousesNY$Beds
## t = 3.6387, df = 52, p-value = 0.0006302
## alternative hypothesis: true mean is not equal to 3
## 95 percent confidence interval:
##  3.177718 3.614734
## sample estimates:
## mean of x 
##  3.396226</code></pre>
<p>The T-test statistic of my house bedroom data is 31.189, which corresponds to a p-value of 0. E.g. there is a 0% chance of seeing this result from a random sample if our H<sub>0</sub> was true and the average house had 3 beds.</p>
</div>
<div id="more-support" class="section level3" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> More support</h3>
<p>Follow these tutorial to see more about to add inline code and to practice.</p>
<ul>
<li><a href="https://bookdown.org/yihui/rmarkdown-cookbook/r-code.html" class="uri">https://bookdown.org/yihui/rmarkdown-cookbook/r-code.html</a></li>
<li><a href="https://www.njtierney.com/post/2019/07/10/jq-verbatim-inline-r/" class="uri">https://www.njtierney.com/post/2019/07/10/jq-verbatim-inline-r/</a></li>
<li><a href="https://rmarkdown.rstudio.com/lesson-4.html" class="uri">https://rmarkdown.rstudio.com/lesson-4.html</a></li>
</ul>
</div>
</div>
</div>
<div id="report-template" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Report template</h1>
<p>It is often useful to have a “template” markdown file so you don’t have to re-do all your custom formatting each time. Here we will set up a specific one for your STAT462 Labs. For this section, I advise doing everything in the standard view (E.g. don’t press the little A symbol for the pretty view)</p>
<p><strong>PART 1.</strong> When you make a new markdown file, it makes a load of friendly text explaining how to use R. We don’t need this in your report.</p>
<p>In your .Rmd, delete all the text/code below line 11. Your lab report should look like this.</p>
<p><img src="Figures/pg_Tut3_basics_fig5.png" width="1015" style="display: block; margin: auto;" /></p>
<p><br></p>
<p><strong>PART 2.</strong> Now we want to update the YAML code at the top (between the —).</p>
<p>Follow Tutorial 4.4 to understand what YAML code is and to update yours <a href="https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#44_YAML_Code" target="_blank">CLICK HERE FOR TUTORIAL 4.4</a></p>
<p>Press knit. EVERYTHING SHOULD STILL WORK. Your html output should now look like this.</p>
<p><img src="Figures/pg_Tut3_basics_fig6.png" width="1513" style="display: block; margin: auto;" /> <br></p>
<p><strong>PART 3.</strong> Customise. Now customise! You can change the theme to something you like or add in other options. Press knit to check it still works before you move on. Lots of themes in <a href="https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#44_YAML_Code" target="_blank">Tutorial 4.4</a></p>
<p><br></p>
<p><strong>PART 4.</strong> Now we want to update some <em>code chunk options</em>. For each little grey code chunk there are a load of things we can do. For example we can make it hide the code and show the output (or vica-versa), change colour, or add captions. See <a href="https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#45_Code_chunks" target="_blank">Tutorial 4.5 Code Chunks for more details:</a></p>
<p>This first code chunk shows the options we want as default for ALL code chunks. We want to add in a few additional things. Specifically we want to make it remove all the library loading messages in your final reports <br><br> Change the top code chunk so that it says this:</p>
<pre class="r"><code>knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE)</code></pre>
<p><br></p>
<p>When you press knit, nothing will happen but later on in your labs when you knit, R will still show error messages, but hide friendly warnings. <br> See <a href="https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#45_Code_chunks" target="_blank">Tutorial 4.5 Code Chunks for more details:</a></p>
<p><img src="Figures/pg_Tut3_basics_fig7.png" width="1494" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>*PART 5** Now we want to create a standard report structure. To do this we can use formal headings and sub-headings which will link into your table of contents. Read <a href="https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#46_Formatting_text" target="_blank">Tutorial 4.6.4</a> to remind yourself, or see here: <a href="https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf</a></p>
<p>To make life quick and easy, I have created the structure for you. Go to the Lab 2 Canvas page and download the file <a href="https://psu.instructure.com/courses/2174925/assignments/13762677">LAB SCRIPT TEXT.txt</a></p>
<p>Download this, then open in notepad and copy/paste everything into the TEXT AREA below your code chunk. Press knit and you should see something like this.</p>
<p><img src="Figures/pg_Tut3_basics_fig8.png" width="1678" style="display: block; margin: auto;" /></p>
<p>*PART 6** Save a new copy of your .Rmd file directly into your stat 462 folder. Now for future labs we can simply copy/paste this across.</p>
<p><br> <br> <br></p>
</div>
<div id="summarising-data" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Summarising data</h1>
<p>Here I will show a few examples for the houses dataset we were using in lectures</p>
<div id="Tut8a1_basics" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Looking at the data itself</h2>
<p>To have a look at the data there are many options. You can:</p>
<ul>
<li>click on its name in the environment tab</li>
<li>Type its name into the console or into a code chunk (e.g. for our table, type <code>piratedataset</code> into the console or a code chunk)</li>
<li>Run the command <code>View(variable_name)</code> (View is a command from the tidyverse package).<br> This will open the data in a new tab.</li>
<li>Run the command <code>head(variable_name)</code> to see the first 6 lines or so (good for quick checks)</li>
<li>Run the command <code>glimpse(variable_name)</code> to get a nice summary.</li>
<li>Run the command <code>names(variable_name)</code> to get the column names.</li>
<li></li>
</ul>
<p><br></p>
<p>For example</p>
<pre class="r"><code># Note, there are sometimes more columns to the right, use the arrow to see
head(HousesNY)</code></pre>
<pre><code>##   Price Beds Baths  Size  Lot
## 1  57.6    3     2 0.960 1.30
## 2 120.0    6     2 2.786 0.23
## 3 150.0    4     2 1.704 0.27
## 4 143.0    3     2 1.200 0.80
## 5  92.5    3     1 1.329 0.42
## 6  50.0    2     1 0.974 0.34</code></pre>
<p>To see what the column names are, you can use the <code>names(dataset)</code> command</p>
<pre class="r"><code>names(HousesNY)</code></pre>
<pre><code>## [1] &quot;Price&quot; &quot;Beds&quot;  &quot;Baths&quot; &quot;Size&quot;  &quot;Lot&quot;</code></pre>
<p>Or the glimpse command:</p>
<pre class="r"><code>glimpse(HousesNY)</code></pre>
<pre><code>## Rows: 53
## Columns: 5
## $ Price &lt;dbl&gt; 57.6, 120.0, 150.0, 143.0, 92.5, 50.0, 89.0, 140.0, 197.5, 125.1…
## $ Beds  &lt;int&gt; 3, 6, 4, 3, 3, 2, 2, 4, 4, 3, 3, 3, 3, 4, 3, 3, 4, 3, 4, 3, 4, 4…
## $ Baths &lt;dbl&gt; 2.0, 2.0, 2.0, 2.0, 1.0, 1.0, 2.0, 3.0, 2.5, 2.0, 2.0, 1.0, 2.0,…
## $ Size  &lt;dbl&gt; 0.960, 2.786, 1.704, 1.200, 1.329, 0.974, 1.029, 2.818, 2.268, 1…
## $ Lot   &lt;dbl&gt; 1.30, 0.23, 0.27, 0.80, 0.42, 0.34, 0.29, 0.21, 1.00, 0.30, 1.30…</code></pre>
<p>To see how many columns and rows there are, you can use the <code>nrow()</code> and <code>ncol()</code> commands</p>
<pre class="r"><code>nrow(HousesNY)</code></pre>
<pre><code>## [1] 53</code></pre>
<pre class="r"><code>ncol(HousesNY)</code></pre>
<pre><code>## [1] 5</code></pre>
<p><br> <br></p>
</div>
<div id="summary-statistics" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Summary statistics</h2>
<p>To look at the summaries there are a load of options. Choose your favourites:</p>
<ul>
<li><code>summary(dataset)</code></li>
<li><code>skim(dataset)</code> in the skimr package</li>
<li><code>summarize(dataset)</code> in the papeR package. This looks pretty powerful, I’m just learning it</li>
</ul>
<p>None are better or worse than others - simply choose what works for you in the moment.</p>
<pre class="r"><code>summary(HousesNY)</code></pre>
<pre><code>##      Price            Beds           Baths            Size      
##  Min.   : 38.5   Min.   :2.000   Min.   :1.000   Min.   :0.712  
##  1st Qu.: 82.7   1st Qu.:3.000   1st Qu.:1.500   1st Qu.:1.296  
##  Median :107.0   Median :3.000   Median :2.000   Median :1.528  
##  Mean   :113.6   Mean   :3.396   Mean   :1.858   Mean   :1.678  
##  3rd Qu.:141.0   3rd Qu.:4.000   3rd Qu.:2.000   3rd Qu.:2.060  
##  Max.   :197.5   Max.   :6.000   Max.   :3.500   Max.   :3.100  
##       Lot        
##  Min.   :0.0000  
##  1st Qu.:0.2700  
##  Median :0.4200  
##  Mean   :0.7985  
##  3rd Qu.:1.1000  
##  Max.   :3.5000</code></pre>
<pre class="r"><code>library(skimr) # you would need to install this
skim(HousesNY)</code></pre>
<table style="width: auto;" class="table table-condensed">
<caption>
Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
HousesNY
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
53
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Price
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
113.63
</td>
<td style="text-align:right;">
41.43
</td>
<td style="text-align:right;">
38.50
</td>
<td style="text-align:right;">
82.70
</td>
<td style="text-align:right;">
107.00
</td>
<td style="text-align:right;">
141.00
</td>
<td style="text-align:right;">
197.5
</td>
<td style="text-align:left;">
▃▇▅▃▃
</td>
</tr>
<tr>
<td style="text-align:left;">
Beds
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.40
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:left;">
▂▇▆▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
Baths
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:left;">
▅▇▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
Size
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
1.30
</td>
<td style="text-align:right;">
1.53
</td>
<td style="text-align:right;">
2.06
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:left;">
▃▇▅▂▂
</td>
</tr>
<tr>
<td style="text-align:left;">
Lot
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:left;">
▇▃▂▁▁
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>library(pillar) # you would need to install this
glimpse(HousesNY)</code></pre>
<pre><code>## Rows: 53
## Columns: 5
## $ Price &lt;dbl&gt; 57.6, 120.0, 150.0, 143.0, 92.5, 50.0, 89.0, 140.0, 197.5, 125.1…
## $ Beds  &lt;int&gt; 3, 6, 4, 3, 3, 2, 2, 4, 4, 3, 3, 3, 3, 4, 3, 3, 4, 3, 4, 3, 4, 4…
## $ Baths &lt;dbl&gt; 2.0, 2.0, 2.0, 2.0, 1.0, 1.0, 2.0, 3.0, 2.5, 2.0, 2.0, 1.0, 2.0,…
## $ Size  &lt;dbl&gt; 0.960, 2.786, 1.704, 1.200, 1.329, 0.974, 1.029, 2.818, 2.268, 1…
## $ Lot   &lt;dbl&gt; 1.30, 0.23, 0.27, 0.80, 0.42, 0.34, 0.29, 0.21, 1.00, 0.30, 1.30…</code></pre>
<p>or</p>
<pre class="r"><code>str(HousesNY)</code></pre>
<pre><code>## &#39;data.frame&#39;:    53 obs. of  5 variables:
##  $ Price: num  57.6 120 150 143 92.5 ...
##  $ Beds : int  3 6 4 3 3 2 2 4 4 3 ...
##  $ Baths: num  2 2 2 2 1 1 2 3 2.5 2 ...
##  $ Size : num  0.96 2.79 1.7 1.2 1.33 ...
##  $ Lot  : num  1.3 0.23 0.27 0.8 0.42 0.34 0.29 0.21 1 0.3 ...</code></pre>
<p>To see what the column names are, you can use the names(dataset) command</p>
<pre class="r"><code>names(HousesNY)</code></pre>
<pre><code>## [1] &quot;Price&quot; &quot;Beds&quot;  &quot;Baths&quot; &quot;Size&quot;  &quot;Lot&quot;</code></pre>
<p>To print the first few rows</p>
<pre class="r"><code>head(HousesNY)</code></pre>
<pre><code>##   Price Beds Baths  Size  Lot
## 1  57.6    3     2 0.960 1.30
## 2 120.0    6     2 2.786 0.23
## 3 150.0    4     2 1.704 0.27
## 4 143.0    3     2 1.200 0.80
## 5  92.5    3     1 1.329 0.42
## 6  50.0    2     1 0.974 0.34</code></pre>
<p>To find the number of rows and columns</p>
<pre class="r"><code>nrow(HousesNY)</code></pre>
<pre><code>## [1] 53</code></pre>
<pre class="r"><code>ncol(HousesNY)</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="r"><code>#or both dimensions
dim(HousesNY)</code></pre>
<pre><code>## [1] 53  5</code></pre>
<p>Or you can do things manually, using the $ symbol to choose a column. All of this is for the price column</p>
<pre class="r"><code>mean(HousesNY$Price)</code></pre>
<pre><code>## [1] 113.6321</code></pre>
<pre class="r"><code>median(HousesNY$Price)</code></pre>
<pre><code>## [1] 107</code></pre>
<pre class="r"><code>mode(HousesNY$Price)</code></pre>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<pre class="r"><code>sd(HousesNY$Price)</code></pre>
<pre><code>## [1] 41.43006</code></pre>
<pre class="r"><code>var(HousesNY$Price)</code></pre>
<pre><code>## [1] 1716.45</code></pre>
<pre class="r"><code>IQR(HousesNY$Price)</code></pre>
<pre><code>## [1] 58.3</code></pre>
<pre class="r"><code>range(HousesNY$Price)</code></pre>
<pre><code>## [1]  38.5 197.5</code></pre>
<div id="missing-what-if-they-say-na" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Missing: What if they say NA?</h3>
<p>There are missing values in some datasets - and by default, R will set the answer to statistics to also be missing.</p>
<pre class="r"><code>example &lt;- c(1,4,5,2,3,NA,2,4)
mean(example)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>To ignore them in a given command, try adding ,na.rm=TRUE to the command e.g.</p>
<pre class="r"><code>mean(example, na.rm=TRUE)</code></pre>
<pre><code>## [1] 3</code></pre>
<p>To simply remove all rows with missing data, try the <code>na.omit()</code> command e g.</p>
<pre class="r"><code>test &lt;- data.frame(A=c(1,3,4),B=c(NA,3,1))
test</code></pre>
<pre><code>##   A  B
## 1 1 NA
## 2 3  3
## 3 4  1</code></pre>
<pre class="r"><code>test2 &lt;- na.omit(test)
test2</code></pre>
<pre><code>##   A B
## 2 3 3
## 3 4 1</code></pre>
</div>
</div>
<div id="making-tables" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Making tables</h2>
<p>Sometimes we want to see how many rows there are in different categories. The easiest way to do this is using the table command. For example, in our New York data, we can see how many houses there are with each number of beds using</p>
<pre class="r"><code>table(HousesNY$Beds)</code></pre>
<pre><code>## 
##  2  3  4  5  6 
##  5 26 19  2  1</code></pre>
<p>So there are 19 rows in our dataset where the Beds column says 4 (AKA 19 houses in our sample with 4 beds). Or we can look at a 2 dimensional table</p>
<pre class="r"><code>table(HousesNY$Beds, HousesNY$Baths)</code></pre>
<pre><code>##    
##      1 1.5  2 2.5  3 3.5
##   2  2   0  3   0  0   0
##   3  8   3 14   0  1   0
##   4  3   1 10   1  3   1
##   5  0   0  1   0  0   1
##   6  0   0  1   0  0   0</code></pre>
<p>So there are 10 houses with 4 beds and 2 baths</p>
<p>To make these look more professional there are a number of packages you can install and use. For example, ztable will take the output of table and format it in a pretty way. This will look TERRIBLE when you run R as it’s making html code. But when you press knit it will look beautiful</p>
<pre class="r"><code># don&#39;t include the install line in your code, run it in the console
# install.package(&quot;ztable&quot;)

library(ztable)
library(magrittr)
options(ztable.type=&quot;html&quot;)

mytable &lt;- table(HousesNY$Beds, HousesNY$Baths)

my_ztable =ztable(mytable) 
print(my_ztable,caption=&quot;Table 1. Basic Table&quot;)</code></pre>
<head>
<style>
        table {
              font-family: times ;
color:  black ;
text-align: right;}
        th {
              padding: 1px 1px 5px 5px;
            }
        td {
             padding: 1px 1px 5px 5px; }
      </style>
</head>
<table align="center" style="border-collapse: collapse; caption-side:top; font-size:11pt;">
<caption style="text-align:center;">
Table 1. Basic Table
</caption>
<tr>
<th style="border-left: 0px solid black;background-color: #FFFFFF;border-top: 2px solid gray;border-bottom: 1px solid gray;">
 
</th>
<th <th align="center" style="font-weight: normal;border-left: 0px solid black;border-bottom: 1px solid gray;border-top: 2px solid gray;">1</th>
<th <th align="center" style="font-weight: normal;border-left: 0px solid black;border-bottom: 1px solid gray;border-top: 2px solid gray;">1.5</th>
<th <th align="center" style="font-weight: normal;border-left: 0px solid black;border-bottom: 1px solid gray;border-top: 2px solid gray;">2</th>
<th <th align="center" style="font-weight: normal;border-left: 0px solid black;border-bottom: 1px solid gray;border-top: 2px solid gray;">2.5</th>
<th <th align="center" style="font-weight: normal;border-left: 0px solid black;border-bottom: 1px solid gray;border-top: 2px solid gray;">3</th>
<th <th align="center" style="font-weight: normal;border-left: 0px solid black;border-right:0px solid black;border-bottom: 1px solid gray;border-top: 2px solid gray;">3.5</th>
</tr>
<tr>
<td style="border-left: 0px solid black; ">
2
</td>
<td align="right" style="border-left: 0px solid black;">
2
</td>
<td align="right" style="border-left: 0px solid black;">
0
</td>
<td align="right" style="border-left: 0px solid black;">
3
</td>
<td align="right" style="border-left: 0px solid black;">
0
</td>
<td align="right" style="border-left: 0px solid black;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-right:0px solid black;">
0
</td>
</tr>
<tr>
<td style="border-left: 0px solid black; border-top: hidden;">
3
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
8
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
3
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
14
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
1
</td>
<td align="right" style="border-left: 0px solid black;border-right:0px solid black;border-top: hidden;">
0
</td>
</tr>
<tr>
<td style="border-left: 0px solid black; border-top: hidden;">
4
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
3
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
1
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
10
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
1
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
3
</td>
<td align="right" style="border-left: 0px solid black;border-right:0px solid black;border-top: hidden;">
1
</td>
</tr>
<tr>
<td style="border-left: 0px solid black; border-top: hidden;">
5
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
1
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-right:0px solid black;border-top: hidden;">
1
</td>
</tr>
<tr>
<td style="border-left: 0px solid black; border-top: hidden;">
6
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
1
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-top: hidden;">
0
</td>
<td align="right" style="border-left: 0px solid black;border-right:0px solid black;border-top: hidden;">
0
</td>
</tr>
<tr>
<td colspan="7" align="left" style="font-size:9pt ;border-top: 1px solid black; border-bottom: hidden;">
</td>
</tr>
</table>
</div>
<div id="correlation" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Correlation</h2>
<p>To find the correlation between two variables, you can simply use the cor function e.g.</p>
<pre class="r"><code>cor(HousesNY$Price,HousesNY$Beds)</code></pre>
<pre><code>## [1] 0.4191355</code></pre>
<p>To see the correlation between ALL columns we can make a “correlation matrix”</p>
<div id="covariancecorrelation-matrix" class="section level3 unnumbered">
<h3 class="unnumbered">Covariance/correlation matrix</h3>
<p>Looking at correlations is a quick (but often misleading) way to assess what is happening. Essentially we can look at the correlation between each column of data.</p>
<pre class="r"><code># Choose column names - let&#39;s say I don&#39;t care about location
colnames(HousesNY)</code></pre>
<pre><code>## [1] &quot;Price&quot; &quot;Beds&quot;  &quot;Baths&quot; &quot;Size&quot;  &quot;Lot&quot;</code></pre>
<pre class="r"><code># Create plot - note I have message=TRUE and warning=TRUE turned on at the top of my code chunk
ggpairs(HousesNY[,c(&quot;Price&quot;,&quot;Beds&quot; ,&quot;Baths&quot;,&quot;Size&quot; , &quot;Lot&quot;   )])</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>You can simply look at the correlations of any NUMERIC columns using the corrplot code.</p>
<pre class="r"><code>library(corrplot)
house.numeric.columns &lt;- HousesNY[ , sapply(HousesNY,is.numeric)]

corrplot(cor(house.numeric.columns),method=&quot;ellipse&quot;,type=&quot;lower&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>There are LOADS of other ways to run correlation plots here: <a href="https://www.r-graph-gallery.com/correlogram.html" class="uri">https://www.r-graph-gallery.com/correlogram.html</a> Feel free to choose a favourite.</p>
<p>Importantly, remember back to this website - <a href="https://www.tylervigen.com/spurious-correlations" class="uri">https://www.tylervigen.com/spurious-correlations</a>. Just because another variable is correlated with our response does not mean it HAS to be in the model. It simply means that you might want to consider whether there is a reason for that correlation.</p>
<p><br> <br></p>
</div>
</div>
</div>
<div id="making-plots" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Making plots</h1>
<div id="where-to-get-plot-code-and-examples" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Where to get plot code and examples</h2>
<p>There are three places I visit constantly:</p>
<ul>
<li><a href="https://r-charts.com/distribution/" class="uri">https://r-charts.com/distribution/</a></li>
<li><a href="https://www.r-graph-gallery.com/" class="uri">https://www.r-graph-gallery.com/</a></li>
<li><a href="https://flowingdata.com/" class="uri">https://flowingdata.com/</a></li>
</ul>
<p>For plots, we have <em>many</em> choices. We can use what is built into R, or.. use the ggplot system where you add on layers to your plot using the + symbol, or use specialist packages such as ggstatplot or beeswarm.</p>
<p>If you are new to data visualisation, read these two articles</p>
<ul>
<li><a href="https://flowingdata.com/2014/10/23/moving-past-default-charts/" class="uri">https://flowingdata.com/2014/10/23/moving-past-default-charts/</a></li>
<li><a href="https://flowingdata.com/2012/05/15/how-to-visualize-and-compare-distributions/" class="uri">https://flowingdata.com/2012/05/15/how-to-visualize-and-compare-distributions/</a></li>
</ul>
</div>
<div id="how-to-decide-what-to-do" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> How to decide what to do</h2>
<p>Plots are designed to do two things, allow you to see something in the data that you couldn’t see in the numbers, plus communicate output in a compelling way. Going beyond the basics or knowing the limitations of a plot will help you do this, so in these examples I have provided a range of complexity.</p>
<p>So far, I have focused on plots that slow you to visualise the distribution of your response variable. You do not need to use them all! Choose ones that work for you and your data.</p>
<ol style="list-style-type: decimal">
<li>Boxplots</li>
<li>Histograms</li>
<li>Violin plots (half boxplot half histogram)</li>
<li>Beeswarm</li>
</ol>
</div>
<div id="boxplots" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Boxplots</h2>
<p>Boxplots have been around over 40 years! See their history and evolution here: <a href="http://vita.had.co.nz/papers/boxplots.pdf" class="uri">http://vita.had.co.nz/papers/boxplots.pdf</a></p>
<div class="figure">
<img src="Figures/Tut6_fig1_boxplot.png" alt="*Image source: https://www.leansigmacorporation.com/box-plot-with-minitab/*" width="893" />
<p class="caption">
<em>Image source: <a href="https://www.leansigmacorporation.com/box-plot-with-minitab/" class="uri">https://www.leansigmacorporation.com/box-plot-with-minitab/</a></em>
</p>
</div>
<p>In terms of your reports, you need to think of 3 things: - Why you are making the plot (quick look vs publication worthy final graphic) - What aspects of the data do you want to highlight (lots of data, comparing groups, weird distributions..) - What are your final requirements and personal style (colorblind friendly, you’re drawn to a certain type of plot..)</p>
<p>So for boxplots.. they are especially good at allowing you to compare different groups of things or to look for multiple groups in a single response variable. Here is a beautiful example made by Marcus Beckman on dissertation lengths (description here: <a href="https://beckmw.wordpress.com/2014/07/15/average-dissertation-and-thesis-length-take-two/" class="uri">https://beckmw.wordpress.com/2014/07/15/average-dissertation-and-thesis-length-take-two/</a> and code here: <a href="https://github.com/fawda123/diss_proc" class="uri">https://github.com/fawda123/diss_proc</a> )</p>
<p>If there are only one or two variables, I often jump to the violin or histogram plots as they show more detail.</p>
<div class="figure">
<img src="Figures/beckman_thes_plo.png" alt="*See how important the caption is in describing the plot - and how even the colors have meaning*" width="852" />
<p class="caption">
<em>See how important the caption is in describing the plot - and how even the colors have meaning</em>
</p>
</div>
<p>So.. how to make these yourselves. You have a range of options!</p>
<div id="basics-single-boxplot" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Basics (single boxplot)</h3>
<p>Here is the most basic boxplot you can make. I often start with this for my own use when exploring the data, then later decide which plots to “make pretty”.</p>
<pre class="r"><code>boxplot(HousesNY$Price)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>We can make better boxplots in base R (e.g. using no special packages/libraries). See this tutorial for all the details: <a href="https://www.datamentor.io/r-programming/box-plot/" class="uri">https://www.datamentor.io/r-programming/box-plot/</a> which goes through exactly what each line means.</p>
<pre class="r"><code># one big command on separate lines
boxplot(HousesNY$Price,
        main = &quot;House prices of Canton NY sample&quot;,
        xlab = &quot;Price (Thousand USD)&quot;,
        col = &quot;light blue&quot;,
        border = &quot;dark blue&quot;,
        horizontal = TRUE,
        notch = TRUE)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>There are specific plotting packages, the most famous being ggplot2 (there are data camp courses on it). The absolute basics. Here x is blank because we just want to look at the price column alone.</p>
<pre class="r"><code>library(ggplot2)

ggplot(HousesNY, aes(x =&quot;&quot;, y = Price)) +    ## this loads the data
   geom_boxplot()                            ## and we choose a boxplot</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p>Note for now, think of the %&gt;% symbol and + symbol also as “one command on multiple lines..”. They allow you to build up layers of the plot. Data camp has more on this.</p>
<p>But with these we can easily do more sophisticated things. For example, here’s how to see the underlying data, which allows us to see something of the background distribution</p>
<p><a href="https://r-charts.com/distribution/box-plot-jitter-ggplot2/" class="uri">https://r-charts.com/distribution/box-plot-jitter-ggplot2/</a></p>
<pre class="r"><code># Basic box plot
ggplot(HousesNY, aes(x = &quot;&quot;, y = Price)) + 
  geom_boxplot() +
  geom_jitter()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
<div id="comparing-groups" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Comparing groups</h3>
<p>The basic code to see a boxplot split by group, in this case the price per number of beds:</p>
<pre class="r"><code>boxplot(HousesNY$Price ~ HousesNY$Beds)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>The advantage of this is that you can be sure that you really did plot your columns of choice (e.g. you didn’t mistakenly label anything). Note, if you use a comma, rather than the “~” symbol, you will make one for each column - which is normally not useful!</p>
<pre class="r"><code>boxplot(HousesNY$Price,  HousesNY$Beds)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-73-1.png" width="672" /> <br></p>
<p>In GGplot comparing different groups:</p>
<pre class="r"><code># Libraries
library(tidyverse)
library(hrbrthemes)
library(viridis)

# tell R that the beds column is categorical
HousesNY$Beds &lt;- factor(HousesNY$Beds,
                     levels=c(min(HousesNY$Beds):max(HousesNY$Beds)))

# Plot
  ggplot(HousesNY, aes(x=Beds, y=Price)) +
    geom_boxplot() </code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>Or getting more complex</p>
<pre class="r"><code># Libraries
library(tidyverse)
library(hrbrthemes)
library(viridis)

# tell R that the beds column is categorical
# I already did this in the table section
#HousesNY$Beds &lt;- as.factor(HousesNY$Beds)

# Plot
HousesNY %&gt;%
  ggplot( aes(x=Beds, y=Price, fill=Beds) )+
    geom_boxplot() +
    scale_fill_viridis(discrete = TRUE, alpha=0.6) +
    geom_jitter(color=&quot;black&quot;, size=0.5, alpha=0.8) +
    ggtitle(&quot;&quot;) +
    xlab(&quot;Beds&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>or dotplots..</p>
<pre class="r"><code>ggplot(HousesNY,  aes(x=Beds, y=Price, fill=Beds)) +
  geom_boxplot() +
  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;, dotsize = 0.5,binwidth=7)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>There are MANY more options, plus code here: <a href="https://www.r-graph-gallery.com/boxplot.html" class="uri">https://www.r-graph-gallery.com/boxplot.html</a></p>
<div class="figure">
<img src="Figures/Tut6_fig2_boxplot.png" alt="*R graph gallery*" width="814" />
<p class="caption">
<em>R graph gallery</em>
</p>
</div>
<p>and a delightful tutorial here: <a href="https://www.r-bloggers.com/2021/11/how-to-make-stunning-boxplots-in-r-a-complete-guide-with-ggplot2/" class="uri">https://www.r-bloggers.com/2021/11/how-to-make-stunning-boxplots-in-r-a-complete-guide-with-ggplot2/</a></p>
</div>
<div id="sophisticated" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Sophisticated</h3>
<p>Finally, we <em>can</em> get super fancy in base R - it’s often a good way to learn how to code. I like this example because it shows many different aspects/useful commands in R programming. <a href="http://www.opiniomics.org/beautiful-boxplots-in-base-r/" class="uri">http://www.opiniomics.org/beautiful-boxplots-in-base-r/</a></p>
<pre class="r"><code>library(RColorBrewer)

# create colours and colour matrix (for points)
m     &lt;- as.matrix(HousesNY$Price)

col_main   &lt;- colorRampPalette(brewer.pal(12, &quot;Set3&quot;), alpha=TRUE)(ncol(m))
col_transp &lt;- colorspace::adjust_transparency(col_main, alpha = .3)

colsm   &lt;-matrix(rep(col_main, each=nrow(m)), ncol=ncol(m))
colsm_tr &lt;-matrix(rep(col_transp, each=nrow(m)), ncol=ncol(m))


# create some random data for jitter
r &lt;-  (matrix(runif(nrow(m)*ncol(m)), nrow=nrow(m), ncol=ncol(m)) / 2) - 0.25

# get the greys (stolen from https://github.com/zonination/perceptions/blob/master/percept.R)
palette &lt;- brewer.pal(&quot;Greys&quot;, n=9)
color.background = palette[2]
color.grid.major = palette[5]

# set graphical area
par(bty=&quot;n&quot;, bg=palette[2], mar=c(5,8,3,1))

# plot initial boxplot
boxplot(m~col(m), horizontal=TRUE, outline=FALSE, lty=1, 
        staplewex=0, boxwex=0.8, boxlwd=1, medlwd=1, 
        col=colsm_tr, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;)

# plot gridlines
for (i in pretty(m,10)) {
    lines(c(i,i), c(0,20), col=palette[4])
}

# plot points
points(m, col(m)+r, col=colsm, pch=16)

# overlay boxplot
boxplot(m~col(m), horizontal=TRUE, outline=FALSE, lty=1, 
        staplewex=0, boxwex=0.8, boxlwd=1, medlwd=1, col=colsm_tr, 
        add=TRUE, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;)

# add axes and title
axis(side=1, at=pretty(m,10), col.axis=palette[7], 
     cex.axis=0.8, lty=0, tick=NA, line=-1)
axis(side=1, at=50, labels=&quot;Price (Thousand USD)&quot;, 
     lty=0, tick=NA, col.axis=palette[7])
axis(side=2, at=1, col.axis=palette[7], cex.axis=0.8, 
     lty=0, tick=NA, labels=&quot;Sample 1&quot;, las=2)
axis(side=2, at=17/2, labels=&quot;Phrase&quot;, col.axis=palette[7], 
     lty=0, tick=NA, las=3, line=6)
title(&quot;House Prices in Canton NY&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>Or if you wish to do the rainbow many group boxplot at the beginning, the code is here : <a href="https://github.com/fawda123/diss_proc/blob/master/diss_plot.R" class="uri">https://github.com/fawda123/diss_proc/blob/master/diss_plot.R</a></p>
<p><br> <br></p>
</div>
</div>
<div id="violin-plots" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Violin plots</h2>
<p>Violin plots combine the simplicity of a boxplot with a sense of the underlying distribution. This is useful when you want a sense of both the symmetry of the data and the underlying distribution. Highly recommended! For a single variable, consider a box-plot-with-histogram (see below).</p>
<p>There are MANY on R graph gallery with code: <a href="https://www.r-graph-gallery.com/violin.html" class="uri">https://www.r-graph-gallery.com/violin.html</a></p>
<div class="figure">
<img src="Figures/Tut6_fig4_violin.png" alt="*R graph gallery - https://www.r-graph-gallery.com/violin.html*" width="984" />
<p class="caption">
<em>R graph gallery - <a href="https://www.r-graph-gallery.com/violin.html" class="uri">https://www.r-graph-gallery.com/violin.html</a></em>
</p>
</div>
<p>For example, for our data:</p>
<pre class="r"><code># fill=name allow to automatically dedicate a color for each group
ggplot(HousesNY, aes(x=Beds, y=Price, fill=Beds)) + 
   geom_violin()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>There’s also a <em>beautiful</em> package called <code>ggstatsplot</code> which allows a lot of detail (<a href="https://indrajeetpatil.github.io/ggstatsplot/" class="uri">https://indrajeetpatil.github.io/ggstatsplot/</a>)</p>
<p>For example, I love the plot below because it shows how much data in each group.</p>
<pre class="r"><code># you might need to first install this.
library(ggstatsplot)

# i&#39;m changing the middle mean point to be dark blue

ggbetweenstats(data = HousesNY,x = Beds,y = Price, 
               centrality.point.args=list(color = &quot;darkblue&quot;))</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>Or we can customise it even more using this tutorial to get results like this (<a href="https://www.r-graph-gallery.com/web-violinplot-with-ggstatsplot.html" class="uri">https://www.r-graph-gallery.com/web-violinplot-with-ggstatsplot.html</a>)</p>
<div class="figure">
<img src="Figures/Tut6_fig3_boxplot.png" alt="*GGStatsplot*" width="512" />
<p class="caption">
<em>GGStatsplot</em>
</p>
</div>
<p><br> <br></p>
</div>
<div id="histograms" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Histograms</h2>
<p>Especially just looking at a single response variable, it’s useful to look immediately at the distribution itself. Histograms are great for this, although you must be careful that the bin size doesn’t impact your perception of results. Adding in a boxplot is often useful</p>
<p>Here is the absolute basic histogram</p>
<pre class="r"><code>hist(HousesNY$Price)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>Or changing the bin size</p>
<pre class="r"><code>hist(HousesNY$Price,br=40)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>In GGPlot 2, it’s also easy</p>
<pre class="r"><code>ggplot(data=HousesNY, aes(x=Price)) + 
  geom_histogram(bins=20) </code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>Often, a boxplot AND a histogram is useful as it allows you to see a sense of the data shape and its underlying symmetry. For example, in base R</p>
<pre class="r"><code># Layout to split the screen
graphics::layout(matrix(c(1,2),2,1, byrow=TRUE),  
       height = c(2,7))
 
# Draw the boxplot and the histogram 
par(mar=c(0, 3.1, .5, 2.1))

data_to_plot &lt;- HousesNY$Price

rangeplot &lt;- pretty(data_to_plot,10)

boxplot(data_to_plot,col = &quot;light blue&quot;,
        border = &quot;dark blue&quot;,xaxt=&quot;n&quot;,frame=FALSE,xlim=c(0.75,1.25),
        horizontal = TRUE,notch = TRUE,ylim=c(min(rangeplot),max(rangeplot)))

par(mar=c(3, 3.1, .5, 2.1))
hist(data_to_plot , breaks=20 , 
     col=grey(0.3) , border=F , 
     tcl=-.25,mgp=c(1.75,.5,0),
     main=&quot;&quot; , xlab=&quot;Price of houses in Canton NY&quot;, 
     xlim=c(min(rangeplot),max(rangeplot)))
box();grid();
hist(data_to_plot , breaks=20 , add=TRUE,
     col=grey(0.3) , border=F , axis=FALSE,
     xlim=c(min(rangeplot),max(rangeplot)))</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<p>And the same with ggplot2:</p>
<pre class="r"><code>library(ggExtra)

p &lt;- ggplot(data=HousesNY, aes(x=Price)) + 
  geom_point(aes(y = 0.01), alpha = 0) +
  geom_histogram(bins=20) +
  geom_density(na.rm=T)

ggMarginal(p, type=&quot;boxplot&quot;, margins = &quot;x&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>I also love the ggstatplot version</p>
<pre class="r"><code>library(ggstatsplot)
## plot
gghistostats(
  data       = HousesNY, ## dataframe from which variable is to be taken
  x          = Price, ## numeric variable whose distribution is of interest
  title      = &quot;Price of sampled houses in Canton NY&quot;, ## title for the plot
  caption    = &quot;Source: Zillow&quot;,
  type = &quot;parametric&quot;,
  xlab = NULL,subtitle=FALSE,
  ggthemes::theme_tufte(),
  binwidth   = 8) ## binwidth value (experiment)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<p>Or their version that includes a lot of associated statistics. You can turn many of these on and off</p>
<pre class="r"><code>library(ggstatsplot)

## plot
gghistostats(
  data       = HousesNY, ## dataframe from which variable is to be taken
  x          = Price, ## numeric variable whose distribution is of interest
  title      = &quot;Price of sampled houses in Canton NY&quot;, ## title for the plot
  caption    = &quot;Source: Zillow&quot;,
  type = &quot;parametric&quot;,
  xlab = NULL,
  ggthemes::theme_tufte(),
  binwidth   = 8) ## binwidth value (experiment)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-86-1.png" width="672" /> ### Adding a density function</p>
<p>Sometimes seeing a smoothed line helps draw the eye to distributions</p>
<pre class="r"><code>hist(HousesNY$Price, prob = TRUE,
     main = &quot;Canton Prices with density curve&quot;)
lines(density(HousesNY$Price), col = 4, lwd = 2)
box()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<div id="adding-a-distribution" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Adding a distribution</h3>
<p>Let’s say you want to make plots similar to the ones in the lectures where there is your chosen distribution on top.</p>
<p>If you know the distribution, you can simply add it on top as a line</p>
<pre class="r"><code>mysample &lt;- HousesNY$Price

plotmin &lt;- mean(mysample) - sd(mysample)*3
plotmax &lt;-  mean(mysample) + sd(mysample)*3

# Points for the normal equation line
NormCurve_x &lt;- seq(plotmin,plotmax, length = 40)

# Normal curve calculation for each point
NormCurve_y &lt;- dnorm(NormCurve_x, mean = mean(mysample), sd = sd(mysample))

# make sure this is density not raw frequency
hist(mysample , breaks=20 , freq=FALSE,
     col=grey(0.5) , border=F , 
     xlim=c(plotmin,plotmax),
     tcl=-.25,mgp=c(1.75,.5,0),
     main=&quot;&quot; , xlab=&quot;Price of houses in Canton NY&quot;)
# add the normal curve (THIS NEEDS TO BE IN THE SAME CODE CHUNK)
lines(NormCurve_x, NormCurve_y, col = 2, lwd = 2)
box()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<p>We could plot any old curve this way, it doesn’t have to be “fit” to our data. For example here is a random gamma function</p>
<pre class="r"><code>mysample &lt;- HousesNY$Price

# Points for the normal equation line
GammaCurve_x &lt;- seq(plotmin,plotmax, length = 60)
GammaCurve_y &lt;- dgamma(GammaCurve_x,shape = 2)

# make sure this is density not raw frequency
hist(mysample , breaks=20 , freq=FALSE,
     col=grey(0.5) , border=F , 
     xlim=c(plotmin,plotmax),
     tcl=-.25,mgp=c(1.75,.5,0),
     main=&quot;&quot; , xlab=&quot;Price of houses in Canton NY&quot;)
# add the normal curve (THIS NEEDS TO BE IN THE SAME CODE CHUNK)
lines(GammaCurve_x, GammaCurve_y, col = 2, lwd = 2)
box()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
<div id="comparing-groups-1" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Comparing groups</h3>
<p>Or you can easily compare two datasets, tutorial for this plot here: <a href="https://www.r-graph-gallery.com/histogram_several_group.html" class="uri">https://www.r-graph-gallery.com/histogram_several_group.html</a></p>
<div class="figure">
<img src="Figures/Tut6_fig5_box.png" alt="*GGStatsplot*" width="586" />
<p class="caption">
<em>GGStatsplot</em>
</p>
</div>
<p><br> <br></p>
</div>
</div>
<div id="ridgeline-plots" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Ridgeline plots</h2>
<p>These are another way of looking at histograms for different groups. They work especially when your grouping data is ORDINAL (has some inherent order). So bedrooms would be a good example</p>
<p>Two great pages here: - <a href="https://www.data-to-viz.com/graph/ridgeline.html" class="uri">https://www.data-to-viz.com/graph/ridgeline.html</a> - <a href="https://r-charts.com/distribution/ggridges/" class="uri">https://r-charts.com/distribution/ggridges/</a></p>
<p>We can use histograms or smoothed density lines <a href="https://www.data-to-viz.com/graph/ridgeline.html" class="uri">https://www.data-to-viz.com/graph/ridgeline.html</a></p>
<pre class="r"><code>library(ggridges)
library(ggplot2)

HousesNY %&gt;%
  ggplot( aes(y=Beds, x=Price,  fill=Beds)) +
    geom_density_ridges(alpha=0.6, stat=&quot;binline&quot;) +
    scale_fill_viridis(discrete=TRUE) +
    scale_color_viridis(discrete=TRUE) +
    theme_ipsum() +
    theme(
      legend.position=&quot;none&quot;,
      panel.spacing = unit(0.1, &quot;lines&quot;),
      strip.text.x = element_text(size = 8)
    ) +
    xlab(&quot;&quot;) +
    ylab(&quot;Number of Bedrooms&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<p>But the</p>
<p>All of these are from <a href="https://r-charts.com/distribution/ggridges/" class="uri">https://r-charts.com/distribution/ggridges/</a></p>
<pre class="r"><code>library(ggridges)
library(ggplot2)

ggplot(HousesNY, aes(x = Price, y = Beds, fill = stat(x))) +
  geom_density_ridges_gradient() +
  scale_fill_viridis_c(name = &quot;Depth&quot;, option = &quot;C&quot;) +
  coord_cartesian(clip = &quot;off&quot;) + # To avoid cut off
  theme_minimal()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>We can also make the colours more meaningful, for example adding quantiles to show the median and interquartile range</p>
<pre class="r"><code>ggplot(HousesNY, aes(x = Price, y = Beds, fill = stat(quantile))) +
  stat_density_ridges(quantile_lines = FALSE,
                      calc_ecdf = TRUE,
                      geom = &quot;density_ridges_gradient&quot;) +
  scale_fill_brewer(name = &quot;&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p>or highlighting tails</p>
<pre class="r"><code>ggplot(HousesNY, aes(x = Price, y = Beds, fill = stat(quantile))) +
  stat_density_ridges(quantile_lines = TRUE,
                      calc_ecdf = TRUE,
                      geom = &quot;density_ridges_gradient&quot;,
                      quantiles = c(0.05, 0.95)) +
  scale_fill_manual(name = &quot;Proportion&quot;, 
                    values = c(&quot;#E2FFF2&quot;, &quot;white&quot;, &quot;#B0E0E6&quot;),
                    labels = c(&quot;(0, 5%]&quot;, &quot;(5%, 95%]&quot;, &quot;(95%, 1]&quot;))</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
<div id="beeswarm-plots" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Beeswarm plots</h2>
<p>These are cool. As described here:</p>
<p><a href="https://www.rhoworld.com/i-swarm-you-swarm-we-all-swarm-for-beeswarm-plots-0/#" class="uri">https://www.rhoworld.com/i-swarm-you-swarm-we-all-swarm-for-beeswarm-plots-0/#</a>:~:text=What%20is%20a%20beeswarm%20plot%3F&amp;text=A%20beeswarm%20plot%20improves%20upon,bees%20buzzing%20about%20their%20hive.</p>
<p>“But what is a beeswarm plot? … A beeswarm plot improves upon the random jittering approach to move data points the minimum distance away from one another to avoid overlays. The result is a plot where you can see each distinct data point, like so: It looks a bit like a friendly swarm of bees buzzing about their hive.”</p>
<p>It’s often used for professional visualisation, see here for many examples: <a href="https://flowingdata.com/charttype/beeswarm" class="uri">https://flowingdata.com/charttype/beeswarm</a></p>
<div class="figure">
<img src="Figures/Tut6_fig6_beeswarm.png" alt="*Both found at https://flowingdata.com/charttype/beeswarm*" width="1077" />
<p class="caption">
<em>Both found at <a href="https://flowingdata.com/charttype/beeswarm" class="uri">https://flowingdata.com/charttype/beeswarm</a></em>
</p>
</div>
<p>Especially for the first, you can see the distribution clearly, also with the amount of data. With the second, you can see the mitigating impact of a second variable.</p>
<p>To make easy ones you can install a new packages “beeswarm”</p>
<pre class="r"><code>library(&quot;beeswarm&quot;)

beeswarm(HousesNY$Price,
         vertical = FALSE, method = &quot;hex&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<p>This is a little boring for my 58 data points! (although perhaps it does show that 58 points is barely a big enough sample to know an underlying model..)</p>
<p><br> <br></p>
</div>
<div id="scatterplots" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Scatterplots</h2>
<p>Here is the absolute basic scatterplot</p>
<pre class="r"><code># you can either do plot(x, y)
# OR (recommended), use the ~ to say plot(y~x) 
# e.g. y depends on x
HousesNY$Beds &lt;- as.numeric(HousesNY$Beds)

plot(HousesNY$Price ~ HousesNY$Beds)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p>There are many things we can change, see the help file for the <code>par</code> command for more.</p>
<p>For example, here is an ugly plot showing as many as I can think!</p>
<pre class="r"><code>plot(HousesNY$Price ~ HousesNY$Beds,
     xlim=c(0,7), #xlimits
     ylim=c(40,220), #ylimits
     xlab=list(&quot;Beds&quot;,cex=.8,col=&quot;red&quot;,font=2), # play with x-label
     ylab=list(&quot;Price&quot;,cex=1.2,col=&quot;blue&quot;,font=3), # play with x-label
     main=&quot;Ugly feature plot&quot;,
     cex=1.2, #point size
     pch=16, # symbol shape (try plot(1:24,1:24,pch=1:24 to see them all))
     tcl=-.25, # smaller tick marks
     mgp=c(1.75,.5,0)) # move the x/y labels around

grid() #  add a grid

# lines means &quot;add points on top&quot;
lines(HousesNY$Price ~ HousesNY$Beds, 
     type=&quot;p&quot;, # p for points, &quot;l&quot; for lines, &quot;o&quot; for both, &quot;h for bars
     xlim=c(0,7), #xlimits
     ylim=c(40,220), #ylimits
     col=&quot;yellow&quot;,
     cex=.5, #point size
     pch=4) # move the x/y labels around</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<p>To add a line, you can use the abline command IN THE SAME CODE CHUNK. For example</p>
<pre class="r"><code>plot(HousesNY$Price ~ HousesNY$Beds,
     xlim=c(0,7), #xlimits
     ylim=c(40,220), #ylimits
     xlab=list(&quot;Beds&quot;,cex=.8,col=&quot;red&quot;,font=2), # play with x-label
     ylab=list(&quot;Price&quot;,cex=1.2,col=&quot;blue&quot;,font=3), # play with x-label
     main=&quot;&quot;, # no title
     cex=1.2, #point size
     pch=16, # symbol shape (try plot(1:24,1:24,pch=1:24 to see them all))
     tcl=-.25, # smaller tick marks
     mgp=c(1.75,.5,0)) # move the x/y labels around

# add vertical line at 3.5
abline(v=5.5,col=&quot;red&quot;)
# add horizontal line at the mean of price
abline(h=mean(HousesNY$Price)) 
# add line of best fit
abline(lm(HousesNY$Price ~ HousesNY$Beds),col=&quot;blue&quot;,lty=&quot;dotted&quot;,lwd=3) </code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<p>GGPlot also has basic and advanced options. From the basics:</p>
<pre class="r"><code>library(ggplot2)
#
ggplot(HousesNY, aes(x=Beds, y=Price)) + 
    geom_point()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>To more advanced:</p>
<pre class="r"><code>library(ggplot2)
library(hrbrthemes)

# use options!
ggplot(HousesNY, aes(x=Beds, y=Price)) + 
    geom_point(
        color=&quot;black&quot;,
        fill=&quot;#69b3a2&quot;,
        shape=22,
        alpha=0.5,
        size=6,
        stroke = 1
        ) +
    theme_ipsum()</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p>Adding a line of best fit is also easy, but fits less easily with R’s modelling commands:</p>
<pre class="r"><code># Library
library(ggplot2)
library(hrbrthemes)

# Create dummy data
data &lt;- data.frame(
  cond = rep(c(&quot;condition_1&quot;, &quot;condition_2&quot;), each=10), 
  my_x = 1:100 + rnorm(100,sd=9), 
  my_y = 1:100 + rnorm(100,sd=16) 
)

# Basic scatter plot.
p1 &lt;- ggplot(data, aes(x=my_x, y=my_y)) + 
  geom_point( color=&quot;#69b3a2&quot;) +
  theme_ipsum()
 
# with linear trend
p2 &lt;- ggplot(data, aes(x=my_x, y=my_y)) +
  geom_point() +
  geom_smooth(method=lm , color=&quot;red&quot;, se=FALSE) +
  theme_ipsum()

# linear trend + confidence interval
p3 &lt;- ggplot(data, aes(x=my_x, y=my_y)) +
  geom_point() +
  geom_smooth(method=lm , color=&quot;red&quot;, fill=&quot;#69b3a2&quot;, se=TRUE) +
  theme_ipsum()

p1</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<pre class="r"><code>p2</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-100-2.png" width="672" /></p>
<pre class="r"><code>p3</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-100-3.png" width="672" /></p>
<p>Or using the plotly library to make your plots interactive (really useful, try zooming in or clicking on a few points)</p>
<pre class="r"><code># create the plot, save it as &quot;p&quot; rather than print immediately
myplot &lt;-   ggplot(HousesNY, aes(x=Beds, y=Price, label=Baths)) + 
            geom_point(alpha=.5) +
            theme_classic()
            
# and plot interactively
ggplotly(myplot)</code></pre>
<div id="htmlwidget-5c33f1499c78acaa0d68" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5c33f1499c78acaa0d68">{"x":{"data":[{"x":[2,5,3,2,2,1,1,3,3,2,2,2,2,3,2,2,3,2,3,2,3,3,4,3,2,1,2,2,3,2,2,2,2,2,2,1,2,2,2,3,1,3,3,3,3,2,3,2,3,3,4,3,2],"y":[57.6,120,150,143,92.5,50,89,140,197.5,125.1,175,60,138.5,160,63.5,107,185,82.7,75,118,87.5,67.5,105,114,100.5,78,99,144,179,110,175,100,53,92,127,120.5,72,95,38.5,139,75,174,119,89,75.1,92.5,141,82,162,195,190,115,87],"text":["Beds: 2<br />Price:  57.6<br />Baths: 2.0","Beds: 5<br />Price: 120.0<br />Baths: 2.0","Beds: 3<br />Price: 150.0<br />Baths: 2.0","Beds: 2<br />Price: 143.0<br />Baths: 2.0","Beds: 2<br />Price:  92.5<br />Baths: 1.0","Beds: 1<br />Price:  50.0<br />Baths: 1.0","Beds: 1<br />Price:  89.0<br />Baths: 2.0","Beds: 3<br />Price: 140.0<br />Baths: 3.0","Beds: 3<br />Price: 197.5<br />Baths: 2.5","Beds: 2<br />Price: 125.1<br />Baths: 2.0","Beds: 2<br />Price: 175.0<br />Baths: 2.0","Beds: 2<br />Price:  60.0<br />Baths: 1.0","Beds: 2<br />Price: 138.5<br />Baths: 2.0","Beds: 3<br />Price: 160.0<br />Baths: 2.0","Beds: 2<br />Price:  63.5<br />Baths: 2.0","Beds: 2<br />Price: 107.0<br />Baths: 1.0","Beds: 3<br />Price: 185.0<br />Baths: 3.5","Beds: 2<br />Price:  82.7<br />Baths: 1.0","Beds: 3<br />Price:  75.0<br />Baths: 2.0","Beds: 2<br />Price: 118.0<br />Baths: 1.0","Beds: 3<br />Price:  87.5<br />Baths: 2.0","Beds: 3<br />Price:  67.5<br />Baths: 1.0","Beds: 4<br />Price: 105.0<br />Baths: 2.0","Beds: 3<br />Price: 114.0<br />Baths: 2.0","Beds: 2<br />Price: 100.5<br />Baths: 2.0","Beds: 1<br />Price:  78.0<br />Baths: 1.0","Beds: 2<br />Price:  99.0<br />Baths: 1.0","Beds: 2<br />Price: 144.0<br />Baths: 1.5","Beds: 3<br />Price: 179.0<br />Baths: 2.0","Beds: 2<br />Price: 110.0<br />Baths: 1.5","Beds: 2<br />Price: 175.0<br />Baths: 2.0","Beds: 2<br />Price: 100.0<br />Baths: 2.0","Beds: 2<br />Price:  53.0<br />Baths: 1.0","Beds: 2<br />Price:  92.0<br />Baths: 2.0","Beds: 2<br />Price: 127.0<br />Baths: 2.0","Beds: 1<br />Price: 120.5<br />Baths: 2.0","Beds: 2<br />Price:  72.0<br />Baths: 2.0","Beds: 2<br />Price:  95.0<br />Baths: 2.0","Beds: 2<br />Price:  38.5<br />Baths: 1.0","Beds: 3<br />Price: 139.0<br />Baths: 2.0","Beds: 1<br />Price:  75.0<br />Baths: 2.0","Beds: 3<br />Price: 174.0<br />Baths: 3.0","Beds: 3<br />Price: 119.0<br />Baths: 2.0","Beds: 3<br />Price:  89.0<br />Baths: 1.0","Beds: 3<br />Price:  75.1<br />Baths: 2.0","Beds: 2<br />Price:  92.5<br />Baths: 2.0","Beds: 3<br />Price: 141.0<br />Baths: 1.0","Beds: 2<br />Price:  82.0<br />Baths: 3.0","Beds: 3<br />Price: 162.0<br />Baths: 1.5","Beds: 3<br />Price: 195.0<br />Baths: 3.0","Beds: 4<br />Price: 190.0<br />Baths: 3.5","Beds: 3<br />Price: 115.0<br />Baths: 2.0","Beds: 2<br />Price:  87.0<br />Baths: 1.5"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.8,5.2],"tickmode":"array","ticktext":["1","2","3","4","5"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["1","2","3","4","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Beds","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[30.55,205.45],"tickmode":"array","ticktext":["50","100","150","200"],"tickvals":[50,100,150,200],"categoryorder":"array","categoryarray":["50","100","150","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Price","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"166a0336fc965":{"x":{},"y":{},"label":{},"type":"scatter"}},"cur_data":"166a0336fc965","visdat":{"166a0336fc965":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>It’s also very easy to add in color to see another variable. For example</p>
<pre class="r"><code># create the plot, save it as &quot;p&quot; rather than print immediately
myplot &lt;-   ggplot(HousesNY, aes(x=Beds, y=Price,color=Baths)) + 
            geom_point(alpha=.5) +
            theme_classic()+
            scale_color_gradient(low=&quot;blue&quot;, high=&quot;red&quot;)

# and plot interactively
ggplotly(myplot)</code></pre>
<div id="htmlwidget-cf96c5847673f7f5d0a3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf96c5847673f7f5d0a3">{"x":{"data":[{"x":[2,5,3,2,2,1,1,3,3,2,2,2,2,3,2,2,3,2,3,2,3,3,4,3,2,1,2,2,3,2,2,2,2,2,2,1,2,2,2,3,1,3,3,3,3,2,3,2,3,3,4,3,2],"y":[57.6,120,150,143,92.5,50,89,140,197.5,125.1,175,60,138.5,160,63.5,107,185,82.7,75,118,87.5,67.5,105,114,100.5,78,99,144,179,110,175,100,53,92,127,120.5,72,95,38.5,139,75,174,119,89,75.1,92.5,141,82,162,195,190,115,87],"text":["Beds: 2<br />Price:  57.6<br />Baths: 2.0","Beds: 5<br />Price: 120.0<br />Baths: 2.0","Beds: 3<br />Price: 150.0<br />Baths: 2.0","Beds: 2<br />Price: 143.0<br />Baths: 2.0","Beds: 2<br />Price:  92.5<br />Baths: 1.0","Beds: 1<br />Price:  50.0<br />Baths: 1.0","Beds: 1<br />Price:  89.0<br />Baths: 2.0","Beds: 3<br />Price: 140.0<br />Baths: 3.0","Beds: 3<br />Price: 197.5<br />Baths: 2.5","Beds: 2<br />Price: 125.1<br />Baths: 2.0","Beds: 2<br />Price: 175.0<br />Baths: 2.0","Beds: 2<br />Price:  60.0<br />Baths: 1.0","Beds: 2<br />Price: 138.5<br />Baths: 2.0","Beds: 3<br />Price: 160.0<br />Baths: 2.0","Beds: 2<br />Price:  63.5<br />Baths: 2.0","Beds: 2<br />Price: 107.0<br />Baths: 1.0","Beds: 3<br />Price: 185.0<br />Baths: 3.5","Beds: 2<br />Price:  82.7<br />Baths: 1.0","Beds: 3<br />Price:  75.0<br />Baths: 2.0","Beds: 2<br />Price: 118.0<br />Baths: 1.0","Beds: 3<br />Price:  87.5<br />Baths: 2.0","Beds: 3<br />Price:  67.5<br />Baths: 1.0","Beds: 4<br />Price: 105.0<br />Baths: 2.0","Beds: 3<br />Price: 114.0<br />Baths: 2.0","Beds: 2<br />Price: 100.5<br />Baths: 2.0","Beds: 1<br />Price:  78.0<br />Baths: 1.0","Beds: 2<br />Price:  99.0<br />Baths: 1.0","Beds: 2<br />Price: 144.0<br />Baths: 1.5","Beds: 3<br />Price: 179.0<br />Baths: 2.0","Beds: 2<br />Price: 110.0<br />Baths: 1.5","Beds: 2<br />Price: 175.0<br />Baths: 2.0","Beds: 2<br />Price: 100.0<br />Baths: 2.0","Beds: 2<br />Price:  53.0<br />Baths: 1.0","Beds: 2<br />Price:  92.0<br />Baths: 2.0","Beds: 2<br />Price: 127.0<br />Baths: 2.0","Beds: 1<br />Price: 120.5<br />Baths: 2.0","Beds: 2<br />Price:  72.0<br />Baths: 2.0","Beds: 2<br />Price:  95.0<br />Baths: 2.0","Beds: 2<br />Price:  38.5<br />Baths: 1.0","Beds: 3<br />Price: 139.0<br />Baths: 2.0","Beds: 1<br />Price:  75.0<br />Baths: 2.0","Beds: 3<br />Price: 174.0<br />Baths: 3.0","Beds: 3<br />Price: 119.0<br />Baths: 2.0","Beds: 3<br />Price:  89.0<br />Baths: 1.0","Beds: 3<br />Price:  75.1<br />Baths: 2.0","Beds: 2<br />Price:  92.5<br />Baths: 2.0","Beds: 3<br />Price: 141.0<br />Baths: 1.0","Beds: 2<br />Price:  82.0<br />Baths: 3.0","Beds: 3<br />Price: 162.0<br />Baths: 1.5","Beds: 3<br />Price: 195.0<br />Baths: 3.0","Beds: 4<br />Price: 190.0<br />Baths: 3.5","Beds: 3<br />Price: 115.0<br />Baths: 2.0","Beds: 2<br />Price:  87.0<br />Baths: 1.5"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(237,0,68,1)","rgba(215,0,114,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(255,0,0,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(0,0,255,1)","rgba(141,0,206,1)","rgba(186,0,159,1)","rgba(141,0,206,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(237,0,68,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(237,0,68,1)","rgba(141,0,206,1)","rgba(237,0,68,1)","rgba(255,0,0,1)","rgba(186,0,159,1)","rgba(141,0,206,1)"],"opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":["rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(237,0,68,1)","rgba(215,0,114,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(255,0,0,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(0,0,255,1)","rgba(141,0,206,1)","rgba(186,0,159,1)","rgba(141,0,206,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(237,0,68,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(186,0,159,1)","rgba(186,0,159,1)","rgba(0,0,255,1)","rgba(237,0,68,1)","rgba(141,0,206,1)","rgba(237,0,68,1)","rgba(255,0,0,1)","rgba(186,0,159,1)","rgba(141,0,206,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[50],"name":"99_77c288710b2b64dbc1e227d1df876e85","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#0000FF"],[0.00334448160535121,"#0F00FE"],[0.00668896321070234,"#1900FD"],[0.0100334448160536,"#2000FD"],[0.0133779264214047,"#2600FC"],[0.0167224080267559,"#2B00FB"],[0.020066889632107,"#2F00FA"],[0.0234113712374582,"#3300F9"],[0.0267558528428093,"#3700F8"],[0.0301003344481606,"#3A00F8"],[0.0334448160535117,"#3E00F7"],[0.0367892976588629,"#4100F6"],[0.040133779264214,"#4400F5"],[0.0434782608695652,"#4600F4"],[0.0468227424749164,"#4900F3"],[0.0501672240802676,"#4B00F3"],[0.0535117056856187,"#4E00F2"],[0.0568561872909699,"#5000F1"],[0.060200668896321,"#5200F0"],[0.0635451505016722,"#5400EF"],[0.0668896321070234,"#5600EF"],[0.0702341137123746,"#5800EE"],[0.0735785953177258,"#5A00ED"],[0.0769230769230769,"#5C00EC"],[0.080267558528428,"#5E00EB"],[0.0836120401337793,"#6000EB"],[0.0869565217391305,"#6200EA"],[0.0903010033444816,"#6300E9"],[0.0936454849498328,"#6500E8"],[0.0969899665551839,"#6700E7"],[0.100334448160535,"#6800E6"],[0.103678929765886,"#6A00E6"],[0.107023411371237,"#6B00E5"],[0.110367892976589,"#6D00E4"],[0.11371237458194,"#6E00E3"],[0.117056856187291,"#7000E2"],[0.120401337792642,"#7100E2"],[0.123745819397993,"#7200E1"],[0.127090301003344,"#7400E0"],[0.130434782608696,"#7500DF"],[0.133779264214047,"#7600DE"],[0.137123745819398,"#7800DE"],[0.140468227424749,"#7900DD"],[0.1438127090301,"#7A00DC"],[0.147157190635451,"#7B00DB"],[0.150501672240803,"#7D00DA"],[0.153846153846154,"#7E00DA"],[0.157190635451505,"#7F00D9"],[0.160535117056856,"#8000D8"],[0.163879598662207,"#8100D7"],[0.167224080267559,"#8200D6"],[0.17056856187291,"#8400D5"],[0.173913043478261,"#8500D5"],[0.177257525083612,"#8600D4"],[0.180602006688963,"#8700D3"],[0.183946488294314,"#8800D2"],[0.187290969899666,"#8900D1"],[0.190635451505017,"#8A00D1"],[0.193979933110368,"#8B00D0"],[0.197324414715719,"#8C00CF"],[0.20066889632107,"#8D00CE"],[0.204013377926421,"#8E00CD"],[0.207357859531773,"#8F00CD"],[0.210702341137124,"#9000CC"],[0.214046822742475,"#9100CB"],[0.217391304347826,"#9200CA"],[0.220735785953177,"#9300CA"],[0.224080267558528,"#9400C9"],[0.22742474916388,"#9400C8"],[0.230769230769231,"#9500C7"],[0.234113712374582,"#9600C6"],[0.237458193979933,"#9700C6"],[0.240802675585284,"#9800C5"],[0.244147157190635,"#9900C4"],[0.247491638795987,"#9A00C3"],[0.250836120401338,"#9B00C2"],[0.254180602006689,"#9B00C2"],[0.25752508361204,"#9C00C1"],[0.260869565217391,"#9D00C0"],[0.264214046822742,"#9E00BF"],[0.267558528428094,"#9F00BE"],[0.270903010033445,"#9F00BE"],[0.274247491638796,"#A000BD"],[0.277591973244147,"#A100BC"],[0.280936454849498,"#A200BB"],[0.28428093645485,"#A300BA"],[0.287625418060201,"#A300BA"],[0.290969899665552,"#A400B9"],[0.294314381270903,"#A500B8"],[0.297658862876254,"#A600B7"],[0.301003344481605,"#A600B7"],[0.304347826086956,"#A700B6"],[0.307692307692308,"#A800B5"],[0.311036789297659,"#A800B4"],[0.31438127090301,"#A900B3"],[0.317725752508361,"#AA00B3"],[0.321070234113712,"#AB00B2"],[0.324414715719064,"#AB00B1"],[0.327759197324415,"#AC00B0"],[0.331103678929766,"#AD00AF"],[0.334448160535117,"#AD00AF"],[0.337792642140468,"#AE00AE"],[0.341137123745819,"#AF00AD"],[0.344481605351171,"#AF00AC"],[0.347826086956522,"#B000AC"],[0.351170568561873,"#B100AB"],[0.354515050167224,"#B100AA"],[0.357859531772575,"#B200A9"],[0.361204013377926,"#B300A8"],[0.364548494983278,"#B300A8"],[0.367892976588629,"#B400A7"],[0.37123745819398,"#B400A6"],[0.374581939799331,"#B500A5"],[0.377926421404682,"#B600A5"],[0.381270903010033,"#B600A4"],[0.384615384615385,"#B700A3"],[0.387959866220736,"#B700A2"],[0.391304347826087,"#B800A1"],[0.394648829431438,"#B900A1"],[0.397993311036789,"#B900A0"],[0.401337792642141,"#BA009F"],[0.404682274247492,"#BA009E"],[0.408026755852843,"#BB009E"],[0.411371237458194,"#BC009D"],[0.414715719063545,"#BC009C"],[0.418060200668896,"#BD009B"],[0.421404682274247,"#BD009B"],[0.424749163879598,"#BE009A"],[0.42809364548495,"#BE0099"],[0.431438127090301,"#BF0098"],[0.434782608695652,"#BF0097"],[0.438127090301003,"#C00097"],[0.441471571906354,"#C10096"],[0.444816053511706,"#C10095"],[0.448160535117057,"#C20094"],[0.451505016722408,"#C20094"],[0.454849498327759,"#C30093"],[0.45819397993311,"#C30092"],[0.461538461538462,"#C40091"],[0.464882943143813,"#C40091"],[0.468227424749164,"#C50090"],[0.471571906354515,"#C5008F"],[0.474916387959866,"#C6008E"],[0.478260869565217,"#C6008D"],[0.481605351170569,"#C7008D"],[0.48494983277592,"#C7008C"],[0.488294314381271,"#C8008B"],[0.491638795986622,"#C8008A"],[0.494983277591973,"#C9008A"],[0.498327759197324,"#C90089"],[0.501672240802675,"#CA0088"],[0.505016722408027,"#CA0087"],[0.508361204013378,"#CB0087"],[0.511705685618729,"#CB0086"],[0.51505016722408,"#CC0085"],[0.518394648829431,"#CC0084"],[0.521739130434783,"#CD0084"],[0.525083612040134,"#CD0083"],[0.528428093645485,"#CE0082"],[0.531772575250836,"#CE0081"],[0.535117056856187,"#CE0080"],[0.538461538461538,"#CF0080"],[0.54180602006689,"#CF007F"],[0.545150501672241,"#D0007E"],[0.548494983277592,"#D0007D"],[0.551839464882943,"#D1007D"],[0.555183946488294,"#D1007C"],[0.558528428093645,"#D2007B"],[0.561872909698997,"#D2007A"],[0.565217391304348,"#D3007A"],[0.568561872909699,"#D30079"],[0.57190635451505,"#D30078"],[0.575250836120401,"#D40077"],[0.578595317725753,"#D40077"],[0.581939799331104,"#D50076"],[0.585284280936455,"#D50075"],[0.588628762541806,"#D60074"],[0.591973244147157,"#D60074"],[0.595317725752508,"#D60073"],[0.598662207357859,"#D70072"],[0.602006688963211,"#D70071"],[0.605351170568562,"#D80071"],[0.608695652173913,"#D80070"],[0.612040133779264,"#D8006F"],[0.615384615384615,"#D9006E"],[0.618729096989967,"#D9006E"],[0.622073578595318,"#DA006D"],[0.625418060200669,"#DA006C"],[0.62876254180602,"#DA006B"],[0.632107023411371,"#DB006A"],[0.635451505016722,"#DB006A"],[0.638795986622074,"#DC0069"],[0.642140468227425,"#DC0068"],[0.645484949832776,"#DC0067"],[0.648829431438127,"#DD0067"],[0.652173913043478,"#DD0066"],[0.65551839464883,"#DE0065"],[0.658862876254181,"#DE0064"],[0.662207357859532,"#DE0064"],[0.665551839464883,"#DF0063"],[0.668896321070234,"#DF0062"],[0.672240802675585,"#E00061"],[0.675585284280936,"#E00061"],[0.678929765886288,"#E00060"],[0.682274247491639,"#E1005F"],[0.68561872909699,"#E1005E"],[0.688963210702341,"#E1005E"],[0.692307692307692,"#E2005D"],[0.695652173913043,"#E2005C"],[0.698996655518395,"#E3005B"],[0.702341137123746,"#E3005B"],[0.705685618729097,"#E3005A"],[0.709030100334448,"#E40059"],[0.712374581939799,"#E40058"],[0.71571906354515,"#E40057"],[0.719063545150502,"#E50057"],[0.722408026755853,"#E50056"],[0.725752508361204,"#E50055"],[0.729096989966555,"#E60054"],[0.732441471571906,"#E60054"],[0.735785953177258,"#E60053"],[0.739130434782609,"#E70052"],[0.74247491638796,"#E70051"],[0.745819397993311,"#E80050"],[0.749163879598662,"#E80050"],[0.752508361204013,"#E8004F"],[0.755852842809364,"#E9004E"],[0.759197324414716,"#E9004D"],[0.762541806020067,"#E9004D"],[0.765886287625418,"#EA004C"],[0.769230769230769,"#EA004B"],[0.77257525083612,"#EA004A"],[0.775919732441471,"#EB0049"],[0.779264214046823,"#EB0049"],[0.782608695652174,"#EB0048"],[0.785953177257525,"#EC0047"],[0.789297658862876,"#EC0046"],[0.792642140468227,"#EC0046"],[0.795986622073579,"#ED0045"],[0.79933110367893,"#ED0044"],[0.802675585284281,"#ED0043"],[0.806020066889632,"#EE0042"],[0.809364548494983,"#EE0042"],[0.812709030100334,"#EE0041"],[0.816053511705686,"#EF0040"],[0.819397993311037,"#EF003F"],[0.822742474916388,"#EF003E"],[0.826086956521739,"#F0003D"],[0.82943143812709,"#F0003D"],[0.832775919732441,"#F0003C"],[0.836120401337793,"#F0003B"],[0.839464882943144,"#F1003A"],[0.842809364548495,"#F10039"],[0.846153846153846,"#F10038"],[0.849498327759197,"#F20038"],[0.852842809364548,"#F20037"],[0.8561872909699,"#F20036"],[0.859531772575251,"#F30035"],[0.862876254180602,"#F30034"],[0.866220735785953,"#F30033"],[0.869565217391304,"#F40032"],[0.872909698996655,"#F40032"],[0.876254180602007,"#F40031"],[0.879598662207358,"#F50030"],[0.882943143812709,"#F5002F"],[0.88628762541806,"#F5002E"],[0.889632107023411,"#F5002D"],[0.892976588628762,"#F6002C"],[0.896321070234114,"#F6002B"],[0.899665551839465,"#F6002A"],[0.903010033444816,"#F70029"],[0.906354515050167,"#F70028"],[0.909698996655518,"#F70027"],[0.91304347826087,"#F80026"],[0.916387959866221,"#F80025"],[0.919732441471572,"#F80024"],[0.923076923076923,"#F80023"],[0.926421404682274,"#F90022"],[0.929765886287625,"#F90021"],[0.933110367892977,"#F90020"],[0.936454849498328,"#FA001F"],[0.939799331103679,"#FA001E"],[0.94314381270903,"#FA001D"],[0.946488294314381,"#FA001B"],[0.949832775919732,"#FB001A"],[0.953177257525084,"#FB0019"],[0.956521739130435,"#FB0018"],[0.959866220735786,"#FC0016"],[0.963210702341137,"#FC0015"],[0.966555183946488,"#FC0013"],[0.969899665551839,"#FC0012"],[0.973244147157191,"#FD0010"],[0.976588628762542,"#FD000F"],[0.979933110367893,"#FD000D"],[0.983277591973244,"#FE000B"],[0.986622073578595,"#FE0008"],[0.989966555183946,"#FE0006"],[0.993311036789298,"#FE0004"],[0.996655518394649,"#FF0002"],[1,"#FF0000"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":"Baths","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["1.0","1.5","2.0","2.5","3.0","3.5"],"tickvals":[0,0.2,0.4,0.6,0.8,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.8,5.2],"tickmode":"array","ticktext":["1","2","3","4","5"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["1","2","3","4","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Beds","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[30.55,205.45],"tickmode":"array","ticktext":["50","100","150","200"],"tickvals":[50,100,150,200],"categoryorder":"array","categoryarray":["50","100","150","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Price","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"166a0bc82eca":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"166a0bc82eca","visdat":{"166a0bc82eca":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Many more interactive options in this tutorial: <a href="https://plotly.com/r/line-and-scatter/" class="uri">https://plotly.com/r/line-and-scatter/</a></p>
</div>
</div>
<div id="S.Tutorial.2D" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Distributions and tests</h1>
<p>We have talked about several distributions and tests so far in the lab. To see the help files for most of them, see <code>?Distributions</code></p>
<div id="S.Tutorial.2D.1" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Normal distribution</h2>
<p>Remember as we discussed in lectures, we normally state that a variable is ~N(mean, VARIANCE). But in these commands you need the standard deviation instead. (you can google how to get the sd from the variance if you have forgotten)</p>
<p>To see the help file for all these:</p>
<pre class="r"><code>?Normal</code></pre>
<p>To generate a random sample from a normal distribution:</p>
<pre class="r"><code>sample.normal &lt;- rnorm(n=100,mean=4,sd=2)</code></pre>
<p>To calculate a z score from your sample/population, you can use R as a calculator.</p>
<p>To calculate the probability of greater/lesser than a value in a given normal distribution (e.g. you can use this as an interactive table)</p>
<pre class="r"><code># probability of less than 1.7 in a normal distribution of N(4,2^2)
pnorm(1.7,mean=4,sd=2,lower.tail = TRUE)</code></pre>
<pre><code>## [1] 0.1250719</code></pre>
<pre class="r"><code># probability of greater than 1.8 in a normal distribution of N(4,2^2)
1 - pnorm(1,mean=4,sd=2,lower.tail = TRUE)</code></pre>
<pre><code>## [1] 0.9331928</code></pre>
<pre class="r"><code># or
pnorm(1,mean=4,sd=2,lower.tail = FALSE)</code></pre>
<pre><code>## [1] 0.9331928</code></pre>
<p>To calculate the value for a given probability</p>
<pre class="r"><code># what value is less than 60% of the data?
qnorm(0.6,mean=4,sd=2,lower.tail = TRUE)</code></pre>
<pre><code>## [1] 4.506694</code></pre>
<pre class="r"><code># what value is greater than 80% of the data?
qnorm(0.8,mean=4,sd=2,lower.tail = FALSE)</code></pre>
<pre><code>## [1] 2.316758</code></pre>
<div id="S.Tutorial.2D.3" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Wilks Shapiro test for normality</h3>
<p>To test for normality:</p>
<p>First, have a look at the histogram! Here is the code for the Shapiro-Wilk test.</p>
<pre class="r"><code>shapiro.test(HousesNY$Price)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  HousesNY$Price
## W = 0.96341, p-value = 0.1038</code></pre>
<p>You can also make a QQ-Norm plot</p>
<p>We discussed the basic qqnorm command last week: <code>qqplot(variable)</code>. For example <em>qqplot(malepirates$age)</em> makes a qq-norm plot of the age column in the data.frame we created earlier on male pirates. There is a nicer version inside the ggpubr package.</p>
<pre class="r"><code>library(ggpubr)
ggqqplot(HousesNY$Price,col=&quot;blue&quot;)</code></pre>
<p>YOU CAN INTERPRET IT HERE: <a href="https://www.learnbyexample.org/r-quantile-quantile-qq-plot-base-graph/" class="uri">https://www.learnbyexample.org/r-quantile-quantile-qq-plot-base-graph/</a></p>
</div>
</div>
<div id="S.Tutorial.2D.2" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Student’s t-distribution</h2>
<p>What even is this? See this nice resource: <a href="https://365datascience.com/tutorials/statistics-tutorials/students-t-distribution/" class="uri">https://365datascience.com/tutorials/statistics-tutorials/students-t-distribution/</a></p>
<p>To see the help file for all these:</p>
<pre class="r"><code>?TDist</code></pre>
<p>To calculate a t-statistic from your sample/population, you can use R as a calculator. To calculate the probability of greater/lesser than a value in a given t-distribution (e.f. you can use this as an interactive t-table)</p>
<pre class="r"><code># probability of seeing less than 1.7 in a  t-distribution 
# with 20 degrees of freedom
pt(1.55,df=20,lower.tail = TRUE)</code></pre>
<pre><code>## [1] 0.9315892</code></pre>
<p>To calculate the value for a given probability</p>
<pre class="r"><code># what value is greater than 90% of the data in a t-distribution with df=25
qt(0.9,df=25,lower.tail = TRUE)</code></pre>
<pre><code>## [1] 1.316345</code></pre>
<p>To conduct a full t-test on some data:</p>
<pre class="r"><code># Conduct a two-sided t-test where we think that the data comes from a T-distribution with mean 100.
t.test(HousesNY$Price,mu=100,alternative=&quot;two.sided&quot;)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  HousesNY$Price
## t = 2.3954, df = 52, p-value = 0.02024
## alternative hypothesis: true mean is not equal to 100
## 95 percent confidence interval:
##  102.2125 125.0516
## sample estimates:
## mean of x 
##  113.6321</code></pre>
<p>or see the detailed tutorial here: <a href="http://www.sthda.com/english/wiki/one-sample-t-test-in-r" class="uri">http://www.sthda.com/english/wiki/one-sample-t-test-in-r</a> for one-sample</p>
<p>and here for comparing two samples: <a href="http://www.sthda.com/english/wiki/unpaired-two-samples-t-test-in-r" class="uri">http://www.sthda.com/english/wiki/unpaired-two-samples-t-test-in-r</a></p>
<p><br> <br></p>
</div>
</div>
<div id="regression-models" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Regression models</h1>
<p>Now we will fit our first regression model.</p>
<div id="S.Tutorial.3B.1" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> “Standard” regression output</h2>
<p>The command to do this is <code>lm()</code> e.g. linear model.</p>
<pre class="r"><code>output &lt;- lm(y_column ~ x_column,data=tablename)
output</code></pre>
<p>NOTE, THE WEIRD ~ SYMBOL. This means “depends on” and it’s how we tell R what the response variable is. E.g. y depends on x, or y=mx+c. </p>
<p>For example for the NYHouses data, it would be</p>
<pre class="r"><code># response = Price, predictor = Lot size
Model1.lm &lt;- lm(Price ~ Lot,data=HousesNY)
Model1.lm</code></pre>
<pre><code>## 
## Call:
## lm(formula = Price ~ Lot, data = HousesNY)
## 
## Coefficients:
## (Intercept)          Lot  
##    114.0911      -0.5749</code></pre>
<p>So we are saying here that the equation is</p>
<p>Expected_Average_Price = -0.5749*Lot_Size + 114.0911</p>
<p>E.g. the average expected price house with no Lot/Garden is 114.09</p>
<p>You can also directly get the code for the model equation by the equatiomatic package</p>
<pre class="r"><code># YOU MIGHT NEED TO INSTALL THIS PACKAGE (SEE THE TUTORIAL)
library(equatiomatic)
extract_eq(Model1.lm,use_coefs=FALSE)</code></pre>
<p>To make it print out directly, put “asis=TRUE” as a code chunk option e.g. this code</p>
<div class="figure">
<img src="Figures/Tut7_extract_eq.png" alt="See the asis in the top, this prints the output directly when you knit" width="838" />
<p class="caption">
See the asis in the top, this prints the output directly when you knit
</p>
</div>
<p>Turns into this:</p>
<pre class="r"><code>library(equatiomatic)
extract_eq(Model1.lm,use_coefs=FALSE)</code></pre>
<p><span class="math display">\[
\operatorname{Price} = \alpha + \beta_{1}(\operatorname{Lot}) + \epsilon
\]</span></p>
<p>You can also look at the summary by looking at the summary command:</p>
<pre class="r"><code>summary(Model1.lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Price ~ Lot, data = HousesNY)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -74.775 -30.201  -5.941  27.070  83.984 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 114.0911     8.3639  13.641   &lt;2e-16 ***
## Lot          -0.5749     7.6113  -0.076     0.94    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 41.83 on 51 degrees of freedom
## Multiple R-squared:  0.0001119,  Adjusted R-squared:  -0.01949 
## F-statistic: 0.005705 on 1 and 51 DF,  p-value: 0.9401</code></pre>
<p>In both cases, we have an estimate of the intercept (0.6386) and of the gradient (-13.8103). We will discuss the other values in later labs/lectures.</p>
<p>Now let’s see how to add the regression line to our scatterplot. We can do this using <code>abline(REGRESSION_VARIABLE)</code>, where regression_variable is the name of the variable you saved the output of lm to. For example.</p>
<pre class="r"><code>plot(HousesNY$Price ~ HousesNY$Lot)
abline(lm(Price ~ Lot,data=HousesNY),col=&quot;blue&quot;,lwd=1) </code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<p>For more professional plots, see the scatterplots tutorial</p>
</div>
<div id="S.Tutorial.3B.2" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> “Fancy” OLSRR regression output</h2>
<p>If you want a different way of seeing the same output, you can use the <code>ols_regress()</code> command inside the <code>olsrr</code> package.</p>
<pre class="r"><code>library(olsrr)
Model1.lm.ols &lt;- ols_regress(Price ~ Lot,data=HousesNY)
Model1.lm.ols</code></pre>
<pre><code>##                           Model Summary                           
## -----------------------------------------------------------------
## R                        0.011       RMSE                 41.832 
## R-Squared                0.000       Coef. Var            36.813 
## Adj. R-Squared          -0.019       MSE                1749.910 
## Pred R-Squared          -0.068       MAE                  34.152 
## -----------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                ANOVA                                 
## --------------------------------------------------------------------
##                  Sum of                                             
##                 Squares        DF    Mean Square      F        Sig. 
## --------------------------------------------------------------------
## Regression        9.983         1          9.983    0.006    0.9401 
## Residual      89245.412        51       1749.910                    
## Total         89255.395        52                                   
## --------------------------------------------------------------------
## 
##                                     Parameter Estimates                                     
## -------------------------------------------------------------------------------------------
##       model       Beta    Std. Error    Std. Beta      t        Sig       lower      upper 
## -------------------------------------------------------------------------------------------
## (Intercept)    114.091         8.364                 13.641    0.000     97.300    130.882 
##         Lot     -0.575         7.611       -0.011    -0.076    0.940    -15.855     14.705 
## -------------------------------------------------------------------------------------------</code></pre>
<p>The ols_regress command produces beautiful output, but sometimes it doesn’t work well with other commands. So I tend to run a lm command at the same time to have both available.</p>
<p>Sometimes, this command can produce a weird error:</p>
<div class="figure">
<img src="Figures/Tut7_OLSRR.png" alt="This is probably because you loaded the moderndive package" width="776" />
<p class="caption">
This is probably because you loaded the moderndive package
</p>
</div>
<p>This is probably because you loaded the moderndive package. They do not play nicely together. Save your work, restart R and <strong>do not run any line that says library(moderndive)!</strong>.</p>
</div>
<div id="anova" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> ANOVA</h2>
<p>There are two quick and easy ways to make an ANOVA table. Lecture 13 describes it in a lot more detail.</p>
<div id="S.Tutorial.5A.1" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Base R</h3>
<p>Simply use the ANOVA command. For example</p>
<pre class="r"><code>data(starwars)
mymodel &lt;- lm(mass~height,data=starwars)
summary(mymodel)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mass ~ height, data = starwars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
##  -61.43  -30.03  -21.13  -17.73 1260.06 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -13.8103   111.1545  -0.124    0.902
## height        0.6386     0.6261   1.020    0.312
## 
## Residual standard error: 169.4 on 57 degrees of freedom
##   (28 observations deleted due to missingness)
## Multiple R-squared:  0.01792,    Adjusted R-squared:  0.0006956 
## F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
<pre class="r"><code>anova(mymodel)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: mass
##           Df  Sum Sq Mean Sq F value Pr(&gt;F)
## height     1   29854   29854  1.0404  0.312
## Residuals 57 1635658   28696</code></pre>
</div>
<div id="using-olsrr" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Using OLSRR</h3>
<p>In OLSRR, it’s even easier. Our standard <code>ols_regress()</code> command includes ANOVA.</p>
<pre class="r"><code>data(starwars)
mymodel &lt;- lm(mass~height,data=starwars)
ols_regress(mymodel)</code></pre>
<pre><code>##                           Model Summary                            
## ------------------------------------------------------------------
## R                        0.134       RMSE                 169.398 
## R-Squared                0.018       Coef. Var            174.078 
## Adj. R-Squared           0.001       MSE                28695.756 
## Pred R-Squared          -0.017       MAE                   46.669 
## ------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
## 
##                                 ANOVA                                  
## ----------------------------------------------------------------------
##                    Sum of                                             
##                   Squares        DF    Mean Square      F        Sig. 
## ----------------------------------------------------------------------
## Regression      29854.272         1      29854.272     1.04    0.3120 
## Residual      1635658.069        57      28695.756                    
## Total         1665512.342        58                                   
## ----------------------------------------------------------------------
## 
##                                     Parameter Estimates                                      
## --------------------------------------------------------------------------------------------
##       model       Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
## --------------------------------------------------------------------------------------------
## (Intercept)    -13.810       111.155                 -0.124    0.902    -236.393    208.773 
##      height      0.639         0.626        0.134     1.020    0.312      -0.615      1.892 
## --------------------------------------------------------------------------------------------</code></pre>
<pre class="r"><code># or 
#ols_regress(mass~height,data=starwars)</code></pre>
</div>
</div>
</div>
<div id="reading-in-and-loading-data" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Reading in and loading data</h1>
<div id="in-built-datasets" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> In-built datasets</h2>
<p>There are many datasets built into R, and even more that come with packages. To load them you simply use the <code>data</code> command. Typing data() will bring up a load of the possible datasets.</p>
<p>For example, this loads the iris dataset:</p>
<pre class="r"><code>data(&quot;iris&quot;)

glimpse(iris)</code></pre>
<pre><code>## Rows: 150
## Columns: 5
## $ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.…
## $ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
## $ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.…
## $ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
## $ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s…</code></pre>
<p>If you want to specify data from a specific package, we can also tell R that:</p>
<pre class="r"><code>data(&quot;pirates&quot;, package = &quot;yarrr&quot;)
mean(pirates$parrots)</code></pre>
<pre><code>## [1] 2.819</code></pre>
<p>All the datasets in R have a help file by using the help menu or putting a ? in front of its name. DO THIS IN THE CONSOLE NOT A CODE CHUNK.</p>
<pre class="r"><code>?pirates</code></pre>
<p><br></p>
</div>
<div id="loading-data-from-excel-files" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Loading data from Excel files</h2>
<p>R can easily read in Microsoft Excel spreadsheets using the <code>readxl</code> package:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Make sure the readxl package is loaded.</strong><br>E.g. is <code>library(readxl)</code> in your library code chunk?<br>Have you run the code chunk?</p></li>
<li><p><strong>Place your excel file in your project folder</strong>.<br>E.g. here I placed <em>Data_frostday.xlsx</em> into my project folder. MAKE SURE YOU <strong>OPEN</strong> R-STUDIO USING YOUR LAB PROJECT!! If you are not sure what I mean see <a href="https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#212_How_do_I_know_it_has_worked">Projects: How do I know if I am running one?</a> and <a href="https://psu-spatial.github.io/stat462-2022/T1_R_Basics.html#213_Returning_to_your_lab_project">returning to your project</a></p></li>
<li><p><strong>Make a new code chunk and add the read_excel() command e.g.</strong><br></p>
<pre class="r"><code>frost &lt;- read_excel(&quot;Data_frostday.xlsx&quot;)</code></pre>
<p>Here the command is <code>read_excel()</code>, you are applying this to “frostdays.xlsx” (e.g. reading in an excel file with that name), then assigning the result to a variable called frost. Because you are using your project, R knows to look inside your project folder to find the file.</p></li>
</ol>
<p>If this works, there should be no errors and nothing prints on the screen when you run the code chunk.</p>
<p>When I ran it, in the environment tab, frost appeared with a description as a table with 76 rows (observations/obs), and 7 columns (variables). In R, this type of table/spreadsheet is called a <code>data.frame</code>.</p>
<pre class="r"><code># Read in the frost.xlsx file in my project folder and assign it to a variable called frost
library(readxl)
frost    &lt;- read_excel(&quot;Data_frostdata.xlsx&quot;)
names(frost)</code></pre>
<pre><code>## [1] &quot;Station&quot;             &quot;State&quot;               &quot;Type_Fake&quot;          
## [4] &quot;Avg_DOY_SpringFrost&quot; &quot;Latitude&quot;            &quot;Longitude&quot;          
## [7] &quot;Elevation&quot;           &quot;Dist_to_Coast&quot;</code></pre>
<p>Or you can put the full file path in the read_excel command</p>
<pre class="r"><code># Read in the frost.xlsx file in my project folder and assign it to a variable called frost
library(readxl)
frost    &lt;- read_excel(&quot;/Users/hlg5155/Dropbox/My Mac (E2-GEO-WKML011)/Documents/GitHub/Teaching/stat462-2022/Data_frostdata.xlsx&quot;)
names(frost)</code></pre>
<pre><code>## [1] &quot;Station&quot;             &quot;State&quot;               &quot;Type_Fake&quot;          
## [4] &quot;Avg_DOY_SpringFrost&quot; &quot;Latitude&quot;            &quot;Longitude&quot;          
## [7] &quot;Elevation&quot;           &quot;Dist_to_Coast&quot;</code></pre>
<p><br></p>
<div id="troubleshooting-1" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Troubleshooting</h3>
<p><strong>It says it can’t find the file:</strong> - <strong>Are you running the right project? e.g. does it say Lab 3 at the top of the screen?</strong> - Did you put the file into your Lab folder? - Did you spell it right and include the full .xslx extension? - Did you use quote marks?</p>
<p><strong>It says read_excel doesn’t exist</strong> - Did you install the readxl package? - Did you load the readxl package? Go click the code chunk with the library command again! - Did you spell the command right? (case sensitive) - Did you use () afterwards so R understands that it’s a command?</p>
<p><br></p>
<p><strong>Using the wizard:</strong> Sometimes you just can’t get it working. In those cases, try the import wizard:<br></p>
<ul>
<li>Go to the file menu at the very top of the screen. Click import dataset, then From Excel. Use the wizard to find your file and get it looking correct. It will show you the code you need in the code preview.</li>
<li>Because we want to include this file in the markdown, rather than pressing OK, copy the code preview text and put it in your code chunk. DO NOT PUT THE VIEW LINE IN THERE, or every time you run it will open a new tab with the data.</li>
</ul>
<p><br></p>
</div>
</div>
<div id="Tut6b_csv" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Reading in csv Files</h2>
<p>.csv files are comma separated text files, you can read them into microsoft excel. In R, you don’t need any special package to read in a csv file</p>
<ol style="list-style-type: decimal">
<li><p>Place the csv file into your project folder</p></li>
<li><p>Use the <code>read_csv()</code> command to read it into R. Assign it to a variable or it will just print onto the screen</p></li>
<li><p>Run the code chunk, then click on the variable name in the Environment quadrant to check that it read in correctly (especially make sure that column names have read in correctly)</p></li>
</ol>
<p>For example, for to read in a csv file on PA fossils, convert it to spatial and make a map:</p>
<pre class="r"><code># Read in the some data on ozone
ozone    &lt;- read.csv(&quot;Data_Ozone.csv&quot;)

# Check the column names, or click on its name in the Environment quadrant
summary(ozone)</code></pre>
<pre><code>##     LOCATION     SITE_NAME          SHORT_NAME           LATITUDE    
##  Min.   :2001   Length:451         Length:451         Min.   :32.35  
##  1st Qu.:2402   Class :character   Class :character   1st Qu.:34.15  
##  Median :2844   Mode  :character   Mode  :character   Median :36.01  
##  Mean   :2802                                         Mean   :36.14  
##  3rd Qu.:3134                                         3rd Qu.:37.94  
##  Max.   :3759                                         Max.   :41.85  
##    LONGITUDE      OZONE_1000PPB    POPULATION_DENSITY
##  Min.   :-124.2   Min.   : 3.457   Min.   :  0.0000  
##  1st Qu.:-121.5   1st Qu.:23.617   1st Qu.:  0.5499  
##  Median :-120.0   Median :28.304   Median : 14.6029  
##  Mean   :-119.7   Mean   :30.347   Mean   : 34.9754  
##  3rd Qu.:-118.0   3rd Qu.:35.254   3rd Qu.: 53.2731  
##  Max.   :-114.6   Max.   :84.655   Max.   :406.6252</code></pre>
<p><br></p>
<div id="troubleshooting-2" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Troubleshooting</h3>
<p><strong>It says it can’t find the file:</strong> - Are you running the right project? e.g. does it say Lab 2 at the top of the screen? - Did you put the file into your Lab 2 folder? - Did you spell it right and include the full .csv extension? - Did you use quote marks?</p>
<p><br></p>
<p><strong>Using the wizard:</strong> Sometimes you just can’t get it working. In those cases, try the import wizard:<br></p>
<ul>
<li>Go to the file menu at the very top of the screen. Click import dataset, then From Excel. Use the wizard to find your file and get it looking correct. It will show you the code you need in the code preview.</li>
<li>Because we want to include this file in the markdown, rather than pressing OK, copy the code preview text and put it in your code chunk. DO NOT PUT THE VIEW LINE IN THERE, or every time you run it will open a new tab with the data.</li>
</ul>
</div>
</div>
<div id="Tut6c_csv" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Reading in txt Files</h2>
<p>Same as above but you use the read.txt command. You get a lot of options here, from telling R if it has headers/column names to changing the ‘delimiter’. See the help file and <a href="http://www.sthda.com/english/wiki/reading-data-from-txt-csv-files-r-base-functions" class="uri">http://www.sthda.com/english/wiki/reading-data-from-txt-csv-files-r-base-functions</a> for more.</p>
</div>
</div>
<div id="filtering-and-selecting-data" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Filtering and selecting data</h1>
<div id="selecting-a-specific-column" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Selecting a specific column</h2>
<p>Here I am using the NYHouses data as an example. Sometimes we want to deal with only one specific column in our spreadsheet/dataframe, for example applying the mean/standard deviation/inter-quartile range command to say just the Price column.</p>
<p>To do this, we use the $ symbol. For example, here I’m simply selecting the data in the elevation column only and saving it to a new variable called elevationdata.</p>
<pre class="r"><code>data(&quot;HousesNY&quot;)
price &lt;- HousesNY$Price

price</code></pre>
<p>Try it yourself. You should have seen that as you typed the $, it gave you all the available column names to choose from.</p>
<p>This means we can now easily summarise specific columns. For example:</p>
<ul>
<li><code>summary(HousesNY)</code> will create a summary of the whole spreadsheet,</li>
<li><code>summary(HousesNY$Price)</code> will only summarise the Price column.<br />
</li>
<li><code>mean(HousesNY$Price)</code> will take the mean of the Price column in the HousesNY dataframe.</li>
</ul>
<p><br></p>
</div>
<div id="Tut7b_table" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Table command: counts per group</h2>
<p>Sometimes we want to count the occurrences of some category in our dataset. For example, if you look at the HousesNY, it might be interesting to know how many Houses had each number of bedrooms</p>
<p>To do this, we use the table command:</p>
<pre class="r"><code>table(HousesNY$Beds)</code></pre>
<p>or to see the number with each combination of bedrooms and bathrooms:</p>
<pre class="r"><code>table(HousesNY$Beds, HousesNY$Baths)</code></pre>
<p>For more, this tutorial is excellent: <a href="https://www.cyclismo.org/tutorial/R/tables.html" class="uri">https://www.cyclismo.org/tutorial/R/tables.html</a>.</p>
<p><br></p>
</div>
<div id="group_by-command-statistics-per-group" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> “Group_by” command: statistics per group</h2>
<p>What if we want to do more than just count the number of rows?</p>
<p>Well, we can use the <code>group_by()</code> and <code>summarise()</code> commands and save our answers to a new variable.</p>
<p>Here we are making use of the pipe symbol, %&gt;%, which takes the answer from group_by and sends it directly to the summarise command.</p>
<p>Here is some data on frost dates at weather stations.</p>
<pre class="r"><code>frost    &lt;- readxl::read_excel(&quot;Data_frostdata.xlsx&quot;)
head(frost)</code></pre>
<pre><code>## # A tibble: 6 × 8
##   Station    State Type_Fake Avg_DOY_SpringFrost Latitude Longitude Elevation
##   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 Valley     AL    City                    110.      34.6     -85.6      1020
## 2 Union      AL    City                     82.3     32.0     -85.8       440
## 3 Saint      AL    Airport                  99.8     34.2     -86.8       800
## 4 Fernandina FL    City                     46.9     30.7     -81.5        13
## 5 Lake       FL    City                     60.6     30.2     -82.6       195
## 6 West       GA    City                     85.6     32.9     -85.2       575
## # … with 1 more variable: Dist_to_Coast &lt;dbl&gt;</code></pre>
<p>To summarise results by the type of weather station:</p>
<pre class="r"><code>frost.summary.type &lt;- group_by(frost, by=Type_Fake) %&gt;%
                          summarise(mean(Latitude),
                                    max(Latitude),
                                    min(Dist_to_Coast))
frost.summary.type</code></pre>
<pre><code>## # A tibble: 3 × 4
##   by                        `mean(Latitude)` `max(Latitude)` `min(Dist_to_Coast…
##   &lt;chr&gt;                                &lt;dbl&gt;           &lt;dbl&gt;               &lt;dbl&gt;
## 1 Agricultural_Research_St…             33.7            36.3                4.95
## 2 Airport                               34.4            37.3               45.4 
## 3 City                                  33.7            36.5                1.15</code></pre>
<p>Here, my code is:</p>
<ul>
<li>Splitting up the frost data by the Type_Fake column<br>(e.g. one group for City, one for Airport and one for Agricultural Research)</li>
<li>For the data rows in <em>each group</em>, calculating the mean latitude, the maximum latitude and the minimum distance to the coast</li>
<li>Saving the result to a new variable called frost.summary.type.</li>
<li>Printing the results on the screen e.g. the furthest North/maximum latitude of rows tagged Agricultural_Research_Station is 36.32 degrees.</li>
</ul>
</div>
<div id="filtering-rows-and-columns" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Filtering rows and columns</h2>
<p>Sometimes, we do not want to analyse at the entire data.frame. Instead, we would like to only look at one (or more) columns or rows.</p>
<p>There are several ways we can select data.</p>
<ul>
<li><p>To choose a specific column, we can use the <code>$</code> symbol to select its name (as described above)</p></li>
<li><p>If you know which number rows or columns you want, you can use <strong>square brackets</strong> to numerically select data.</p></li>
</ul>
<p>Essentially our data follows the format: tablename[ROWS,COLUMNS]</p>
<pre class="r"><code># This will select the data in the 5th row and 7th column
frost[5,7]</code></pre>
<pre><code>## # A tibble: 1 × 1
##   Elevation
##       &lt;dbl&gt;
## 1       195</code></pre>
<pre class="r"><code># This will select the 2nd row and ALL the columns 
frost[2,]</code></pre>
<pre><code>## # A tibble: 1 × 8
##   Station State Type_Fake Avg_DOY_SpringFrost Latitude Longitude Elevation
##   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 Union   AL    City                     82.3     32.0     -85.8       440
## # … with 1 more variable: Dist_to_Coast &lt;dbl&gt;</code></pre>
<pre class="r"><code># This will select the 3rd column and ALL the rows
frost[,3]</code></pre>
<pre><code>## # A tibble: 76 × 1
##    Type_Fake                    
##    &lt;chr&gt;                        
##  1 City                         
##  2 City                         
##  3 Airport                      
##  4 City                         
##  5 City                         
##  6 City                         
##  7 City                         
##  8 City                         
##  9 Agricultural_Research_Station
## 10 Agricultural_Research_Station
## # … with 66 more rows</code></pre>
<pre class="r"><code># similar to using its name
frost$Type_Fake</code></pre>
<pre><code>##  [1] &quot;City&quot;                          &quot;City&quot;                         
##  [3] &quot;Airport&quot;                       &quot;City&quot;                         
##  [5] &quot;City&quot;                          &quot;City&quot;                         
##  [7] &quot;City&quot;                          &quot;City&quot;                         
##  [9] &quot;Agricultural_Research_Station&quot; &quot;Agricultural_Research_Station&quot;
## [11] &quot;Agricultural_Research_Station&quot; &quot;Airport&quot;                      
## [13] &quot;Airport&quot;                       &quot;City&quot;                         
## [15] &quot;City&quot;                          &quot;Airport&quot;                      
## [17] &quot;City&quot;                          &quot;Airport&quot;                      
## [19] &quot;City&quot;                          &quot;Airport&quot;                      
## [21] &quot;City&quot;                          &quot;City&quot;                         
## [23] &quot;City&quot;                          &quot;Airport&quot;                      
## [25] &quot;Agricultural_Research_Station&quot; &quot;City&quot;                         
## [27] &quot;City&quot;                          &quot;City&quot;                         
## [29] &quot;Airport&quot;                       &quot;Agricultural_Research_Station&quot;
## [31] &quot;Airport&quot;                       &quot;City&quot;                         
## [33] &quot;City&quot;                          &quot;City&quot;                         
## [35] &quot;Airport&quot;                       &quot;Agricultural_Research_Station&quot;
## [37] &quot;City&quot;                          &quot;City&quot;                         
## [39] &quot;City&quot;                          &quot;Agricultural_Research_Station&quot;
## [41] &quot;Agricultural_Research_Station&quot; &quot;City&quot;                         
## [43] &quot;City&quot;                          &quot;Airport&quot;                      
## [45] &quot;Airport&quot;                       &quot;Airport&quot;                      
## [47] &quot;Agricultural_Research_Station&quot; &quot;City&quot;                         
## [49] &quot;City&quot;                          &quot;City&quot;                         
## [51] &quot;City&quot;                          &quot;Agricultural_Research_Station&quot;
## [53] &quot;Agricultural_Research_Station&quot; &quot;Agricultural_Research_Station&quot;
## [55] &quot;Airport&quot;                       &quot;City&quot;                         
## [57] &quot;Airport&quot;                       &quot;City&quot;                         
## [59] &quot;Airport&quot;                       &quot;City&quot;                         
## [61] &quot;Agricultural_Research_Station&quot; &quot;Airport&quot;                      
## [63] &quot;Agricultural_Research_Station&quot; &quot;City&quot;                         
## [65] &quot;City&quot;                          &quot;City&quot;                         
## [67] &quot;City&quot;                          &quot;Airport&quot;                      
## [69] &quot;Airport&quot;                       &quot;Agricultural_Research_Station&quot;
## [71] &quot;Airport&quot;                       &quot;City&quot;                         
## [73] &quot;Airport&quot;                       &quot;Airport&quot;                      
## [75] &quot;City&quot;                          &quot;Agricultural_Research_Station&quot;</code></pre>
<pre class="r"><code># We can combine our commands, this will print the 13th row of the Longitude column 
# (no comma as we&#39;re only looking at one column)
frost$Longitude[13]</code></pre>
<pre><code>## [1] -82.58</code></pre>
<pre class="r"><code># The : symbol lets you choose a sequence of numbers e.g. 1:5 is 1 2 3 4 5
# So this prints out rows 11 to 15 and all the columns
frost[11:15,]</code></pre>
<pre><code>## # A tibble: 5 × 8
##   Station  State Type_Fake        Avg_DOY_SpringFr… Latitude Longitude Elevation
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;                        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 Winthrop SC    Agricultural_Re…              87.2     34.9     -81.0       690
## 2 Little   SC    Airport                       87.7     34.2     -81.4       711
## 3 Calhoun  SC    Airport                       91.5     34.1     -82.6       530
## 4 Clemson  SC    City                          93.6     34.7     -82.8       824
## 5 De       FL    City                          71.3     30.7     -86.1       245
## # … with 1 more variable: Dist_to_Coast &lt;dbl&gt;</code></pre>
<pre class="r"><code># The &quot;c&quot; command allows you to enter whatever numbers you like.  
# So this will print out rows 4,3,7 and the &quot;Elevation&quot; and &quot;Dist_to_Coast&quot; columns
frost[c(4,3,7), c(&quot;Elevation&quot;,&quot;Dist_to_Coast&quot;)]</code></pre>
<pre><code>## # A tibble: 3 × 2
##   Elevation Dist_to_Coast
##       &lt;dbl&gt;         &lt;dbl&gt;
## 1        13          1.15
## 2       800        252.  
## 3       500        132.</code></pre>
<p>You can also add questions and commands inside the square brackets. For example here is the weather station with the lowest elevation. You can see my command chose BOTH rows where elevation = 10.</p>
<pre class="r"><code># which row has the lowest elevation
# note the double == (more below)
row_number &lt;- which(frost$Elevation == min(frost$Elevation))

# choose that row
loweststtation &lt;- frost[row_number ,  ]
loweststtation</code></pre>
<pre><code>## # A tibble: 2 × 8
##   Station     State Type_Fake      Avg_DOY_SpringF… Latitude Longitude Elevation
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;                     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 Charlestown SC    Agricultural_…             84.6     32.8     -79.9        10
## 2 Edenton     NC    City                       85.3     36.0     -76.6        10
## # … with 1 more variable: Dist_to_Coast &lt;dbl&gt;</code></pre>
<pre class="r"><code>seaside &lt;- frost[which(frost$Dist_to_Coast &lt; 10) ,  ]
seaside</code></pre>
<pre><code>## # A tibble: 5 × 8
##   Station     State Type_Fake      Avg_DOY_SpringF… Latitude Longitude Elevation
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;                     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 Fernandina  FL    City                       46.9     30.7     -81.5        13
## 2 Charlestown SC    Agricultural_…             84.6     32.8     -79.9        10
## 3 Edenton     NC    City                       85.3     36.0     -76.6        10
## 4 Southport   NC    City                       82.8     33.9     -78.0        20
## 5 Brunswick   GA    Agricultural_…             48.4     31.2     -81.5        13
## # … with 1 more variable: Dist_to_Coast &lt;dbl&gt;</code></pre>
</div>
<div id="which-command" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> which command</h2>
<p>The which command essentially says “which numbers” meet a certain threshold</p>
<p>e,g,</p>
<pre class="r"><code>a &lt;- 100:110
which(a &gt; 107)</code></pre>
<pre><code>## [1]  9 10 11</code></pre>
<p>Or which rows:</p>
<pre class="r"><code>outlier_rows &lt;- which(frost$Dist_to_Coast &lt; 1.5)</code></pre>
<div id="deleting-rows" class="section level3" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Deleting rows</h3>
<p>Or if you know the row number you can use the minus - sign to remove. Or just filter below.</p>
<pre class="r"><code># remove row 6 and and overwrite
frost &lt;- frost[-6 ,]

# remove columns 4 and 2 and save result to newdata and overwrite
newdata &lt;- frost[, - c(2,4) ]</code></pre>
</div>
<div id="the-dplyr-filter-command-tidyverse" class="section level3" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> The dplyr filter command (tidyverse)</h3>
<p>Filtering means selecting rows/observations based on their values. To filter in R, use the command <code>filter()</code> from the dplyr package. I tend to write it as <code>dplyr:filter()</code> to force it to be correct.</p>
<p>Visually, filtering rows looks like this.</p>
<p><img src="Figures/pg_Tut7_wrangle_fig2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here we can apply the filter command to choose specific rows that meet certain criteria</p>
<pre class="r"><code>filter(frost, State == &quot;FL&quot;)</code></pre>
<p>The double equal operator <code>==</code> means equal to. The command is telling R to keep the rows in <em>frost</em> where the <em>State</em> column equals “FL”.</p>
<p>If you want a few categories, choose the %in% operator, using the <code>c()</code> command to stick together the categories you want. For example, here are states in Florida and Virginia.</p>
<pre class="r"><code>filter(frost, State %in% c(&quot;FL&quot;,&quot;VA&quot;))</code></pre>
<p>We can also explicitly exclude cases and keep everything else by using the not equal operator <code>!=</code>. The following code <em>excludes</em> airport stations.</p>
<pre class="r"><code>filter(frost, Type_Fake != &quot;Airport&quot;)</code></pre>
<p>What about filtering if a row has a value greater than a specified value? For example, Stations with an elevation greater than 500 feet?</p>
<pre class="r"><code>filter(frost, Elevation &gt; 500)</code></pre>
<p>Or less-than-or-equal-to 200 feet.</p>
<pre class="r"><code># or save the result to a new variable
lowland_stations &lt;- filter(frost, Elevation &lt; 200)
summary(lowland_stations)</code></pre>
<p><br></p>
<p>In addition to comparison operators, filtering may also utilize logical operators that make multiple selections. There are three basic logical operators: <code>&amp;</code> (and), <code>|</code> (or), and <code>!</code> (not). We can keep Stations with an <em>Elevation</em> greater than 300 <strong>and</strong> <em>State</em> in Alabama <code>&amp;</code>.</p>
<pre class="r"><code>filter(frost, Elevation &gt; 300 &amp; State == &quot;AL&quot;)</code></pre>
<p>Use <code>|</code> to keep Stations with a <em>Type_Fake</em> of “Airport” <strong>or</strong> a last spring frost date after April (~ day 90 of the year).</p>
<pre class="r"><code>filter(frost, Type_Fake == &quot;Airport&quot; | Avg_DOY_SpringFrost &gt; 90 )</code></pre>
</div>
<div id="the-dplyr-arrange-command-tidyverse" class="section level3" number="11.5.3">
<h3><span class="header-section-number">11.5.3</span> The dplyr arrange command (tidyverse)</h3>
<p><br />
</p>
<p>We use the <code>arrange()</code> function to sort a data frame by one or more variables. You might want to do this to get a sense of which cases have the highest or lowest values in your data set or sort counties by their name. For example, let’s sort in ascending order by elevation.</p>
<pre class="r"><code>arrange(frost, Latitude)</code></pre>
<pre><code>## # A tibble: 75 × 8
##    Station     State Type_Fake     Avg_DOY_SpringF… Latitude Longitude Elevation
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 Inverness   FL    City                      50.6     28.8     -82.3        40
##  2 Ocala       FL    City                      52.7     29.2     -82.1        75
##  3 Lake        FL    City                      60.6     30.2     -82.6       195
##  4 Tallahassee FL    Agricultural…             75.8     30.4     -84.4        55
##  5 Fernandina  FL    City                      46.9     30.7     -81.5        13
##  6 De          FL    City                      71.3     30.7     -86.1       245
##  7 Quitman     GA    City                      65.5     30.8     -83.6       185
##  8 Brunswick   GA    Agricultural…             48.4     31.2     -81.5        13
##  9 Waycross    GA    Agricultural…             75.9     31.2     -82.3       145
## 10 Tifton      GA    City                      87.3     31.4     -83.5       380
## # … with 65 more rows, and 1 more variable: Dist_to_Coast &lt;dbl&gt;</code></pre>
<p>By default, <code>arrange()</code> sorts in ascending order. We can sort by a variable in descending order by using the <code>desc()</code> function on the variable we want to sort by. For example, to sort the dataframe by <em>Avg_DOY_SpringFrost</em> in descending order we use</p>
<pre class="r"><code>arrange(frost, desc(Avg_DOY_SpringFrost))</code></pre>
<pre><code>## # A tibble: 75 × 8
##    Station        State Type_Fake  Avg_DOY_SpringF… Latitude Longitude Elevation
##    &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 Marshall       NC    Airport                118.     35.8     -82.7      2000
##  2 Highlands      NC    Agricultu…             118.     35.0     -83.2      3333
##  3 Mt             NC    City                   113.     36.5     -80.6      1041
##  4 Louisburg      NC    City                   113.     36.1     -78.3       260
##  5 Rocky          VA    Airport                111.     37.0     -79.9      1315
##  6 Henderson      NC    Agricultu…             111.     36.3     -78.4       512
##  7 Farmville      VA    Airport                111.     37.3     -78.4       450
##  8 Statesville    NC    City                   110.     35.8     -80.9       951
##  9 Valley         AL    City                   110.     34.6     -85.6      1020
## 10 Hendersonville NC    Agricultu…             110.     35.3     -82.4      2160
## # … with 65 more rows, and 1 more variable: Dist_to_Coast &lt;dbl&gt;</code></pre>
<p><br> <br></p>
</div>
</div>
</div>
<div id="checking-line-assumptions" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Checking LINE Assumptions</h1>
<p>We know from the lectures that there are multiple assumptions underpinning whether a regression is a good model or not.These are described in detail in:</p>
<ul>
<li>Online STAT-462 - Lesson 4 (<a href="https://online.stat.psu.edu/stat462/node/116/" class="uri">https://online.stat.psu.edu/stat462/node/116/</a>)</li>
</ul>
<p>Regression diagnostics are a set of tools we can use to assess these assumptions. Many regression diagnostics include plots of standardized residuals, which we will focus on today.</p>
<p>Let’s use the example from the online textbook. Some researchers (Urbano-Marquez, et al., 1989) were interested in determining whether or not alcohol consumption was linearly related to muscle strength. The researchers measured the total lifetime consumption of alcohol (x) on a random sample of n = 50 alcoholic men. They also measured the strength (y) of the deltoid muscle in each person’s nondominant arm.</p>
<pre class="r"><code>testdata &lt;- read.csv(&quot;alcoholstrength.csv&quot;)
mymodel &lt;- lm(strength~alcohol,data=testdata)
plot(testdata$alcohol,testdata$strength,xlab=&quot;Alcohol&quot;,ylab=&quot;Strength&quot;,pch=16)
abline(mymodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<div id="S.Tutorial.5B.1" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Residual plots</h2>
<p>It can be difficult looking at the raw data to assess whether many of the assumptions are true or not. So in this case we can look at the residuals</p>
<p>We can access the residuals and many other model elements directly from the model. First, remind yourself what a residual is (see here for a good example, or Lesson 2 in the textbook. <a href="https://www.khanacademy.org/math/ap-statistics/bivariate-data-ap/xfb5d8e68:residuals/v/regression-residual-intro" class="uri">https://www.khanacademy.org/math/ap-statistics/bivariate-data-ap/xfb5d8e68:residuals/v/regression-residual-intro</a>)</p>
<div id="residuals-vs-fitted-values" class="section level3" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Residuals vs fitted values</h3>
<p>First, we could look at the residual vs the predicted value (otherwise called the “fitted value”) e.g.</p>
<div class="figure" style="text-align: center">
<img src="Figures/pg_Tut10_resod_fig1.png" alt="*Plot from here, which also as an interactive demonstration, http://www.shodor.org/interactivate/discussions/FindingResiduals/*" width="350" />
<p class="caption">
<em>Plot from here, which also as an interactive demonstration, <a href="http://www.shodor.org/interactivate/discussions/FindingResiduals/" class="uri">http://www.shodor.org/interactivate/discussions/FindingResiduals/</a></em>
</p>
</div>
<p>First, here is how to find/see the residuals</p>
<pre class="r"><code># Here are the things we can look at from the model summary
names(mymodel)</code></pre>
<pre><code>##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre>
<pre class="r"><code># see ?lm for more explanation</code></pre>
<pre class="r"><code>testdata$strength_predicted &lt;- mymodel$fitted.values
testdata$residuals          &lt;- mymodel$residuals
head(testdata)</code></pre>
<pre><code>##   alcohol strength strength_predicted residuals
## 1    36.2     1000           1565.911 -565.9109
## 2    39.7     1000           1462.357 -462.3570
## 3    39.5     1080           1468.274 -388.2744
## 4    18.2     1220           2098.474 -878.4739
## 5    29.2     1310           1773.019 -463.0187
## 6    32.5     1400           1675.382 -275.3822</code></pre>
<div id="residuals-vs-fitted-values-1" class="section level4 unnumbered">
<h4 class="unnumbered">Residuals vs fitted values</h4>
<p>The most common residual plot you will see is residuals vs predicted values for each point. You can see how to interpret it here: <a href="https://online.stat.psu.edu/stat462/node/117/" class="uri">https://online.stat.psu.edu/stat462/node/117/</a></p>
<p>Manually this is:</p>
<pre class="r"><code>plot(testdata$strength_predicted,testdata$residuals, pch=16)
abline(h=0) #plot a horizontal line</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
<p>However R has many built in functions for this one:</p>
<pre class="r"><code># using the olsrr package
ols_plot_resid_fit(mymodel)</code></pre>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/resplot-1.png" alt="A residual plot for data that likely passes all the tests for linear regression" width="672" />
<p class="caption">
A residual plot for data that likely passes all the tests for linear regression
</p>
</div>
<p>We want our residuals to be normally distributed, random (e.g. independent) and showing no pattern or unequal variance. IF YOU SEE ANY PATTERN AT ALL THAT IS NOT RANDOM IT SUGGESTS THAT ONE OF THE LINE ASSUMPTIONS IS BROKEN.</p>
</div>
<div id="residuals-vs-predictor" class="section level4 unnumbered">
<h4 class="unnumbered">Residuals vs predictor</h4>
<p>Alternatively, we can use this to manually make a plot of the residuals against the x-values (the predictor) - see here for how to interpret this and compare it to the fitted value plot <a href="https://online.stat.psu.edu/stat462/node/118/" class="uri">https://online.stat.psu.edu/stat462/node/118/</a></p>
<pre class="r"><code>plot(testdata$alcohol,testdata$residuals, pch=16)
abline(h=0) #plot a horizontal line</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
<p>Let’s use these to see how we can test the four assumptions underpinning linear regression (LINE).</p>
<p>Further residual interpretation can be seen here: <a href="https://online.stat.psu.edu/stat462/node/124/" class="uri">https://online.stat.psu.edu/stat462/node/124/</a></p>
</div>
</div>
</div>
<div id="S.Tutorial.5B.2" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Checking Linearity</h2>
<p><strong>THE AIM HERE IS TO SEE IF A CURVE (or pattern) WOULD FIT THE DATA BETTER THAN A LINE. JUST RANDOM POINTS IS OK, A CURVE/DINOSAUR IS BAD.</strong></p>
<p>If you are applying a linear model to data which is non-linear, you are in all sorts of trouble. Your model is simply a bad model and you will need some sort of transformation, or simply a better model altogether.</p>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-158-1.png" alt="Don't be the person who makes this linear model!" width="672" />
<p class="caption">
Don’t be the person who makes this linear model!
</p>
</div>
<p>ALWAYS PLOT YOUR DATA AND LOOK AT IT (even if I don’t tell you to explicitly). For more examples of why this is useful to do, see here: <a href="https://online.stat.psu.edu/stat462/node/123/" class="uri">https://online.stat.psu.edu/stat462/node/123/</a></p>
<p>However, in real life, it can often be difficult to assess whether the fit is linear by looking at the scatterplot alone. So instead, we look at the residuals, which often show a pattern much more clearly. For example</p>
<pre class="r"><code>treadwear &lt;- read.csv(&quot;treadwear.csv&quot;)
tread_model &lt;- lm(mileage~groove,data=treadwear)
plot(treadwear$groove,treadwear$mileage,xlab=&quot;groove&quot;,ylab=&quot;mileage&quot;,pch=16)
abline(tread_model)</code></pre>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-159-1.png" alt="This looks relatively linear, but...." width="672" />
<p class="caption">
This looks relatively linear, but….
</p>
</div>
<pre class="r"><code># using the olsrr package
ols_plot_resid_fit(tread_model)</code></pre>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-160-1.png" alt="A parabola would clearly fit the data better than a straight line" width="672" />
<p class="caption">
A parabola would clearly fit the data better than a straight line
</p>
</div>
<p>Compare this residual plot to the strength/alcohol example above in Figure @ref(fig:resplot). You can see in the treadwear data, the residuals depart from 0 in a very systematic manner. They are clearly positive for small x values, negative for medium x values, and positive again for large x values. Clearly, a non-linear model would better describe the relationship between the two variables. In future classes we will touch upon polynomial models that you might use to deal with this.</p>
</div>
<div id="S.Tutorial.5B.3" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Checking Independence</h2>
<p>This is a tough one. Essentially we are asking if each row in our table is independent and representative of the population. So essentially we are looking for confounding variables. Or to put it another way, is there another variable that we need to include in our model.</p>
<p>A classic example is that the order in which the sample was taken influences the result. For example, imagine I was plotting exam score against class attendance, but really the time it took for the student to finish was a better predictor, I might make the wrong assumptions.</p>
<p>Let’s say our data is not independent but we notice. What happens? First off, this isn’t so terrible compared to if linearity is broken. The linear relationship likely still stands between our predictor and our response variable. So for example, there really is a relationship between height and weight that’s relatively linear. Or house prices in our State College pre-regression example might really be taken from a normal distribution.</p>
<p>BUT, it we had taken into account this new variable ALSO, we might have done an even better job. So for example, the relationship between height and weight is definitely affected by someone’s gender. Or in the example from Lab 3, knowing how close a house is to “downtown” is a better predictor of price than knowing how far East/West it is.</p>
<p>Equally, the non independence of our data makes it hard for us to be sure how good our model is or for us to make predictions. For example, if we were looking at height and weight and our sample was made up only of people who identified as women, then there might be clear limitations in predicting the weight of the men’s basketball team.</p>
<p>Because every case is different, there is no “set method” for checking independence, but there are a few common ways to check things that you are suspicious of. So the first item is to think about the problem. What might impact your response variable that you have not taken into account.</p>
<p>USE COMMON SENSE TO THINK THROUGH WHAT NON INDEPENDENCE YOUR DATA MIGHT HAVE. FOR LAB 5, MAYBE THE ORDER IN WHICH YOU CLICKED….</p>
<div id="independence-check-1-covariance-matrix" class="section level4 unnumbered">
<h4 class="unnumbered">Independence check 1: Covariance matrix</h4>
<p>Looking at correlations is a quick (but often misleading) way to assess what is happening. Essentially we can look at the correlation between each column of data.</p>
<p>The basic way to do this is very quick and easy. For example, let’s look at our Star Wars height/data.</p>
<p>The GGally function allows us to see the histogram of each column we choose to plot - along with the correlation of any numeric pairs. Let’s look at this for a new dataset looking at how much people are tipped in New York restaurants.</p>
<pre class="r"><code># Quick display of two capabilities of GGally, to assess the distribution and correlation of variables 
house &lt;- read_excel(&quot;Lab03_house.xlsx&quot;)

# Choose column names - let&#39;s say I don&#39;t care about location
colnames(house)</code></pre>
<pre><code>## [1] &quot;House.Price&quot;      &quot;House.Age&quot;        &quot;Distance.Station&quot; &quot;Number.Shops&quot;    
## [5] &quot;Latitude&quot;         &quot;Longitude&quot;</code></pre>
<pre class="r"><code># Create plot - note I have message=TRUE and warning=TRUE turned on at the top of my code chunk
ggpairs(house[,c(&quot;House.Price&quot; ,&quot;House.Age&quot;,&quot;Distance.Station&quot;,&quot;Number.Shops&quot; )])</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
<p>You can simply look at the correlations of any NUMERIC columns using the corrplot code, as we did in Lab 3.</p>
<pre class="r"><code>library(corrplot)
house.subset &lt;- house[ , sapply(house,is.numeric)]
corrplot(cor(house.subset),method=&quot;ellipse&quot;,type=&quot;lower&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
<p>There are LOADS of other ways to run correlation plots here: <a href="https://www.r-graph-gallery.com/correlogram.html" class="uri">https://www.r-graph-gallery.com/correlogram.html</a> Feel free to choose a favourite.</p>
<p>Importantly, remember back to this website - <a href="https://www.tylervigen.com/spurious-correlations" class="uri">https://www.tylervigen.com/spurious-correlations</a>. Just because another variable is correlated with our response does not mean it HAS to be in the model. It simply means that you might want to consider whether there is a reason for that correlation.</p>
</div>
<div id="scatterplots-and-residual-plots-with-a-suspected-confounding-variable" class="section level4 unnumbered">
<h4 class="unnumbered">Scatterplots and residual plots with a suspected confounding variable</h4>
<p>A second way we looked at in a previous lab was to add colour to our scatterplot and see if we can see any influence from a suspected confounding variable.</p>
<pre class="r"><code># Create a plot
p &lt;- house %&gt;%                  
  ggplot( aes(Latitude,House.Price, col= Distance.Station)) +
  geom_point() +
  theme_classic()+
  scale_color_gradient(low=&quot;blue&quot;, high=&quot;red&quot;)

# and actually plot it
ggplotly(p)</code></pre>
<div id="htmlwidget-172334f6197c5e71dd20" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-172334f6197c5e71dd20">{"x":{"data":[{"x":[24.98298,24.98034,24.98746,24.98746,24.97937,24.96305,24.97933,24.98042,24.95095,24.96731,24.97349,24.97433,24.96515,24.96108,24.99156,24.9824,24.97744,24.97544,24.9675,24.96772,24.96314,24.97528,24.95204,24.97528,24.97353,24.97542,24.98085,24.95593,24.97419,24.97563,24.94826,24.98281,24.97349,24.97841,24.98419,25.01459,24.96386,24.95204,24.97201,24.98203,24.94155,24.94297,24.96305,24.98748,24.97445,24.97015,24.9703,24.97563,24.94684,24.94925,24.974,24.95402,24.97419,24.96515,24.98203,24.94968,24.97254,24.95744,24.94925,24.95776,24.96365,24.97585,24.96303,24.97445,24.96305,24.97635,24.96571,24.96674,24.97964,24.98746,24.97433,24.97563,24.97587,24.94155,24.98343,24.95204,24.97723,24.96322,24.97598,24.95182,24.97445,24.96427,24.96725,24.96056,24.96735,24.96853,24.9512,24.94297,24.98573,24.94783,24.9748,24.98569,24.96108,24.9492,24.9663,24.96674,24.97433,24.97746,24.98203,24.97433,24.98872,24.97371,24.96571,24.95618,24.96398,24.97744,24.97707,24.95204,24.9726,24.96299,24.96674,24.97701,24.96044,24.96172,24.98155,24.98092,24.94375,24.93885,24.96622,24.98203,24.96515,24.96515,24.98199,24.9711,24.97528,24.96571,24.97838,24.98085,24.96674,24.98086,24.98092,24.96299,24.97433,24.9866,24.96604,24.96357,24.97937,24.96495,24.97843,24.96515,24.98203,24.97213,24.97017,24.96515,24.95204,24.97563,24.9711,24.97017,24.93293,24.97349,24.96719,24.98118,24.95204,24.95418,24.94297,24.94155,24.94883,24.97886,24.97937,24.97886,24.95836,24.97723,24.94297,24.96674,24.9711,24.97694,24.97744,24.97408,24.96299,24.95468,24.94741,24.98085,24.97433,24.98326,24.9805,24.97005,24.94867,24.97697,24.99176,24.97493,24.94898,24.98489,24.96299,24.94155,24.95495,24.97285,24.96322,24.95464,24.97707,24.94297,24.97945,24.97371,24.9675,24.98246,24.93363,24.95425,24.981,24.96881,24.96628,24.96945,24.96305,24.98746,24.97559,24.98203,24.95182,24.97289,24.98343,24.97503,24.95204,24.97347,24.97937,24.9748,24.98672,24.97433,24.96731,24.972,24.97153,24.97838,24.96515,24.98102,24.97703,24.98569,24.98123,24.98569,24.97814,24.96571,24.94155,24.98059,25.00115,24.9489,24.96299,24.94235,24.95032,24.98016,24.96007,24.96606,24.98322,24.97668,24.97668,24.96334,24.96412,24.96606,24.96357,24.98236,24.97213,24.97258,24.96412,24.96211,24.96357,24.95743,24.97429,24.9496,24.97433,24.96464,24.98254,24.95095,24.97519,24.97501,24.97744,24.96334,24.97073,24.95885,24.98203,24.96299,24.96968,24.97886,24.96731,24.97433,24.97937,24.96334,24.9746,24.96945,24.96515,24.97371,24.97305,24.96772,24.95425,24.96322,24.95618,24.97026,24.96581,24.98118,24.9512,24.98674,24.96735,24.97509,24.97433,24.95425,24.97841,24.98203,24.97217,24.95744,24.95674,24.96735,24.9796,24.96299,24.99176,24.97003,24.94155,24.98178,24.96696,24.97229,24.95885,24.97161,24.96622,24.98203,24.97369,24.9546,24.98203,24.94883,24.95394,24.97425,24.97071,24.96674,24.97201,24.9832,24.96606,24.97795,24.98343,24.95562,24.93885,24.98872,24.97388,24.97631,24.96412,24.97015,24.95744,24.97538,24.97003,24.93885,24.94935,24.94826,24.97577,24.96674,24.99006,24.96431,24.98407,24.96871,24.96867,24.98254,24.97281,24.97371,24.97433,24.98223,24.998,24.9711,24.96412,24.95719,24.97585,24.96674,24.96515,24.96324,24.96143,24.96299,24.95204,24.98085,24.97417,24.96853,24.96571,24.95505,24.983,24.97345,24.98872,24.98182,24.97913,24.96182,24.95153,24.96464,24.97544,24.96322,24.98203,24.95591,24.96628,24.9748,24.97937,24.96165,24.96447,24.95836,24.97077,24.97744,24.98203,24.98298,24.93207,24.97845,24.94297,24.983,24.9711,24.96042,24.95957,24.96756,24.97151,24.95155,24.97927,24.98872,24.95544,24.974,24.97198,24.99156,24.96447,24.97371,24.97433,24.96305,24.97388,24.98353,24.98203,24.95663,24.97293,24.95505,24.9633,24.94155,24.97433,24.97923,24.96674,24.97433],"y":[37.9,42.2,47.3,54.8,43.1,32.1,40.3,46.7,18.8,22.1,41.4,58.1,39.3,23.8,34.3,50.5,70.1,37.4,42.3,47.7,29.3,51.6,24.6,47.9,38.8,27,56.2,33.6,47,57.1,22.1,25,34.2,49.3,55.1,27.3,22.9,25.3,47.7,46.2,15.9,18.2,34.7,34.1,53.9,38.3,42,61.5,13.4,13.2,44.2,20.7,27,38.9,51.7,13.7,41.9,53.5,22.6,42.4,21.3,63.2,27.7,55,25.3,44.3,50.7,56.8,36.2,42,59,40.8,36.3,20,54.4,29.5,36.8,25.6,29.8,26.5,40.3,36.8,48.1,17.7,43.7,50.8,27,18.3,48,25.3,45.4,43.2,21.8,16.1,41,51.8,59.5,34.6,51,62.2,38.2,32.9,54.4,45.7,30.5,71,47.1,26.6,34.1,28.4,51.6,39.4,23.1,7.6,53.3,46.4,12.2,13,30.6,59.6,31.3,48,32.5,45.5,57.4,48.6,62.9,55,60.7,41,37.5,30.7,37.5,39.5,42.2,20.8,46.8,47.4,43.5,42.5,51.4,28.9,37.5,40.1,28.4,45.5,52.2,43.2,45.1,39.7,48.5,44.7,28.9,40.9,20.7,15.6,18.3,35.6,39.4,37.4,57.8,39.6,11.6,55.5,55.2,30.6,73.6,43.4,37.4,23.5,14.4,58.8,58.1,35.1,45.2,36.5,19.2,42,36.7,42.6,15.5,55.9,23.6,18.8,21.8,21.5,25.7,22,44.3,20.5,42.3,37.8,42.7,49.3,29.3,34.6,36.6,48.2,39.1,31.6,25.5,45.9,31.5,46.1,26.6,21.4,44,34.2,26.2,40.9,52.2,43.5,31.1,58,20.9,48.1,39.7,40.8,43.8,40.2,78.3,38.5,48.5,42.3,46,49,12.8,40.2,46.6,19,33.4,14.7,17.4,32.4,23.9,39.3,61.9,39,40.6,29.7,28.8,41.4,33.4,48.2,21.7,40.8,40.6,23.1,22.3,15,30,13.8,52.7,25.9,51.8,17.4,26.5,43.9,63.3,28.8,30.7,24.4,53,31.7,40.6,38.1,23.7,41.1,40.1,23,117.5,26.5,40.5,29.3,41,49.7,34,27.7,44,31.1,45.4,44.8,25.6,23.5,34.4,55.3,56.3,32.9,51,44.5,37,54.4,24.5,42.5,38.1,21.8,34.1,28.5,16.7,46.1,36.9,35.7,23.2,38.4,29.4,55,50.2,24.7,53,19.1,24.7,42.2,78,42.8,41.6,27.3,42,37.5,49.8,26.9,18.6,37.7,33.1,42.5,31.3,38.1,62.1,36.7,23.6,19.2,12.8,15.6,39.6,38.4,22.8,36.5,35.6,30.9,36.3,50.4,42.9,37,53.5,46.6,41.2,37.9,30.8,11.2,53.7,47,42.3,28.6,25.7,31.3,30.1,60.7,45.3,44.9,45.1,24.7,47.1,63.3,40,48,33.1,29.5,24.8,20.9,43.1,22.8,42.1,51.7,41.5,52.2,49.5,23.8,30.5,56.8,37.4,69.7,53.3,47.3,29.3,40.3,12.9,46.6,55.3,25.6,27.3,67.7,38.6,31.3,35.3,40.3,24.7,42.5,31.9,32.2,23,37.3,35.5,27.7,28.5,39.7,41.2,37.2,40.5,22.3,28.1,15.4,50,40.6,52.5,63.9],"text":["Latitude: 24.98298<br />House.Price:  37.9<br />Distance.Station:   84.87882","Latitude: 24.98034<br />House.Price:  42.2<br />Distance.Station:  306.59470","Latitude: 24.98746<br />House.Price:  47.3<br />Distance.Station:  561.98450","Latitude: 24.98746<br />House.Price:  54.8<br />Distance.Station:  561.98450","Latitude: 24.97937<br />House.Price:  43.1<br />Distance.Station:  390.56840","Latitude: 24.96305<br />House.Price:  32.1<br />Distance.Station: 2175.03000","Latitude: 24.97933<br />House.Price:  40.3<br />Distance.Station:  623.47310","Latitude: 24.98042<br />House.Price:  46.7<br />Distance.Station:  287.60250","Latitude: 24.95095<br />House.Price:  18.8<br />Distance.Station: 5512.03800","Latitude: 24.96731<br />House.Price:  22.1<br />Distance.Station: 1783.18000","Latitude: 24.97349<br />House.Price:  41.4<br />Distance.Station:  405.21340","Latitude: 24.97433<br />House.Price:  58.1<br />Distance.Station:   90.45606","Latitude: 24.96515<br />House.Price:  39.3<br />Distance.Station:  492.23130","Latitude: 24.96108<br />House.Price:  23.8<br />Distance.Station: 2469.64500","Latitude: 24.99156<br />House.Price:  34.3<br />Distance.Station: 1164.83800","Latitude: 24.98240<br />House.Price:  50.5<br />Distance.Station:  579.20830","Latitude: 24.97744<br />House.Price:  70.1<br />Distance.Station:  292.99780","Latitude: 24.97544<br />House.Price:  37.4<br />Distance.Station:  350.85150","Latitude: 24.96750<br />House.Price:  42.3<br />Distance.Station:  368.13630","Latitude: 24.96772<br />House.Price:  47.7<br />Distance.Station:   23.38284","Latitude: 24.96314<br />House.Price:  29.3<br />Distance.Station: 2275.87700","Latitude: 24.97528<br />House.Price:  51.6<br />Distance.Station:  279.17260","Latitude: 24.95204<br />House.Price:  24.6<br />Distance.Station: 1360.13900","Latitude: 24.97528<br />House.Price:  47.9<br />Distance.Station:  279.17260","Latitude: 24.97353<br />House.Price:  38.8<br />Distance.Station:  480.69770","Latitude: 24.97542<br />House.Price:  27.0<br />Distance.Station: 1487.86800","Latitude: 24.98085<br />House.Price:  56.2<br />Distance.Station:  383.86240","Latitude: 24.95593<br />House.Price:  33.6<br />Distance.Station:  276.44900","Latitude: 24.97419<br />House.Price:  47.0<br />Distance.Station:  557.47800","Latitude: 24.97563<br />House.Price:  57.1<br />Distance.Station:  451.24380","Latitude: 24.94826<br />House.Price:  22.1<br />Distance.Station: 4519.69000","Latitude: 24.98281<br />House.Price:  25.0<br />Distance.Station:  769.40340","Latitude: 24.97349<br />House.Price:  34.2<br />Distance.Station:  488.57270","Latitude: 24.97841<br />House.Price:  49.3<br />Distance.Station:  323.65500","Latitude: 24.98419<br />House.Price:  55.1<br />Distance.Station:  205.36700","Latitude: 25.01459<br />House.Price:  27.3<br />Distance.Station: 4079.41800","Latitude: 24.96386<br />House.Price:  22.9<br />Distance.Station: 1935.00900","Latitude: 24.95204<br />House.Price:  25.3<br />Distance.Station: 1360.13900","Latitude: 24.97201<br />House.Price:  47.7<br />Distance.Station:  577.96150","Latitude: 24.98203<br />House.Price:  46.2<br />Distance.Station:  289.32480","Latitude: 24.94155<br />House.Price:  15.9<br />Distance.Station: 4082.01500","Latitude: 24.94297<br />House.Price:  18.2<br />Distance.Station: 4066.58700","Latitude: 24.96305<br />House.Price:  34.7<br />Distance.Station:  519.46170","Latitude: 24.98748<br />House.Price:  34.1<br />Distance.Station:  512.78710","Latitude: 24.97445<br />House.Price:  53.9<br />Distance.Station:  533.47620","Latitude: 24.97015<br />House.Price:  38.3<br />Distance.Station:  488.81930","Latitude: 24.97030<br />House.Price:  42.0<br />Distance.Station:  463.96230","Latitude: 24.97563<br />House.Price:  61.5<br />Distance.Station:  640.73910","Latitude: 24.94684<br />House.Price:  13.4<br />Distance.Station: 4605.74900","Latitude: 24.94925<br />House.Price:  13.2<br />Distance.Station: 4510.35900","Latitude: 24.97400<br />House.Price:  44.2<br />Distance.Station:  512.54870","Latitude: 24.95402<br />House.Price:  20.7<br />Distance.Station: 1758.40600","Latitude: 24.97419<br />House.Price:  27.0<br />Distance.Station: 1438.57900","Latitude: 24.96515<br />House.Price:  38.9<br />Distance.Station:  492.23130","Latitude: 24.98203<br />House.Price:  51.7<br />Distance.Station:  289.32480","Latitude: 24.94968<br />House.Price:  13.7<br />Distance.Station: 1160.63200","Latitude: 24.97254<br />House.Price:  41.9<br />Distance.Station:  371.24950","Latitude: 24.95744<br />House.Price:  53.5<br />Distance.Station:   56.47425","Latitude: 24.94925<br />House.Price:  22.6<br />Distance.Station: 4510.35900","Latitude: 24.95776<br />House.Price:  42.4<br />Distance.Station:  336.05320","Latitude: 24.96365<br />House.Price:  21.3<br />Distance.Station: 1931.20700","Latitude: 24.97585<br />House.Price:  63.2<br />Distance.Station:  259.66070","Latitude: 24.96303<br />House.Price:  27.7<br />Distance.Station: 2175.87700","Latitude: 24.97445<br />House.Price:  55.0<br />Distance.Station:  533.47620","Latitude: 24.96305<br />House.Price:  25.3<br />Distance.Station:  995.75540","Latitude: 24.97635<br />House.Price:  44.3<br />Distance.Station:  123.74290","Latitude: 24.96571<br />House.Price:  50.7<br />Distance.Station:  193.58450","Latitude: 24.96674<br />House.Price:  56.8<br />Distance.Station:  104.81010","Latitude: 24.97964<br />House.Price:  36.2<br />Distance.Station:  464.22300","Latitude: 24.98746<br />House.Price:  42.0<br />Distance.Station:  561.98450","Latitude: 24.97433<br />House.Price:  59.0<br />Distance.Station:   90.45606","Latitude: 24.97563<br />House.Price:  40.8<br />Distance.Station:  640.73910","Latitude: 24.97587<br />House.Price:  36.3<br />Distance.Station:  424.54420","Latitude: 24.94155<br />House.Price:  20.0<br />Distance.Station: 4082.01500","Latitude: 24.98343<br />House.Price:  54.4<br />Distance.Station:  379.55750","Latitude: 24.95204<br />House.Price:  29.5<br />Distance.Station: 1360.13900","Latitude: 24.97723<br />House.Price:  36.8<br />Distance.Station:  616.40040","Latitude: 24.96322<br />House.Price:  25.6<br />Distance.Station: 2185.12800","Latitude: 24.97598<br />House.Price:  29.8<br />Distance.Station:  552.43710","Latitude: 24.95182<br />House.Price:  26.5<br />Distance.Station: 1414.83700","Latitude: 24.97445<br />House.Price:  40.3<br />Distance.Station:  533.47620","Latitude: 24.96427<br />House.Price:  36.8<br />Distance.Station:  377.79560","Latitude: 24.96725<br />House.Price:  48.1<br />Distance.Station:  150.93470","Latitude: 24.96056<br />House.Price:  17.7<br />Distance.Station: 2707.39200","Latitude: 24.96735<br />House.Price:  43.7<br />Distance.Station:  383.28050","Latitude: 24.96853<br />House.Price:  50.8<br />Distance.Station:  338.96790","Latitude: 24.95120<br />House.Price:  27.0<br />Distance.Station: 1455.79800","Latitude: 24.94297<br />House.Price:  18.3<br />Distance.Station: 4066.58700","Latitude: 24.98573<br />House.Price:  48.0<br />Distance.Station: 1406.43000","Latitude: 24.94783<br />House.Price:  25.3<br />Distance.Station: 3947.94500","Latitude: 24.97480<br />House.Price:  45.4<br />Distance.Station:  274.01440","Latitude: 24.98569<br />House.Price:  43.2<br />Distance.Station: 1402.01600","Latitude: 24.96108<br />House.Price:  21.8<br />Distance.Station: 2469.64500","Latitude: 24.94920<br />House.Price:  16.1<br />Distance.Station: 1146.32900","Latitude: 24.96630<br />House.Price:  41.0<br />Distance.Station:  167.59890","Latitude: 24.96674<br />House.Price:  51.8<br />Distance.Station:  104.81010","Latitude: 24.97433<br />House.Price:  59.5<br />Distance.Station:   90.45606","Latitude: 24.97746<br />House.Price:  34.6<br />Distance.Station:  617.44240","Latitude: 24.98203<br />House.Price:  51.0<br />Distance.Station:  289.32480","Latitude: 24.97433<br />House.Price:  62.2<br />Distance.Station:   90.45606","Latitude: 24.98872<br />House.Price:  38.2<br />Distance.Station:  964.74960","Latitude: 24.97371<br />House.Price:  32.9<br />Distance.Station:  170.12890","Latitude: 24.96571<br />House.Price:  54.4<br />Distance.Station:  193.58450","Latitude: 24.95618<br />House.Price:  45.7<br />Distance.Station:  208.39050","Latitude: 24.96398<br />House.Price:  30.5<br />Distance.Station:  392.44590","Latitude: 24.97744<br />House.Price:  71.0<br />Distance.Station:  292.99780","Latitude: 24.97707<br />House.Price:  47.1<br />Distance.Station:  189.51810","Latitude: 24.95204<br />House.Price:  26.6<br />Distance.Station: 1360.13900","Latitude: 24.97260<br />House.Price:  34.1<br />Distance.Station:  592.50060","Latitude: 24.96299<br />House.Price:  28.4<br />Distance.Station: 2147.37600","Latitude: 24.96674<br />House.Price:  51.6<br />Distance.Station:  104.81010","Latitude: 24.97701<br />House.Price:  39.4<br />Distance.Station:  196.61720","Latitude: 24.96044<br />House.Price:  23.1<br />Distance.Station: 2102.42700","Latitude: 24.96172<br />House.Price:   7.6<br />Distance.Station:  393.26060","Latitude: 24.98155<br />House.Price:  53.3<br />Distance.Station:  143.83830","Latitude: 24.98092<br />House.Price:  46.4<br />Distance.Station:  737.91610","Latitude: 24.94375<br />House.Price:  12.2<br />Distance.Station: 6396.28300","Latitude: 24.93885<br />House.Price:  13.0<br />Distance.Station: 4197.34900","Latitude: 24.96622<br />House.Price:  30.6<br />Distance.Station: 1583.72200","Latitude: 24.98203<br />House.Price:  59.6<br />Distance.Station:  289.32480","Latitude: 24.96515<br />House.Price:  31.3<br />Distance.Station:  492.23130","Latitude: 24.96515<br />House.Price:  48.0<br />Distance.Station:  492.23130","Latitude: 24.98199<br />House.Price:  32.5<br />Distance.Station:  414.94760","Latitude: 24.97110<br />House.Price:  45.5<br />Distance.Station:  185.42960","Latitude: 24.97528<br />House.Price:  57.4<br />Distance.Station:  279.17260","Latitude: 24.96571<br />House.Price:  48.6<br />Distance.Station:  193.58450","Latitude: 24.97838<br />House.Price:  62.9<br />Distance.Station:  804.68970","Latitude: 24.98085<br />House.Price:  55.0<br />Distance.Station:  383.86240","Latitude: 24.96674<br />House.Price:  60.7<br />Distance.Station:  124.99120","Latitude: 24.98086<br />House.Price:  41.0<br />Distance.Station:  216.83290","Latitude: 24.98092<br />House.Price:  37.5<br />Distance.Station:  535.52700","Latitude: 24.96299<br />House.Price:  30.7<br />Distance.Station: 2147.37600","Latitude: 24.97433<br />House.Price:  37.5<br />Distance.Station:  482.75810","Latitude: 24.98660<br />House.Price:  39.5<br />Distance.Station:  373.39370","Latitude: 24.96604<br />House.Price:  42.2<br />Distance.Station:  186.96860","Latitude: 24.96357<br />House.Price:  20.8<br />Distance.Station: 1009.23500","Latitude: 24.97937<br />House.Price:  46.8<br />Distance.Station:  390.56840","Latitude: 24.96495<br />House.Price:  47.4<br />Distance.Station:  319.07080","Latitude: 24.97843<br />House.Price:  43.5<br />Distance.Station:  942.46640","Latitude: 24.96515<br />House.Price:  42.5<br />Distance.Station:  492.23130","Latitude: 24.98203<br />House.Price:  51.4<br />Distance.Station:  289.32480","Latitude: 24.97213<br />House.Price:  28.9<br />Distance.Station: 1559.82700","Latitude: 24.97017<br />House.Price:  37.5<br />Distance.Station:  640.60710","Latitude: 24.96515<br />House.Price:  40.1<br />Distance.Station:  492.23130","Latitude: 24.95204<br />House.Price:  28.4<br />Distance.Station: 1360.13900","Latitude: 24.97563<br />House.Price:  45.5<br />Distance.Station:  451.24380","Latitude: 24.97110<br />House.Price:  52.2<br />Distance.Station:  185.42960","Latitude: 24.97017<br />House.Price:  43.2<br />Distance.Station:  489.88210","Latitude: 24.93293<br />House.Price:  45.1<br />Distance.Station: 3780.59000","Latitude: 24.97349<br />House.Price:  39.7<br />Distance.Station:  179.45380","Latitude: 24.96719<br />House.Price:  48.5<br />Distance.Station:  170.73110","Latitude: 24.98118<br />House.Price:  44.7<br />Distance.Station:  387.77210","Latitude: 24.95204<br />House.Price:  28.9<br />Distance.Station: 1360.13900","Latitude: 24.95418<br />House.Price:  40.9<br />Distance.Station:  376.17090","Latitude: 24.94297<br />House.Price:  20.7<br />Distance.Station: 4066.58700","Latitude: 24.94155<br />House.Price:  15.6<br />Distance.Station: 4082.01500","Latitude: 24.94883<br />House.Price:  18.3<br />Distance.Station: 1264.73000","Latitude: 24.97886<br />House.Price:  35.6<br />Distance.Station:  815.93140","Latitude: 24.97937<br />House.Price:  39.4<br />Distance.Station:  390.56840","Latitude: 24.97886<br />House.Price:  37.4<br />Distance.Station:  815.93140","Latitude: 24.95836<br />House.Price:  57.8<br />Distance.Station:   49.66105","Latitude: 24.97723<br />House.Price:  39.6<br />Distance.Station:  616.40040","Latitude: 24.94297<br />House.Price:  11.6<br />Distance.Station: 4066.58700","Latitude: 24.96674<br />House.Price:  55.5<br />Distance.Station:  104.81010","Latitude: 24.97110<br />House.Price:  55.2<br />Distance.Station:  185.42960","Latitude: 24.97694<br />House.Price:  30.6<br />Distance.Station: 1236.56400","Latitude: 24.97744<br />House.Price:  73.6<br />Distance.Station:  292.99780","Latitude: 24.97408<br />House.Price:  43.4<br />Distance.Station:  330.08540","Latitude: 24.96299<br />House.Price:  37.4<br />Distance.Station:  515.11220","Latitude: 24.95468<br />House.Price:  23.5<br />Distance.Station: 1962.62800","Latitude: 24.94741<br />House.Price:  14.4<br />Distance.Station: 4527.68700","Latitude: 24.98085<br />House.Price:  58.8<br />Distance.Station:  383.86240","Latitude: 24.97433<br />House.Price:  58.1<br />Distance.Station:   90.45606","Latitude: 24.98326<br />House.Price:  35.1<br />Distance.Station:  401.88070","Latitude: 24.98050<br />House.Price:  45.2<br />Distance.Station:  432.03850","Latitude: 24.97005<br />House.Price:  36.5<br />Distance.Station:  472.17450","Latitude: 24.94867<br />House.Price:  19.2<br />Distance.Station: 4573.77900","Latitude: 24.97697<br />House.Price:  42.0<br />Distance.Station:  181.07660","Latitude: 24.99176<br />House.Price:  36.7<br />Distance.Station: 1144.43600","Latitude: 24.97493<br />House.Price:  42.6<br />Distance.Station:  438.85130","Latitude: 24.94898<br />House.Price:  15.5<br />Distance.Station: 4449.27000","Latitude: 24.98489<br />House.Price:  55.9<br />Distance.Station:  201.89390","Latitude: 24.96299<br />House.Price:  23.6<br />Distance.Station: 2147.37600","Latitude: 24.94155<br />House.Price:  18.8<br />Distance.Station: 4082.01500","Latitude: 24.95495<br />House.Price:  21.8<br />Distance.Station: 2615.46500","Latitude: 24.97285<br />House.Price:  21.5<br />Distance.Station: 1447.28600","Latitude: 24.96322<br />House.Price:  25.7<br />Distance.Station: 2185.12800","Latitude: 24.95464<br />House.Price:  22.0<br />Distance.Station: 3078.17600","Latitude: 24.97707<br />House.Price:  44.3<br />Distance.Station:  190.03920","Latitude: 24.94297<br />House.Price:  20.5<br />Distance.Station: 4066.58700","Latitude: 24.97945<br />House.Price:  42.3<br />Distance.Station:  616.57350","Latitude: 24.97371<br />House.Price:  37.8<br />Distance.Station:  750.07040","Latitude: 24.96750<br />House.Price:  42.7<br />Distance.Station:   57.58945","Latitude: 24.98246<br />House.Price:  49.3<br />Distance.Station:  421.47900","Latitude: 24.93363<br />House.Price:  29.3<br />Distance.Station: 3771.89500","Latitude: 24.95425<br />House.Price:  34.6<br />Distance.Station:  461.10160","Latitude: 24.98100<br />House.Price:  36.6<br />Distance.Station:  707.90670","Latitude: 24.96881<br />House.Price:  48.2<br />Distance.Station:  126.72860","Latitude: 24.96628<br />House.Price:  39.1<br />Distance.Station:  157.60520","Latitude: 24.96945<br />House.Price:  31.6<br />Distance.Station:  451.64190","Latitude: 24.96305<br />House.Price:  25.5<br />Distance.Station:  995.75540","Latitude: 24.98746<br />House.Price:  45.9<br />Distance.Station:  561.98450","Latitude: 24.97559<br />House.Price:  31.5<br />Distance.Station:  642.69850","Latitude: 24.98203<br />House.Price:  46.1<br />Distance.Station:  289.32480","Latitude: 24.95182<br />House.Price:  26.6<br />Distance.Station: 1414.83700","Latitude: 24.97289<br />House.Price:  21.4<br />Distance.Station: 1449.72200","Latitude: 24.98343<br />House.Price:  44.0<br />Distance.Station:  379.55750","Latitude: 24.97503<br />House.Price:  34.2<br />Distance.Station:  665.06360","Latitude: 24.95204<br />House.Price:  26.2<br />Distance.Station: 1360.13900","Latitude: 24.97347<br />House.Price:  40.9<br />Distance.Station:  175.62940","Latitude: 24.97937<br />House.Price:  52.2<br />Distance.Station:  390.56840","Latitude: 24.97480<br />House.Price:  43.5<br />Distance.Station:  274.01440","Latitude: 24.98672<br />House.Price:  31.1<br />Distance.Station: 1805.66500","Latitude: 24.97433<br />House.Price:  58.0<br />Distance.Station:   90.45606","Latitude: 24.96731<br />House.Price:  20.9<br />Distance.Station: 1783.18000","Latitude: 24.97200<br />House.Price:  48.1<br />Distance.Station:  383.71290","Latitude: 24.97153<br />House.Price:  39.7<br />Distance.Station:  590.92920","Latitude: 24.97838<br />House.Price:  40.8<br />Distance.Station:  372.62420","Latitude: 24.96515<br />House.Price:  43.8<br />Distance.Station:  492.23130","Latitude: 24.98102<br />House.Price:  40.2<br />Distance.Station:  529.77710","Latitude: 24.97703<br />House.Price:  78.3<br />Distance.Station:  186.51010","Latitude: 24.98569<br />House.Price:  38.5<br />Distance.Station: 1402.01600","Latitude: 24.98123<br />House.Price:  48.5<br />Distance.Station:  431.11140","Latitude: 24.98569<br />House.Price:  42.3<br />Distance.Station: 1402.01600","Latitude: 24.97814<br />House.Price:  46.0<br />Distance.Station:  324.94190","Latitude: 24.96571<br />House.Price:  49.0<br />Distance.Station:  193.58450","Latitude: 24.94155<br />House.Price:  12.8<br />Distance.Station: 4082.01500","Latitude: 24.98059<br />House.Price:  40.2<br />Distance.Station:  265.06090","Latitude: 25.00115<br />House.Price:  46.6<br />Distance.Station: 3171.32900","Latitude: 24.94890<br />House.Price:  19.0<br />Distance.Station: 1156.41200","Latitude: 24.96299<br />House.Price:  33.4<br />Distance.Station: 2147.37600","Latitude: 24.94235<br />House.Price:  14.7<br />Distance.Station: 4074.73600","Latitude: 24.95032<br />House.Price:  17.4<br />Distance.Station: 4412.76500","Latitude: 24.98016<br />House.Price:  32.4<br />Distance.Station:  333.36790","Latitude: 24.96007<br />House.Price:  23.9<br />Distance.Station: 2216.61200","Latitude: 24.96606<br />House.Price:  39.3<br />Distance.Station:  250.63100","Latitude: 24.98322<br />House.Price:  61.9<br />Distance.Station:  373.83890","Latitude: 24.97668<br />House.Price:  39.0<br />Distance.Station:  732.85280","Latitude: 24.97668<br />House.Price:  40.6<br />Distance.Station:  732.85280","Latitude: 24.96334<br />House.Price:  29.7<br />Distance.Station:  837.72330","Latitude: 24.96412<br />House.Price:  28.8<br />Distance.Station: 1712.63200","Latitude: 24.96606<br />House.Price:  41.4<br />Distance.Station:  250.63100","Latitude: 24.96357<br />House.Price:  33.4<br />Distance.Station: 2077.39000","Latitude: 24.98236<br />House.Price:  48.2<br />Distance.Station:  204.17050","Latitude: 24.97213<br />House.Price:  21.7<br />Distance.Station: 1559.82700","Latitude: 24.97258<br />House.Price:  40.8<br />Distance.Station:  639.61980","Latitude: 24.96412<br />House.Price:  40.6<br />Distance.Station:  389.82190","Latitude: 24.96211<br />House.Price:  23.1<br />Distance.Station: 1055.06700","Latitude: 24.96357<br />House.Price:  22.3<br />Distance.Station: 1009.23500","Latitude: 24.95743<br />House.Price:  15.0<br />Distance.Station: 6306.15300","Latitude: 24.97429<br />House.Price:  30.0<br />Distance.Station:  424.71320","Latitude: 24.94960<br />House.Price:  13.8<br />Distance.Station: 1159.45400","Latitude: 24.97433<br />House.Price:  52.7<br />Distance.Station:   90.45606","Latitude: 24.96464<br />House.Price:  25.9<br />Distance.Station: 1735.59500","Latitude: 24.98254<br />House.Price:  51.8<br />Distance.Station:  329.97470","Latitude: 24.95095<br />House.Price:  17.4<br />Distance.Station: 5512.03800","Latitude: 24.97519<br />House.Price:  26.5<br />Distance.Station:  339.22890","Latitude: 24.97501<br />House.Price:  43.9<br />Distance.Station:  444.13340","Latitude: 24.97744<br />House.Price:  63.3<br />Distance.Station:  292.99780","Latitude: 24.96334<br />House.Price:  28.8<br />Distance.Station:  837.72330","Latitude: 24.97073<br />House.Price:  30.7<br />Distance.Station: 1485.09700","Latitude: 24.95885<br />House.Price:  24.4<br />Distance.Station: 2288.01100","Latitude: 24.98203<br />House.Price:  53.0<br />Distance.Station:  289.32480","Latitude: 24.96299<br />House.Price:  31.7<br />Distance.Station: 2147.37600","Latitude: 24.96968<br />House.Price:  40.6<br />Distance.Station:  493.65700","Latitude: 24.97886<br />House.Price:  38.1<br />Distance.Station:  815.93140","Latitude: 24.96731<br />House.Price:  23.7<br />Distance.Station: 1783.18000","Latitude: 24.97433<br />House.Price:  41.1<br />Distance.Station:  482.75810","Latitude: 24.97937<br />House.Price:  40.1<br />Distance.Station:  390.56840","Latitude: 24.96334<br />House.Price:  23.0<br />Distance.Station:  837.72330","Latitude: 24.97460<br />House.Price: 117.5<br />Distance.Station:  252.58220","Latitude: 24.96945<br />House.Price:  26.5<br />Distance.Station:  451.64190","Latitude: 24.96515<br />House.Price:  40.5<br />Distance.Station:  492.23130","Latitude: 24.97371<br />House.Price:  29.3<br />Distance.Station:  170.12890","Latitude: 24.97305<br />House.Price:  41.0<br />Distance.Station:  394.01730","Latitude: 24.96772<br />House.Price:  49.7<br />Distance.Station:   23.38284","Latitude: 24.95425<br />House.Price:  34.0<br />Distance.Station:  461.10160","Latitude: 24.96322<br />House.Price:  27.7<br />Distance.Station: 2185.12800","Latitude: 24.95618<br />House.Price:  44.0<br />Distance.Station:  208.39050","Latitude: 24.97026<br />House.Price:  31.1<br />Distance.Station: 1554.25000","Latitude: 24.96581<br />House.Price:  45.4<br />Distance.Station:  184.33020","Latitude: 24.98118<br />House.Price:  44.8<br />Distance.Station:  387.77210","Latitude: 24.95120<br />House.Price:  25.6<br />Distance.Station: 1455.79800","Latitude: 24.98674<br />House.Price:  23.5<br />Distance.Station: 1978.67100","Latitude: 24.96735<br />House.Price:  34.4<br />Distance.Station:  383.28050","Latitude: 24.97509<br />House.Price:  55.3<br />Distance.Station:  718.29370","Latitude: 24.97433<br />House.Price:  56.3<br />Distance.Station:   90.45606","Latitude: 24.95425<br />House.Price:  32.9<br />Distance.Station:  461.10160","Latitude: 24.97841<br />House.Price:  51.0<br />Distance.Station:  323.69120","Latitude: 24.98203<br />House.Price:  44.5<br />Distance.Station:  289.32480","Latitude: 24.97217<br />House.Price:  37.0<br />Distance.Station:  490.34460","Latitude: 24.95744<br />House.Price:  54.4<br />Distance.Station:   56.47425","Latitude: 24.95674<br />House.Price:  24.5<br />Distance.Station:  395.67470","Latitude: 24.96735<br />House.Price:  42.5<br />Distance.Station:  383.28050","Latitude: 24.97960<br />House.Price:  38.1<br />Distance.Station:  335.52730","Latitude: 24.96299<br />House.Price:  21.8<br />Distance.Station: 2179.59000","Latitude: 24.99176<br />House.Price:  34.1<br />Distance.Station: 1144.43600","Latitude: 24.97003<br />House.Price:  28.5<br />Distance.Station:  567.03490","Latitude: 24.94155<br />House.Price:  16.7<br />Distance.Station: 4082.01500","Latitude: 24.98178<br />House.Price:  46.1<br />Distance.Station:  121.72620","Latitude: 24.96696<br />House.Price:  36.9<br />Distance.Station:  156.24420","Latitude: 24.97229<br />House.Price:  35.7<br />Distance.Station:  461.78480","Latitude: 24.95885<br />House.Price:  23.2<br />Distance.Station: 2288.01100","Latitude: 24.97161<br />House.Price:  38.4<br />Distance.Station:  439.71050","Latitude: 24.96622<br />House.Price:  29.4<br />Distance.Station: 1626.08300","Latitude: 24.98203<br />House.Price:  55.0<br />Distance.Station:  289.32480","Latitude: 24.97369<br />House.Price:  50.2<br />Distance.Station:  169.98030","Latitude: 24.95460<br />House.Price:  24.7<br />Distance.Station: 3079.89000","Latitude: 24.98203<br />House.Price:  53.0<br />Distance.Station:  289.32480","Latitude: 24.94883<br />House.Price:  19.1<br />Distance.Station: 1264.73000","Latitude: 24.95394<br />House.Price:  24.7<br />Distance.Station: 1643.49900","Latitude: 24.97425<br />House.Price:  42.2<br />Distance.Station:  537.79710","Latitude: 24.97071<br />House.Price:  78.0<br />Distance.Station:  318.52920","Latitude: 24.96674<br />House.Price:  42.8<br />Distance.Station:  104.81010","Latitude: 24.97201<br />House.Price:  41.6<br />Distance.Station:  577.96150","Latitude: 24.98320<br />House.Price:  27.3<br />Distance.Station: 1756.41100","Latitude: 24.96606<br />House.Price:  42.0<br />Distance.Station:  250.63100","Latitude: 24.97795<br />House.Price:  37.5<br />Distance.Station:  752.76690","Latitude: 24.98343<br />House.Price:  49.8<br />Distance.Station:  379.55750","Latitude: 24.95562<br />House.Price:  26.9<br />Distance.Station:  272.67830","Latitude: 24.93885<br />House.Price:  18.6<br />Distance.Station: 4197.34900","Latitude: 24.98872<br />House.Price:  37.7<br />Distance.Station:  964.74960","Latitude: 24.97388<br />House.Price:  33.1<br />Distance.Station:  187.48230","Latitude: 24.97631<br />House.Price:  42.5<br />Distance.Station:  197.13380","Latitude: 24.96412<br />House.Price:  31.3<br />Distance.Station: 1712.63200","Latitude: 24.97015<br />House.Price:  38.1<br />Distance.Station:  488.81930","Latitude: 24.95744<br />House.Price:  62.1<br />Distance.Station:   56.47425","Latitude: 24.97538<br />House.Price:  36.7<br />Distance.Station:  757.33770","Latitude: 24.97003<br />House.Price:  23.6<br />Distance.Station: 1497.71300","Latitude: 24.93885<br />House.Price:  19.2<br />Distance.Station: 4197.34900","Latitude: 24.94935<br />House.Price:  12.8<br />Distance.Station: 1156.77700","Latitude: 24.94826<br />House.Price:  15.6<br />Distance.Station: 4519.69000","Latitude: 24.97577<br />House.Price:  39.6<br />Distance.Station:  617.71340","Latitude: 24.96674<br />House.Price:  38.4<br />Distance.Station:  104.81010","Latitude: 24.99006<br />House.Price:  22.8<br />Distance.Station: 1013.34100","Latitude: 24.96431<br />House.Price:  36.5<br />Distance.Station:  337.60160","Latitude: 24.98407<br />House.Price:  35.6<br />Distance.Station: 1867.23300","Latitude: 24.96871<br />House.Price:  30.9<br />Distance.Station:  600.86040","Latitude: 24.96867<br />House.Price:  36.3<br />Distance.Station:  258.18600","Latitude: 24.98254<br />House.Price:  50.4<br />Distance.Station:  329.97470","Latitude: 24.97281<br />House.Price:  42.9<br />Distance.Station:  270.88950","Latitude: 24.97371<br />House.Price:  37.0<br />Distance.Station:  750.07040","Latitude: 24.97433<br />House.Price:  53.5<br />Distance.Station:   90.45606","Latitude: 24.98223<br />House.Price:  46.6<br />Distance.Station:  563.28540","Latitude: 24.99800<br />House.Price:  41.2<br />Distance.Station: 3085.17000","Latitude: 24.97110<br />House.Price:  37.9<br />Distance.Station:  185.42960","Latitude: 24.96412<br />House.Price:  30.8<br />Distance.Station: 1712.63200","Latitude: 24.95719<br />House.Price:  11.2<br />Distance.Station: 6488.02100","Latitude: 24.97585<br />House.Price:  53.7<br />Distance.Station:  259.66070","Latitude: 24.96674<br />House.Price:  47.0<br />Distance.Station:  104.81010","Latitude: 24.96515<br />House.Price:  42.3<br />Distance.Station:  492.23130","Latitude: 24.96324<br />House.Price:  28.6<br />Distance.Station: 2180.24500","Latitude: 24.96143<br />House.Price:  25.7<br />Distance.Station: 2674.96100","Latitude: 24.96299<br />House.Price:  31.3<br />Distance.Station: 2147.37600","Latitude: 24.95204<br />House.Price:  30.1<br />Distance.Station: 1360.13900","Latitude: 24.98085<br />House.Price:  60.7<br />Distance.Station:  383.86240","Latitude: 24.97417<br />House.Price:  45.3<br />Distance.Station:  211.44730","Latitude: 24.96853<br />House.Price:  44.9<br />Distance.Station:  338.96790","Latitude: 24.96571<br />House.Price:  45.1<br />Distance.Station:  193.58450","Latitude: 24.95505<br />House.Price:  24.7<br />Distance.Station: 2408.99300","Latitude: 24.98300<br />House.Price:  47.1<br />Distance.Station:   87.30222","Latitude: 24.97345<br />House.Price:  63.3<br />Distance.Station:  281.20500","Latitude: 24.98872<br />House.Price:  40.0<br />Distance.Station:  967.40000","Latitude: 24.98182<br />House.Price:  48.0<br />Distance.Station:  109.94550","Latitude: 24.97913<br />House.Price:  33.1<br />Distance.Station:  614.13940","Latitude: 24.96182<br />House.Price:  29.5<br />Distance.Station: 2261.43200","Latitude: 24.95153<br />House.Price:  24.8<br />Distance.Station: 1801.54400","Latitude: 24.96464<br />House.Price:  20.9<br />Distance.Station: 1828.31900","Latitude: 24.97544<br />House.Price:  43.1<br />Distance.Station:  350.85150","Latitude: 24.96322<br />House.Price:  22.8<br />Distance.Station: 2185.12800","Latitude: 24.98203<br />House.Price:  42.1<br />Distance.Station:  289.32480","Latitude: 24.95591<br />House.Price:  51.7<br />Distance.Station:  312.89630","Latitude: 24.96628<br />House.Price:  41.5<br />Distance.Station:  157.60520","Latitude: 24.97480<br />House.Price:  52.2<br />Distance.Station:  274.01440","Latitude: 24.97937<br />House.Price:  49.5<br />Distance.Station:  390.56840","Latitude: 24.96165<br />House.Price:  23.8<br />Distance.Station: 1157.98800","Latitude: 24.96447<br />House.Price:  30.5<br />Distance.Station: 1717.19300","Latitude: 24.95836<br />House.Price:  56.8<br />Distance.Station:   49.66105","Latitude: 24.97077<br />House.Price:  37.4<br />Distance.Station:  587.88770","Latitude: 24.97744<br />House.Price:  69.7<br />Distance.Station:  292.99780","Latitude: 24.98203<br />House.Price:  53.3<br />Distance.Station:  289.32480","Latitude: 24.98298<br />House.Price:  47.3<br />Distance.Station:  132.54690","Latitude: 24.93207<br />House.Price:  29.3<br />Distance.Station: 3529.56400","Latitude: 24.97845<br />House.Price:  40.3<br />Distance.Station:  506.11440","Latitude: 24.94297<br />House.Price:  12.9<br />Distance.Station: 4066.58700","Latitude: 24.98300<br />House.Price:  46.6<br />Distance.Station:   82.88643","Latitude: 24.97110<br />House.Price:  55.3<br />Distance.Station:  185.42960","Latitude: 24.96042<br />House.Price:  25.6<br />Distance.Station: 2103.55500","Latitude: 24.95957<br />House.Price:  27.3<br />Distance.Station: 2251.93800","Latitude: 24.96756<br />House.Price:  67.7<br />Distance.Station:  122.36190","Latitude: 24.97151<br />House.Price:  38.6<br />Distance.Station:  377.83020","Latitude: 24.95155<br />House.Price:  31.3<br />Distance.Station: 1939.74900","Latitude: 24.97927<br />House.Price:  35.3<br />Distance.Station:  443.80200","Latitude: 24.98872<br />House.Price:  40.3<br />Distance.Station:  967.40000","Latitude: 24.95544<br />House.Price:  24.7<br />Distance.Station: 4136.27100","Latitude: 24.97400<br />House.Price:  42.5<br />Distance.Station:  512.54870","Latitude: 24.97198<br />House.Price:  31.9<br />Distance.Station:  918.63570","Latitude: 24.99156<br />House.Price:  32.2<br />Distance.Station: 1164.83800","Latitude: 24.96447<br />House.Price:  23.0<br />Distance.Station: 1717.19300","Latitude: 24.97371<br />House.Price:  37.3<br />Distance.Station:  170.12890","Latitude: 24.97433<br />House.Price:  35.5<br />Distance.Station:  482.75810","Latitude: 24.96305<br />House.Price:  27.7<br />Distance.Station: 2175.03000","Latitude: 24.97388<br />House.Price:  28.5<br />Distance.Station:  187.48230","Latitude: 24.98353<br />House.Price:  39.7<br />Distance.Station:  161.94200","Latitude: 24.98203<br />House.Price:  41.2<br />Distance.Station:  289.32480","Latitude: 24.95663<br />House.Price:  37.2<br />Distance.Station:  130.99450","Latitude: 24.97293<br />House.Price:  40.5<br />Distance.Station:  372.13860","Latitude: 24.95505<br />House.Price:  22.3<br />Distance.Station: 2408.99300","Latitude: 24.96330<br />House.Price:  28.1<br />Distance.Station: 2175.74400","Latitude: 24.94155<br />House.Price:  15.4<br />Distance.Station: 4082.01500","Latitude: 24.97433<br />House.Price:  50.0<br />Distance.Station:   90.45606","Latitude: 24.97923<br />House.Price:  40.6<br />Distance.Station:  390.96960","Latitude: 24.96674<br />House.Price:  52.5<br />Distance.Station:  104.81010","Latitude: 24.97433<br />House.Price:  63.9<br />Distance.Station:   90.45606"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(31,0,253,1)","rgba(70,0,244,1)","rgba(96,0,235,1)","rgba(96,0,235,1)","rgba(80,0,241,1)","rgba(173,0,175,1)","rgba(101,0,232,1)","rgba(68,0,245,1)","rgba(242,0,56,1)","rgba(160,0,189,1)","rgba(81,0,240,1)","rgba(33,0,252,1)","rgba(90,0,237,1)","rgba(182,0,164,1)","rgba(133,0,212,1)","rgba(97,0,234,1)","rgba(69,0,245,1)","rgba(76,0,243,1)","rgba(78,0,242,1)","rgba(0,0,255,1)","rgba(176,0,171,1)","rgba(67,0,245,1)","rgba(143,0,205,1)","rgba(67,0,245,1)","rgba(89,0,238,1)","rgba(148,0,200,1)","rgba(79,0,241,1)","rgba(67,0,245,1)","rgba(95,0,235,1)","rgba(86,0,239,1)","rgba(226,0,92,1)","rgba(111,0,227,1)","rgba(89,0,237,1)","rgba(73,0,244,1)","rgba(56,0,248,1)","rgba(218,0,108,1)","rgba(165,0,184,1)","rgba(143,0,205,1)","rgba(97,0,234,1)","rgba(68,0,245,1)","rgba(218,0,107,1)","rgba(218,0,108,1)","rgba(92,0,236,1)","rgba(92,0,236,1)","rgba(93,0,236,1)","rgba(89,0,237,1)","rgba(87,0,238,1)","rgba(102,0,232,1)","rgba(228,0,89,1)","rgba(226,0,92,1)","rgba(91,0,236,1)","rgba(159,0,190,1)","rgba(146,0,202,1)","rgba(90,0,237,1)","rgba(68,0,245,1)","rgba(133,0,212,1)","rgba(78,0,242,1)","rgba(21,0,254,1)","rgba(226,0,92,1)","rgba(74,0,243,1)","rgba(165,0,184,1)","rgba(64,0,246,1)","rgba(173,0,175,1)","rgba(93,0,236,1)","rgba(125,0,218,1)","rgba(41,0,251,1)","rgba(55,0,249,1)","rgba(37,0,252,1)","rgba(87,0,238,1)","rgba(96,0,235,1)","rgba(33,0,252,1)","rgba(102,0,232,1)","rgba(83,0,240,1)","rgba(218,0,107,1)","rgba(79,0,241,1)","rgba(143,0,205,1)","rgba(100,0,233,1)","rgba(173,0,175,1)","rgba(95,0,235,1)","rgba(145,0,203,1)","rgba(93,0,236,1)","rgba(79,0,242,1)","rgba(47,0,250,1)","rgba(188,0,156,1)","rgba(79,0,241,1)","rgba(74,0,243,1)","rgba(147,0,201,1)","rgba(218,0,108,1)","rgba(145,0,203,1)","rgba(216,0,112,1)","rgba(66,0,245,1)","rgba(145,0,203,1)","rgba(182,0,164,1)","rgba(133,0,213,1)","rgba(50,0,250,1)","rgba(37,0,252,1)","rgba(33,0,252,1)","rgba(100,0,232,1)","rgba(68,0,245,1)","rgba(33,0,252,1)","rgba(123,0,219,1)","rgba(50,0,249,1)","rgba(55,0,249,1)","rgba(57,0,248,1)","rgba(80,0,241,1)","rgba(69,0,245,1)","rgba(54,0,249,1)","rgba(143,0,205,1)","rgba(98,0,233,1)","rgba(172,0,176,1)","rgba(37,0,252,1)","rgba(55,0,248,1)","rgba(171,0,178,1)","rgba(80,0,241,1)","rgba(45,0,250,1)","rgba(109,0,228,1)","rgba(254,0,9,1)","rgba(220,0,103,1)","rgba(152,0,197,1)","rgba(68,0,245,1)","rgba(90,0,237,1)","rgba(90,0,237,1)","rgba(82,0,240,1)","rgba(53,0,249,1)","rgba(67,0,245,1)","rgba(55,0,249,1)","rgba(113,0,225,1)","rgba(79,0,241,1)","rgba(41,0,251,1)","rgba(58,0,248,1)","rgba(93,0,236,1)","rgba(172,0,176,1)","rgba(89,0,238,1)","rgba(78,0,242,1)","rgba(53,0,249,1)","rgba(125,0,218,1)","rgba(80,0,241,1)","rgba(72,0,244,1)","rgba(122,0,220,1)","rgba(90,0,237,1)","rgba(68,0,245,1)","rgba(151,0,197,1)","rgba(102,0,232,1)","rgba(90,0,237,1)","rgba(143,0,205,1)","rgba(86,0,239,1)","rgba(53,0,249,1)","rgba(89,0,237,1)","rgba(213,0,118,1)","rgba(52,0,249,1)","rgba(51,0,249,1)","rgba(80,0,241,1)","rgba(143,0,205,1)","rgba(78,0,242,1)","rgba(218,0,108,1)","rgba(218,0,107,1)","rgba(138,0,208,1)","rgba(114,0,225,1)","rgba(80,0,241,1)","rgba(114,0,225,1)","rgba(18,0,254,1)","rgba(100,0,233,1)","rgba(218,0,108,1)","rgba(37,0,252,1)","rgba(53,0,249,1)","rgba(137,0,209,1)","rgba(69,0,245,1)","rgba(73,0,243,1)","rgba(92,0,236,1)","rgba(166,0,183,1)","rgba(226,0,92,1)","rgba(79,0,241,1)","rgba(33,0,252,1)","rgba(81,0,241,1)","rgba(84,0,239,1)","rgba(88,0,238,1)","rgba(227,0,90,1)","rgba(52,0,249,1)","rgba(132,0,213,1)","rgba(85,0,239,1)","rgba(225,0,95,1)","rgba(56,0,248,1)","rgba(172,0,176,1)","rgba(218,0,107,1)","rgba(186,0,159,1)","rgba(146,0,202,1)","rgba(173,0,175,1)","rgba(197,0,143,1)","rgba(54,0,249,1)","rgba(218,0,108,1)","rgba(100,0,233,1)","rgba(110,0,228,1)","rgba(21,0,254,1)","rgba(83,0,240,1)","rgba(212,0,118,1)","rgba(87,0,238,1)","rgba(107,0,229,1)","rgba(42,0,251,1)","rgba(48,0,250,1)","rgba(86,0,239,1)","rgba(125,0,218,1)","rgba(96,0,235,1)","rgba(102,0,232,1)","rgba(68,0,245,1)","rgba(145,0,203,1)","rgba(147,0,202,1)","rgba(79,0,241,1)","rgba(104,0,231,1)","rgba(143,0,205,1)","rgba(51,0,249,1)","rgba(80,0,241,1)","rgba(66,0,245,1)","rgba(161,0,188,1)","rgba(33,0,252,1)","rgba(160,0,189,1)","rgba(79,0,241,1)","rgba(98,0,233,1)","rgba(78,0,242,1)","rgba(90,0,237,1)","rgba(93,0,236,1)","rgba(53,0,249,1)","rgba(145,0,203,1)","rgba(84,0,240,1)","rgba(145,0,203,1)","rgba(73,0,244,1)","rgba(55,0,249,1)","rgba(218,0,107,1)","rgba(65,0,246,1)","rgba(200,0,139,1)","rgba(133,0,212,1)","rgba(172,0,176,1)","rgba(218,0,108,1)","rgba(224,0,96,1)","rgba(74,0,243,1)","rgba(174,0,174,1)","rgba(63,0,246,1)","rgba(78,0,242,1)","rgba(108,0,228,1)","rgba(108,0,228,1)","rgba(115,0,224,1)","rgba(157,0,192,1)","rgba(63,0,246,1)","rgba(170,0,179,1)","rgba(56,0,248,1)","rgba(151,0,197,1)","rgba(102,0,232,1)","rgba(80,0,241,1)","rgba(128,0,216,1)","rgba(125,0,218,1)","rgba(253,0,17,1)","rgba(83,0,240,1)","rgba(133,0,212,1)","rgba(33,0,252,1)","rgba(158,0,191,1)","rgba(73,0,243,1)","rgba(242,0,56,1)","rgba(74,0,243,1)","rgba(85,0,239,1)","rgba(69,0,245,1)","rgba(115,0,224,1)","rgba(148,0,200,1)","rgba(176,0,171,1)","rgba(68,0,245,1)","rgba(172,0,176,1)","rgba(90,0,237,1)","rgba(114,0,225,1)","rgba(160,0,189,1)","rgba(89,0,238,1)","rgba(80,0,241,1)","rgba(115,0,224,1)","rgba(63,0,246,1)","rgba(86,0,239,1)","rgba(90,0,237,1)","rgba(50,0,249,1)","rgba(80,0,241,1)","rgba(0,0,255,1)","rgba(87,0,238,1)","rgba(173,0,175,1)","rgba(57,0,248,1)","rgba(151,0,198,1)","rgba(53,0,249,1)","rgba(80,0,241,1)","rgba(147,0,201,1)","rgba(167,0,182,1)","rgba(79,0,241,1)","rgba(107,0,229,1)","rgba(33,0,252,1)","rgba(87,0,238,1)","rgba(73,0,244,1)","rgba(68,0,245,1)","rgba(90,0,237,1)","rgba(21,0,254,1)","rgba(80,0,241,1)","rgba(79,0,241,1)","rgba(74,0,243,1)","rgba(173,0,175,1)","rgba(132,0,213,1)","rgba(96,0,234,1)","rgba(218,0,107,1)","rgba(41,0,251,1)","rgba(48,0,250,1)","rgba(87,0,238,1)","rgba(176,0,171,1)","rgba(85,0,239,1)","rgba(154,0,195,1)","rgba(68,0,245,1)","rgba(50,0,249,1)","rgba(197,0,143,1)","rgba(68,0,245,1)","rgba(138,0,208,1)","rgba(154,0,194,1)","rgba(94,0,235,1)","rgba(72,0,244,1)","rgba(37,0,252,1)","rgba(97,0,234,1)","rgba(159,0,190,1)","rgba(63,0,246,1)","rgba(110,0,227,1)","rgba(79,0,241,1)","rgba(66,0,246,1)","rgba(220,0,103,1)","rgba(123,0,219,1)","rgba(54,0,249,1)","rgba(55,0,248,1)","rgba(157,0,192,1)","rgba(89,0,237,1)","rgba(21,0,254,1)","rgba(110,0,227,1)","rgba(149,0,200,1)","rgba(220,0,103,1)","rgba(133,0,212,1)","rgba(226,0,92,1)","rgba(100,0,232,1)","rgba(37,0,252,1)","rgba(126,0,218,1)","rgba(74,0,243,1)","rgba(163,0,186,1)","rgba(99,0,233,1)","rgba(64,0,246,1)","rgba(73,0,243,1)","rgba(66,0,246,1)","rgba(110,0,228,1)","rgba(33,0,252,1)","rgba(96,0,235,1)","rgba(198,0,143,1)","rgba(53,0,249,1)","rgba(157,0,192,1)","rgba(255,0,0,1)","rgba(64,0,246,1)","rgba(37,0,252,1)","rgba(90,0,237,1)","rgba(173,0,175,1)","rgba(187,0,157,1)","rgba(172,0,176,1)","rgba(143,0,205,1)","rgba(79,0,241,1)","rgba(57,0,248,1)","rgba(74,0,243,1)","rgba(55,0,249,1)","rgba(180,0,167,1)","rgba(32,0,253,1)","rgba(67,0,245,1)","rgba(123,0,219,1)","rgba(38,0,252,1)","rgba(100,0,233,1)","rgba(176,0,172,1)","rgba(160,0,189,1)","rgba(161,0,188,1)","rgba(76,0,243,1)","rgba(173,0,175,1)","rgba(68,0,245,1)","rgba(71,0,244,1)","rgba(48,0,250,1)","rgba(66,0,245,1)","rgba(80,0,241,1)","rgba(133,0,212,1)","rgba(157,0,192,1)","rgba(18,0,254,1)","rgba(98,0,234,1)","rgba(69,0,245,1)","rgba(68,0,245,1)","rgba(43,0,251,1)","rgba(207,0,127,1)","rgba(91,0,237,1)","rgba(218,0,108,1)","rgba(30,0,253,1)","rgba(53,0,249,1)","rgba(171,0,178,1)","rgba(175,0,172,1)","rgba(41,0,251,1)","rgba(79,0,242,1)","rgba(165,0,184,1)","rgba(85,0,239,1)","rgba(123,0,219,1)","rgba(219,0,106,1)","rgba(91,0,236,1)","rgba(120,0,221,1)","rgba(133,0,212,1)","rgba(157,0,192,1)","rgba(50,0,249,1)","rgba(89,0,238,1)","rgba(173,0,175,1)","rgba(54,0,249,1)","rgba(49,0,250,1)","rgba(68,0,245,1)","rgba(43,0,251,1)","rgba(78,0,242,1)","rgba(180,0,167,1)","rgba(173,0,175,1)","rgba(218,0,107,1)","rgba(33,0,252,1)","rgba(80,0,241,1)","rgba(37,0,252,1)","rgba(33,0,252,1)"],"opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":["rgba(31,0,253,1)","rgba(70,0,244,1)","rgba(96,0,235,1)","rgba(96,0,235,1)","rgba(80,0,241,1)","rgba(173,0,175,1)","rgba(101,0,232,1)","rgba(68,0,245,1)","rgba(242,0,56,1)","rgba(160,0,189,1)","rgba(81,0,240,1)","rgba(33,0,252,1)","rgba(90,0,237,1)","rgba(182,0,164,1)","rgba(133,0,212,1)","rgba(97,0,234,1)","rgba(69,0,245,1)","rgba(76,0,243,1)","rgba(78,0,242,1)","rgba(0,0,255,1)","rgba(176,0,171,1)","rgba(67,0,245,1)","rgba(143,0,205,1)","rgba(67,0,245,1)","rgba(89,0,238,1)","rgba(148,0,200,1)","rgba(79,0,241,1)","rgba(67,0,245,1)","rgba(95,0,235,1)","rgba(86,0,239,1)","rgba(226,0,92,1)","rgba(111,0,227,1)","rgba(89,0,237,1)","rgba(73,0,244,1)","rgba(56,0,248,1)","rgba(218,0,108,1)","rgba(165,0,184,1)","rgba(143,0,205,1)","rgba(97,0,234,1)","rgba(68,0,245,1)","rgba(218,0,107,1)","rgba(218,0,108,1)","rgba(92,0,236,1)","rgba(92,0,236,1)","rgba(93,0,236,1)","rgba(89,0,237,1)","rgba(87,0,238,1)","rgba(102,0,232,1)","rgba(228,0,89,1)","rgba(226,0,92,1)","rgba(91,0,236,1)","rgba(159,0,190,1)","rgba(146,0,202,1)","rgba(90,0,237,1)","rgba(68,0,245,1)","rgba(133,0,212,1)","rgba(78,0,242,1)","rgba(21,0,254,1)","rgba(226,0,92,1)","rgba(74,0,243,1)","rgba(165,0,184,1)","rgba(64,0,246,1)","rgba(173,0,175,1)","rgba(93,0,236,1)","rgba(125,0,218,1)","rgba(41,0,251,1)","rgba(55,0,249,1)","rgba(37,0,252,1)","rgba(87,0,238,1)","rgba(96,0,235,1)","rgba(33,0,252,1)","rgba(102,0,232,1)","rgba(83,0,240,1)","rgba(218,0,107,1)","rgba(79,0,241,1)","rgba(143,0,205,1)","rgba(100,0,233,1)","rgba(173,0,175,1)","rgba(95,0,235,1)","rgba(145,0,203,1)","rgba(93,0,236,1)","rgba(79,0,242,1)","rgba(47,0,250,1)","rgba(188,0,156,1)","rgba(79,0,241,1)","rgba(74,0,243,1)","rgba(147,0,201,1)","rgba(218,0,108,1)","rgba(145,0,203,1)","rgba(216,0,112,1)","rgba(66,0,245,1)","rgba(145,0,203,1)","rgba(182,0,164,1)","rgba(133,0,213,1)","rgba(50,0,250,1)","rgba(37,0,252,1)","rgba(33,0,252,1)","rgba(100,0,232,1)","rgba(68,0,245,1)","rgba(33,0,252,1)","rgba(123,0,219,1)","rgba(50,0,249,1)","rgba(55,0,249,1)","rgba(57,0,248,1)","rgba(80,0,241,1)","rgba(69,0,245,1)","rgba(54,0,249,1)","rgba(143,0,205,1)","rgba(98,0,233,1)","rgba(172,0,176,1)","rgba(37,0,252,1)","rgba(55,0,248,1)","rgba(171,0,178,1)","rgba(80,0,241,1)","rgba(45,0,250,1)","rgba(109,0,228,1)","rgba(254,0,9,1)","rgba(220,0,103,1)","rgba(152,0,197,1)","rgba(68,0,245,1)","rgba(90,0,237,1)","rgba(90,0,237,1)","rgba(82,0,240,1)","rgba(53,0,249,1)","rgba(67,0,245,1)","rgba(55,0,249,1)","rgba(113,0,225,1)","rgba(79,0,241,1)","rgba(41,0,251,1)","rgba(58,0,248,1)","rgba(93,0,236,1)","rgba(172,0,176,1)","rgba(89,0,238,1)","rgba(78,0,242,1)","rgba(53,0,249,1)","rgba(125,0,218,1)","rgba(80,0,241,1)","rgba(72,0,244,1)","rgba(122,0,220,1)","rgba(90,0,237,1)","rgba(68,0,245,1)","rgba(151,0,197,1)","rgba(102,0,232,1)","rgba(90,0,237,1)","rgba(143,0,205,1)","rgba(86,0,239,1)","rgba(53,0,249,1)","rgba(89,0,237,1)","rgba(213,0,118,1)","rgba(52,0,249,1)","rgba(51,0,249,1)","rgba(80,0,241,1)","rgba(143,0,205,1)","rgba(78,0,242,1)","rgba(218,0,108,1)","rgba(218,0,107,1)","rgba(138,0,208,1)","rgba(114,0,225,1)","rgba(80,0,241,1)","rgba(114,0,225,1)","rgba(18,0,254,1)","rgba(100,0,233,1)","rgba(218,0,108,1)","rgba(37,0,252,1)","rgba(53,0,249,1)","rgba(137,0,209,1)","rgba(69,0,245,1)","rgba(73,0,243,1)","rgba(92,0,236,1)","rgba(166,0,183,1)","rgba(226,0,92,1)","rgba(79,0,241,1)","rgba(33,0,252,1)","rgba(81,0,241,1)","rgba(84,0,239,1)","rgba(88,0,238,1)","rgba(227,0,90,1)","rgba(52,0,249,1)","rgba(132,0,213,1)","rgba(85,0,239,1)","rgba(225,0,95,1)","rgba(56,0,248,1)","rgba(172,0,176,1)","rgba(218,0,107,1)","rgba(186,0,159,1)","rgba(146,0,202,1)","rgba(173,0,175,1)","rgba(197,0,143,1)","rgba(54,0,249,1)","rgba(218,0,108,1)","rgba(100,0,233,1)","rgba(110,0,228,1)","rgba(21,0,254,1)","rgba(83,0,240,1)","rgba(212,0,118,1)","rgba(87,0,238,1)","rgba(107,0,229,1)","rgba(42,0,251,1)","rgba(48,0,250,1)","rgba(86,0,239,1)","rgba(125,0,218,1)","rgba(96,0,235,1)","rgba(102,0,232,1)","rgba(68,0,245,1)","rgba(145,0,203,1)","rgba(147,0,202,1)","rgba(79,0,241,1)","rgba(104,0,231,1)","rgba(143,0,205,1)","rgba(51,0,249,1)","rgba(80,0,241,1)","rgba(66,0,245,1)","rgba(161,0,188,1)","rgba(33,0,252,1)","rgba(160,0,189,1)","rgba(79,0,241,1)","rgba(98,0,233,1)","rgba(78,0,242,1)","rgba(90,0,237,1)","rgba(93,0,236,1)","rgba(53,0,249,1)","rgba(145,0,203,1)","rgba(84,0,240,1)","rgba(145,0,203,1)","rgba(73,0,244,1)","rgba(55,0,249,1)","rgba(218,0,107,1)","rgba(65,0,246,1)","rgba(200,0,139,1)","rgba(133,0,212,1)","rgba(172,0,176,1)","rgba(218,0,108,1)","rgba(224,0,96,1)","rgba(74,0,243,1)","rgba(174,0,174,1)","rgba(63,0,246,1)","rgba(78,0,242,1)","rgba(108,0,228,1)","rgba(108,0,228,1)","rgba(115,0,224,1)","rgba(157,0,192,1)","rgba(63,0,246,1)","rgba(170,0,179,1)","rgba(56,0,248,1)","rgba(151,0,197,1)","rgba(102,0,232,1)","rgba(80,0,241,1)","rgba(128,0,216,1)","rgba(125,0,218,1)","rgba(253,0,17,1)","rgba(83,0,240,1)","rgba(133,0,212,1)","rgba(33,0,252,1)","rgba(158,0,191,1)","rgba(73,0,243,1)","rgba(242,0,56,1)","rgba(74,0,243,1)","rgba(85,0,239,1)","rgba(69,0,245,1)","rgba(115,0,224,1)","rgba(148,0,200,1)","rgba(176,0,171,1)","rgba(68,0,245,1)","rgba(172,0,176,1)","rgba(90,0,237,1)","rgba(114,0,225,1)","rgba(160,0,189,1)","rgba(89,0,238,1)","rgba(80,0,241,1)","rgba(115,0,224,1)","rgba(63,0,246,1)","rgba(86,0,239,1)","rgba(90,0,237,1)","rgba(50,0,249,1)","rgba(80,0,241,1)","rgba(0,0,255,1)","rgba(87,0,238,1)","rgba(173,0,175,1)","rgba(57,0,248,1)","rgba(151,0,198,1)","rgba(53,0,249,1)","rgba(80,0,241,1)","rgba(147,0,201,1)","rgba(167,0,182,1)","rgba(79,0,241,1)","rgba(107,0,229,1)","rgba(33,0,252,1)","rgba(87,0,238,1)","rgba(73,0,244,1)","rgba(68,0,245,1)","rgba(90,0,237,1)","rgba(21,0,254,1)","rgba(80,0,241,1)","rgba(79,0,241,1)","rgba(74,0,243,1)","rgba(173,0,175,1)","rgba(132,0,213,1)","rgba(96,0,234,1)","rgba(218,0,107,1)","rgba(41,0,251,1)","rgba(48,0,250,1)","rgba(87,0,238,1)","rgba(176,0,171,1)","rgba(85,0,239,1)","rgba(154,0,195,1)","rgba(68,0,245,1)","rgba(50,0,249,1)","rgba(197,0,143,1)","rgba(68,0,245,1)","rgba(138,0,208,1)","rgba(154,0,194,1)","rgba(94,0,235,1)","rgba(72,0,244,1)","rgba(37,0,252,1)","rgba(97,0,234,1)","rgba(159,0,190,1)","rgba(63,0,246,1)","rgba(110,0,227,1)","rgba(79,0,241,1)","rgba(66,0,246,1)","rgba(220,0,103,1)","rgba(123,0,219,1)","rgba(54,0,249,1)","rgba(55,0,248,1)","rgba(157,0,192,1)","rgba(89,0,237,1)","rgba(21,0,254,1)","rgba(110,0,227,1)","rgba(149,0,200,1)","rgba(220,0,103,1)","rgba(133,0,212,1)","rgba(226,0,92,1)","rgba(100,0,232,1)","rgba(37,0,252,1)","rgba(126,0,218,1)","rgba(74,0,243,1)","rgba(163,0,186,1)","rgba(99,0,233,1)","rgba(64,0,246,1)","rgba(73,0,243,1)","rgba(66,0,246,1)","rgba(110,0,228,1)","rgba(33,0,252,1)","rgba(96,0,235,1)","rgba(198,0,143,1)","rgba(53,0,249,1)","rgba(157,0,192,1)","rgba(255,0,0,1)","rgba(64,0,246,1)","rgba(37,0,252,1)","rgba(90,0,237,1)","rgba(173,0,175,1)","rgba(187,0,157,1)","rgba(172,0,176,1)","rgba(143,0,205,1)","rgba(79,0,241,1)","rgba(57,0,248,1)","rgba(74,0,243,1)","rgba(55,0,249,1)","rgba(180,0,167,1)","rgba(32,0,253,1)","rgba(67,0,245,1)","rgba(123,0,219,1)","rgba(38,0,252,1)","rgba(100,0,233,1)","rgba(176,0,172,1)","rgba(160,0,189,1)","rgba(161,0,188,1)","rgba(76,0,243,1)","rgba(173,0,175,1)","rgba(68,0,245,1)","rgba(71,0,244,1)","rgba(48,0,250,1)","rgba(66,0,245,1)","rgba(80,0,241,1)","rgba(133,0,212,1)","rgba(157,0,192,1)","rgba(18,0,254,1)","rgba(98,0,234,1)","rgba(69,0,245,1)","rgba(68,0,245,1)","rgba(43,0,251,1)","rgba(207,0,127,1)","rgba(91,0,237,1)","rgba(218,0,108,1)","rgba(30,0,253,1)","rgba(53,0,249,1)","rgba(171,0,178,1)","rgba(175,0,172,1)","rgba(41,0,251,1)","rgba(79,0,242,1)","rgba(165,0,184,1)","rgba(85,0,239,1)","rgba(123,0,219,1)","rgba(219,0,106,1)","rgba(91,0,236,1)","rgba(120,0,221,1)","rgba(133,0,212,1)","rgba(157,0,192,1)","rgba(50,0,249,1)","rgba(89,0,238,1)","rgba(173,0,175,1)","rgba(54,0,249,1)","rgba(49,0,250,1)","rgba(68,0,245,1)","rgba(43,0,251,1)","rgba(78,0,242,1)","rgba(180,0,167,1)","rgba(173,0,175,1)","rgba(218,0,107,1)","rgba(33,0,252,1)","rgba(80,0,241,1)","rgba(37,0,252,1)","rgba(33,0,252,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[24.95],"y":[30],"name":"99_65989d36ef3521cb309e1b3becc31782","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#0000FF"],[0.00334448160535117,"#0F00FE"],[0.00668896321070234,"#1900FD"],[0.0100334448160535,"#2000FD"],[0.0133779264214047,"#2600FC"],[0.0167224080267559,"#2B00FB"],[0.020066889632107,"#2F00FA"],[0.0234113712374582,"#3300F9"],[0.0267558528428094,"#3700F8"],[0.0301003344481605,"#3A00F8"],[0.0334448160535117,"#3E00F7"],[0.0367892976588629,"#4100F6"],[0.040133779264214,"#4400F5"],[0.0434782608695652,"#4600F4"],[0.0468227424749164,"#4900F3"],[0.0501672240802676,"#4B00F3"],[0.0535117056856187,"#4E00F2"],[0.0568561872909699,"#5000F1"],[0.0602006688963211,"#5200F0"],[0.0635451505016722,"#5400EF"],[0.0668896321070234,"#5600EF"],[0.0702341137123746,"#5800EE"],[0.0735785953177257,"#5A00ED"],[0.0769230769230769,"#5C00EC"],[0.0802675585284281,"#5E00EB"],[0.0836120401337793,"#6000EB"],[0.0869565217391304,"#6200EA"],[0.0903010033444816,"#6300E9"],[0.0936454849498328,"#6500E8"],[0.096989966555184,"#6700E7"],[0.100334448160535,"#6800E6"],[0.103678929765886,"#6A00E6"],[0.107023411371237,"#6B00E5"],[0.110367892976589,"#6D00E4"],[0.11371237458194,"#6E00E3"],[0.117056856187291,"#7000E2"],[0.120401337792642,"#7100E2"],[0.123745819397993,"#7200E1"],[0.127090301003344,"#7400E0"],[0.130434782608696,"#7500DF"],[0.133779264214047,"#7600DE"],[0.137123745819398,"#7800DE"],[0.140468227424749,"#7900DD"],[0.1438127090301,"#7A00DC"],[0.147157190635451,"#7B00DB"],[0.150501672240803,"#7D00DA"],[0.153846153846154,"#7E00DA"],[0.157190635451505,"#7F00D9"],[0.160535117056856,"#8000D8"],[0.163879598662207,"#8100D7"],[0.167224080267559,"#8200D6"],[0.17056856187291,"#8400D5"],[0.173913043478261,"#8500D5"],[0.177257525083612,"#8600D4"],[0.180602006688963,"#8700D3"],[0.183946488294314,"#8800D2"],[0.187290969899666,"#8900D1"],[0.190635451505017,"#8A00D1"],[0.193979933110368,"#8B00D0"],[0.197324414715719,"#8C00CF"],[0.20066889632107,"#8D00CE"],[0.204013377926421,"#8E00CD"],[0.207357859531773,"#8F00CD"],[0.210702341137124,"#9000CC"],[0.214046822742475,"#9100CB"],[0.217391304347826,"#9200CA"],[0.220735785953177,"#9300CA"],[0.224080267558528,"#9400C9"],[0.22742474916388,"#9400C8"],[0.230769230769231,"#9500C7"],[0.234113712374582,"#9600C6"],[0.237458193979933,"#9700C6"],[0.240802675585284,"#9800C5"],[0.244147157190635,"#9900C4"],[0.247491638795987,"#9A00C3"],[0.250836120401338,"#9B00C2"],[0.254180602006689,"#9B00C2"],[0.25752508361204,"#9C00C1"],[0.260869565217391,"#9D00C0"],[0.264214046822742,"#9E00BF"],[0.267558528428094,"#9F00BE"],[0.270903010033445,"#9F00BE"],[0.274247491638796,"#A000BD"],[0.277591973244147,"#A100BC"],[0.280936454849498,"#A200BB"],[0.284280936454849,"#A300BA"],[0.287625418060201,"#A300BA"],[0.290969899665552,"#A400B9"],[0.294314381270903,"#A500B8"],[0.297658862876254,"#A600B7"],[0.301003344481605,"#A600B7"],[0.304347826086957,"#A700B6"],[0.307692307692308,"#A800B5"],[0.311036789297659,"#A800B4"],[0.31438127090301,"#A900B3"],[0.317725752508361,"#AA00B3"],[0.321070234113712,"#AB00B2"],[0.324414715719063,"#AB00B1"],[0.327759197324415,"#AC00B0"],[0.331103678929766,"#AD00AF"],[0.334448160535117,"#AD00AF"],[0.337792642140468,"#AE00AE"],[0.341137123745819,"#AF00AD"],[0.344481605351171,"#AF00AC"],[0.347826086956522,"#B000AC"],[0.351170568561873,"#B100AB"],[0.354515050167224,"#B100AA"],[0.357859531772575,"#B200A9"],[0.361204013377926,"#B300A8"],[0.364548494983278,"#B300A8"],[0.367892976588629,"#B400A7"],[0.37123745819398,"#B400A6"],[0.374581939799331,"#B500A5"],[0.377926421404682,"#B600A5"],[0.381270903010033,"#B600A4"],[0.384615384615385,"#B700A3"],[0.387959866220736,"#B700A2"],[0.391304347826087,"#B800A1"],[0.394648829431438,"#B900A1"],[0.397993311036789,"#B900A0"],[0.40133779264214,"#BA009F"],[0.404682274247492,"#BA009E"],[0.408026755852843,"#BB009E"],[0.411371237458194,"#BC009D"],[0.414715719063545,"#BC009C"],[0.418060200668896,"#BD009B"],[0.421404682274247,"#BD009B"],[0.424749163879599,"#BE009A"],[0.42809364548495,"#BE0099"],[0.431438127090301,"#BF0098"],[0.434782608695652,"#BF0097"],[0.438127090301003,"#C00097"],[0.441471571906355,"#C10096"],[0.444816053511706,"#C10095"],[0.448160535117057,"#C20094"],[0.451505016722408,"#C20094"],[0.454849498327759,"#C30093"],[0.45819397993311,"#C30092"],[0.461538461538462,"#C40091"],[0.464882943143813,"#C40091"],[0.468227424749164,"#C50090"],[0.471571906354515,"#C5008F"],[0.474916387959866,"#C6008E"],[0.478260869565217,"#C6008D"],[0.481605351170569,"#C7008D"],[0.48494983277592,"#C7008C"],[0.488294314381271,"#C8008B"],[0.491638795986622,"#C8008A"],[0.494983277591973,"#C9008A"],[0.498327759197324,"#C90089"],[0.501672240802676,"#CA0088"],[0.505016722408027,"#CA0087"],[0.508361204013378,"#CB0087"],[0.511705685618729,"#CB0086"],[0.51505016722408,"#CC0085"],[0.518394648829431,"#CC0084"],[0.521739130434783,"#CD0084"],[0.525083612040134,"#CD0083"],[0.528428093645485,"#CE0082"],[0.531772575250836,"#CE0081"],[0.535117056856187,"#CE0080"],[0.538461538461538,"#CF0080"],[0.54180602006689,"#CF007F"],[0.545150501672241,"#D0007E"],[0.548494983277592,"#D0007D"],[0.551839464882943,"#D1007D"],[0.555183946488294,"#D1007C"],[0.558528428093645,"#D2007B"],[0.561872909698997,"#D2007A"],[0.565217391304348,"#D3007A"],[0.568561872909699,"#D30079"],[0.57190635451505,"#D30078"],[0.575250836120401,"#D40077"],[0.578595317725752,"#D40077"],[0.581939799331104,"#D50076"],[0.585284280936455,"#D50075"],[0.588628762541806,"#D60074"],[0.591973244147157,"#D60074"],[0.595317725752508,"#D60073"],[0.598662207357859,"#D70072"],[0.602006688963211,"#D70071"],[0.605351170568562,"#D80071"],[0.608695652173913,"#D80070"],[0.612040133779264,"#D8006F"],[0.615384615384615,"#D9006E"],[0.618729096989967,"#D9006E"],[0.622073578595318,"#DA006D"],[0.625418060200669,"#DA006C"],[0.62876254180602,"#DA006B"],[0.632107023411371,"#DB006A"],[0.635451505016722,"#DB006A"],[0.638795986622073,"#DC0069"],[0.642140468227425,"#DC0068"],[0.645484949832776,"#DC0067"],[0.648829431438127,"#DD0067"],[0.652173913043478,"#DD0066"],[0.655518394648829,"#DE0065"],[0.65886287625418,"#DE0064"],[0.662207357859532,"#DE0064"],[0.665551839464883,"#DF0063"],[0.668896321070234,"#DF0062"],[0.672240802675585,"#E00061"],[0.675585284280936,"#E00061"],[0.678929765886288,"#E00060"],[0.682274247491639,"#E1005F"],[0.68561872909699,"#E1005E"],[0.688963210702341,"#E1005E"],[0.692307692307692,"#E2005D"],[0.695652173913043,"#E2005C"],[0.698996655518395,"#E3005B"],[0.702341137123746,"#E3005B"],[0.705685618729097,"#E3005A"],[0.709030100334448,"#E40059"],[0.712374581939799,"#E40058"],[0.71571906354515,"#E40057"],[0.719063545150502,"#E50057"],[0.722408026755853,"#E50056"],[0.725752508361204,"#E50055"],[0.729096989966555,"#E60054"],[0.732441471571906,"#E60054"],[0.735785953177257,"#E60053"],[0.739130434782609,"#E70052"],[0.74247491638796,"#E70051"],[0.745819397993311,"#E80050"],[0.749163879598662,"#E80050"],[0.752508361204013,"#E8004F"],[0.755852842809365,"#E9004E"],[0.759197324414716,"#E9004D"],[0.762541806020067,"#E9004D"],[0.765886287625418,"#EA004C"],[0.769230769230769,"#EA004B"],[0.77257525083612,"#EA004A"],[0.775919732441472,"#EB0049"],[0.779264214046823,"#EB0049"],[0.782608695652174,"#EB0048"],[0.785953177257525,"#EC0047"],[0.789297658862876,"#EC0046"],[0.792642140468227,"#EC0046"],[0.795986622073579,"#ED0045"],[0.79933110367893,"#ED0044"],[0.802675585284281,"#ED0043"],[0.806020066889632,"#EE0042"],[0.809364548494983,"#EE0042"],[0.812709030100334,"#EE0041"],[0.816053511705686,"#EF0040"],[0.819397993311037,"#EF003F"],[0.822742474916388,"#EF003E"],[0.826086956521739,"#F0003D"],[0.82943143812709,"#F0003D"],[0.832775919732441,"#F0003C"],[0.836120401337793,"#F0003B"],[0.839464882943144,"#F1003A"],[0.842809364548495,"#F10039"],[0.846153846153846,"#F10038"],[0.849498327759197,"#F20038"],[0.852842809364549,"#F20037"],[0.8561872909699,"#F20036"],[0.859531772575251,"#F30035"],[0.862876254180602,"#F30034"],[0.866220735785953,"#F30033"],[0.869565217391304,"#F40032"],[0.872909698996656,"#F40032"],[0.876254180602007,"#F40031"],[0.879598662207358,"#F50030"],[0.882943143812709,"#F5002F"],[0.88628762541806,"#F5002E"],[0.889632107023411,"#F5002D"],[0.892976588628763,"#F6002C"],[0.896321070234114,"#F6002B"],[0.899665551839465,"#F6002A"],[0.903010033444816,"#F70029"],[0.906354515050167,"#F70028"],[0.909698996655518,"#F70027"],[0.91304347826087,"#F80026"],[0.916387959866221,"#F80025"],[0.919732441471572,"#F80024"],[0.923076923076923,"#F80023"],[0.926421404682274,"#F90022"],[0.929765886287625,"#F90021"],[0.933110367892977,"#F90020"],[0.936454849498328,"#FA001F"],[0.939799331103679,"#FA001E"],[0.94314381270903,"#FA001D"],[0.946488294314381,"#FA001B"],[0.949832775919732,"#FB001A"],[0.953177257525084,"#FB0019"],[0.956521739130435,"#FB0018"],[0.959866220735786,"#FC0016"],[0.963210702341137,"#FC0015"],[0.966555183946488,"#FC0013"],[0.969899665551839,"#FC0012"],[0.973244147157191,"#FD0010"],[0.976588628762542,"#FD000F"],[0.979933110367893,"#FD000D"],[0.983277591973244,"#FE000B"],[0.986622073578595,"#FE0008"],[0.989966555183946,"#FE0006"],[0.993311036789298,"#FE0004"],[0.996655518394649,"#FF0002"],[1,"#FF0000"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":"Distance.Station","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["2000","4000","6000"],"tickvals":[0.305758359722333,0.615133757153703,0.924509154585073],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[24.927944,25.018716],"tickmode":"array","ticktext":["24.950","24.975","25.000"],"tickvals":[24.95,24.975,25],"categoryorder":"array","categoryarray":["24.950","24.975","25.000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Latitude","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.105,122.995],"tickmode":"array","ticktext":["30","60","90","120"],"tickvals":[30,60,90,120],"categoryorder":"array","categoryarray":["30","60","90","120"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"House.Price","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"166a069464ffc":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"166a069464ffc","visdat":{"166a069464ffc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>However, this can be hard to see - so instead we can plot the residuals, but have the x-axis as the the variable we think is affecting independence. For example</p>
<pre class="r"><code>housemodel            &lt;- lm(House.Price~Latitude,data=house)
house$price_predicted &lt;- housemodel$fitted.values
house$residuals       &lt;- housemodel$residuals

plot(house$Distance.Station, house$residuals)</code></pre>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-164-1.png" alt="These residuals do not look randomly distributed on the page.." width="672" />
<p class="caption">
These residuals do not look randomly distributed on the page..
</p>
</div>
<p>This definitely doesn’t look like a random cloud! It looks like distance to the station is really impacting the linear model between house price and latitude.</p>
<p>In this case we will use MULITPLE REGRESSION. (later in the course)</p>
</div>
<div id="if-your-data-includes-a-date-or-time-stamp" class="section level4 unnumbered">
<h4 class="unnumbered">If your data includes a date or time-stamp</h4>
<p>Then you have time-series data and there is an ENTIRE COURSE on modelling it (<a href="https://online.stat.psu.edu/stat510/" class="uri">https://online.stat.psu.edu/stat510/</a>). For now, if your data contains any time stamp or date, be very cautious. Changes are that your data contains auto-correlation e.g. the response tomorrow is likely to be affected by the response today.</p>
<p>In the short term, if you know the order in which your data was collected, you could plot a residuals/order plot as described here: <a href="https://online.stat.psu.edu/stat462/node/121/" class="uri">https://online.stat.psu.edu/stat462/node/121/</a>.</p>
</div>
<div id="if-your-data-includes-a-location" class="section level4 unnumbered">
<h4 class="unnumbered">If your data includes a location</h4>
<p>Spatial data is often not independent due to Tobler’s Law (close together things are more similar than those further apart). For example, imagine you were looking at the correlation between money spent on alcohol and undergraduate degree score Your relationship might be different in areas with lower drinking age-limits, or in countries where drinking is outlawed.</p>
<p>So knowing the location of your sample is important. The easiest thing we can do here to check for independence is to make a literal map of the residuals. For example, remember in lab 3 - let’s do something similar</p>
<pre class="r"><code># Command from the sf library
# Make a spatial version of the data using the Longitide and Latitude columns
library(sp)
library(sf)
house.spatial &lt;- st_as_sf(house,coords=c(&quot;Longitude&quot;,&quot;Latitude&quot;),crs = 4326)

library(tmap)
# make interactive, for static set as &quot;plot&quot;, for interactive set as &quot;view&quot;
tmap_mode(&quot;plot&quot;)

# Command from the tmap library
# and plot
qtm(&quot;Esri.WorldTopoMap&quot;) + 
     qtm(house.spatial, # data
         symbols.col=&quot;residuals&quot;, # which column for the symbols
         symbols.size=.4, # how big
         symbols.palette=&quot;RdBu&quot;,
         midpoint=0) # color breaks</code></pre>
<p>There definitely looks like the residuals are not randomly distributed in space, which makes me suspicious that there is spatial autocorrelation (e.g. correlation with itself - the location of a point impacts the residual).</p>
<p>We can test this through a statistic called Moran’s I - which compares the residual at each point against its residuals for surrounding points. In my spatial statistics course, we spend about 3 weeks on Moran’s I, so there is a lot of nuance we are skipping over here. For more, see <a href="https://mgimond.github.io/Spatial/spatial-autocorrelation.html" class="uri">https://mgimond.github.io/Spatial/spatial-autocorrelation.html</a> ### Checking Normality {#S.Tutorial.5B.4}</p>
<p>There are three things we might want to check around normality and regression - but essentially we are testing whether the RESIDUALS are normal around the regression line. To get the best estimates of parameters such as B0 and B1, the residuals must be normally distributed around the regression line. but this has a much smaller effect typically than non-linearity or breaking assumptions of independence.</p>
<p>Breaking normality is only important in the calculation of p values for significance testing and confidence intervals, but this is only a problem when the sample size is small. When the sample size is larger (&gt;200), the Central Limit Theorem ensures that the distribution of residuals will approximate normality when calculating parameters.</p>
<p>So never throw away your data if it breaks normality. But it’s good to take a look.</p>
<p>Let’s go back to our original test data:</p>
<pre class="r"><code>mymodel &lt;- lm(strength~alcohol,data=testdata)
plot(testdata$alcohol,testdata$strength,xlab=&quot;Alcohol&quot;,ylab=&quot;Strength&quot;,pch=16)
abline(mymodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<p>To test normality, we can use OLSRR to:</p>
<pre class="r"><code>#Create a QQ plot of the residuals
ols_plot_resid_qq(mymodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<pre class="r"><code>#Create a histogram of the residuals
ols_plot_resid_hist(mymodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-167-2.png" width="672" /></p>
<pre class="r"><code>#Run a Wilks-Shapiro test for normality
ols_test_normality(mymodel)</code></pre>
<pre><code>## -----------------------------------------------
##        Test             Statistic       pvalue  
## -----------------------------------------------
## Shapiro-Wilk              0.9877         0.8767 
## Kolmogorov-Smirnov        0.0502         0.9990 
## Cramer-von Mises          4.1667         0.0000 
## Anderson-Darling          0.1699         0.9289 
## -----------------------------------------------</code></pre>
<p>In this case, our residuals look very normal.</p>
<p>Compare that to our house dataset, which suggests that the data is mildly non normal.</p>
<pre class="r"><code>housemodel &lt;- lm(House.Price~Latitude,data=house)
plot(house$House.Price~house$Latitude,xlab=&quot;Latitude&quot;,ylab=&quot;House Price&quot;,pch=16)
abline(housemodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
<pre class="r"><code>#Create a QQ plot of the residuals
ols_plot_resid_qq(housemodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-168-2.png" width="672" /></p>
<pre class="r"><code>#Create a histogram of the residuals
ols_plot_resid_hist(housemodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-168-3.png" width="672" /></p>
<pre class="r"><code>#Run a Wilks-Shapiro test for normality
ols_test_normality(housemodel)</code></pre>
<pre><code>## -----------------------------------------------
##        Test             Statistic       pvalue  
## -----------------------------------------------
## Shapiro-Wilk              0.9411         0.0000 
## Kolmogorov-Smirnov        0.0776         0.0138 
## Cramer-von Mises          34.21          0.0000 
## Anderson-Darling          4.3556         0.0000 
## -----------------------------------------------</code></pre>
<p>The answer to non-normal data is to use a GLM (Generalised Linear Model), which again we will get to later in the semester.</p>
<p>Alternatively you can use your linear model, but make the significance level more rigorous (say 1% rather than 5%) to take into account the fact that the assumptions underpinning the calculations might be flawed.</p>
<p>In terms of detailed interpretation, read this page: <a href="https://online.stat.psu.edu/stat462/node/122/" class="uri">https://online.stat.psu.edu/stat462/node/122/</a></p>
</div>
<div id="S.Tutorial.5B.5" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Checking Equal Variance/homoskadisity</h3>
<p>The easiest thing to do here is to plot the residuals, then see if you see any variations in variance. For example in our house regression, the residuals look like this - you are looking for some areas where there are small residuals and some areas with large residuals (e.g. a cone shape, a bow-tie) vs just random dots.</p>
<pre class="r"><code>ols_plot_resid_fit(housemodel)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p>You can clearly see here that for low values of the fitted data, there is not much variance - but there is a lot of variance between 30-50</p>
<p>You can also run statistical tests, explained in more detail here: <a href="https://rpubs.com/tskam/Session06" class="uri">https://rpubs.com/tskam/Session06</a></p>
<pre class="r"><code># F test - assumes residuals are  independent and identically distributed (i.i.d.)
ols_test_f(housemodel)</code></pre>
<pre><code>## 
##  F Test for Heteroskedasticity
##  -----------------------------
##  Ho: Variance is homogenous
##  Ha: Variance is not homogenous
## 
##  Variables: fitted values of House.Price 
## 
##       Test Summary        
##  -------------------------
##  Num DF     =    1 
##  Den DF     =    412 
##  F          =    2.483727 
##  Prob &gt; F   =    0.1157969</code></pre>
<p>In this case, we can see that perhaps we need to worry less about unequal variance,</p>
<p>There is also another test available, the Breusch Pagan Test - but this relies on the residuals being normally distributed.</p>
</div>
</div>
</div>
<div id="confidence-and-prediction-intervals" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Confidence and Prediction Intervals</h1>
<div id="what-are-they" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> What are they?</h2>
<p>Essentially these are two different things:</p>
<p><strong>Confidence interval:</strong> “Error bar” on the location of the regression line at any specific value of x, or “what is the uncertainty on the population mean of <span class="math inline">\(y\)</span>, for a specific value of <span class="math inline">\(x\)</span>?”</p>
<p><strong>Prediction interval:</strong> Predicting the range of likely y-values for a new data-point, or “if you had to put a new dot on the scatterplot, what range of y values would it likely be found in</p>
<p>These are described in detail here:</p>
<ul>
<li><a href="https://online.stat.psu.edu/stat462/node/125/" class="uri">https://online.stat.psu.edu/stat462/node/125/</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/126/" class="uri">https://online.stat.psu.edu/stat462/node/126/</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/127/" class="uri">https://online.stat.psu.edu/stat462/node/127/</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/128/" class="uri">https://online.stat.psu.edu/stat462/node/128/</a></li>
</ul>
<p>In R, lets look at the pirate dataset</p>
<pre class="r"><code>#For our pirate weight/height dataset
lm.pirate &lt;- lm(weight~height,data=pirates)
summary(lm.pirate)</code></pre>
<pre><code>## 
## Call:
## lm(formula = weight ~ height, data = pirates)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.3592  -2.6564  -0.0708   2.7275  11.1451 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -68.87722    1.71250  -40.22   &lt;2e-16 ***
## height        0.81434    0.01003   81.16   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.928 on 998 degrees of freedom
## Multiple R-squared:  0.8684, Adjusted R-squared:  0.8683 
## F-statistic:  6587 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="calculating-a-confidence-interval" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Calculating a confidence interval</h2>
<pre class="r"><code># What are the AVERAGE WEIGHTS (and uncertainty on our estimate) 
# of pirates whose heights are 150cm and 170cm?
new.pirates &lt;- data.frame(height=c(150,170))
predict(lm.pirate,newdata=new.pirates,interval=&quot;confidence&quot;,level=0.95)</code></pre>
<pre><code>##        fit      lwr      upr
## 1 53.27345 52.80652 53.74037
## 2 69.56020 69.31640 69.80400</code></pre>
</div>
<div id="calculating-a-prediction-interval" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Calculating a prediction interval</h2>
<p>So we are 95% certain that on average, the AVERAGE weight of pirates who are 150cm tall falls between 52.8Kg and 53.74Kg</p>
<pre class="r"><code># A new pirate joins and her height is 160cm.  What range of weights is she likely to have?
new.pirates &lt;- data.frame(height=c(160))
predict(lm.pirate,newdata=new.pirates,interval=&quot;predict&quot;,level=0.95)</code></pre>
<pre><code>##        fit      lwr      upr
## 1 61.41682 53.70196 69.13169</code></pre>
<p>Her weight is likely to be somewhere between 53Kg and 69Kg with 95% certainty given our sample.</p>
</div>
</div>
<div id="outliers-leverage-and-influential-points" class="section level1" number="14">
<h1><span class="header-section-number">14</span> Outliers, leverage and influential points</h1>
<p>There are three key things to know when it comes to outliers:</p>
<ol style="list-style-type: decimal">
<li><p>We use the word <strong>outlier</strong> to describe an observation (point on the scatterplot) that has a very different response from the predicted response from the model e.g. it does not follow the trend determined by the rest of the dataset. We consider it an outlier <em>only</em> if it is an extreme “y” value e.g. an extreme response.</p></li>
<li><p>If a data point has an x-value that is extremely different (either too high or too low) from the rest of the data points, we call this a <strong>high leverage</strong> point. It might, or might not be an outlier.</p></li>
<li><p>We call a data point an <strong>influential point</strong> if that data point has a considerable impact on the regression model. For instance, if the model fit changes considerably by removing a point, such data point is called an influential point. Influential points tend to be further from the mean. We know the regression lines goes through the mean of x and the mean of y, they tent to tilt like a see-saw.</p></li>
</ol>
<p>Both outliers and the leverage points can be influential depending on where they located in a scatterplot. We can easily see them using a fits vs residuals plot (we’ll get to this below)</p>
<p>For more details here, see <a href="https://online.stat.psu.edu/stat501/lesson/11/11.1" class="uri">https://online.stat.psu.edu/stat501/lesson/11/11.1</a></p>
<div id="visual-inspection" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Visual inspection</h2>
<p>The first way we can check for simple linear regression is to plot the data and take a look. Here are some examples that we can assess by eye which show the different effects.</p>
<div id="no-outliers-influential-or-high-leverage-points" class="section level4 unnumbered">
<h4 class="unnumbered">No outliers, influential or high leverage points</h4>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-174-1.png" alt="No outliers, influential values or high leverage points" width="672" />
<p class="caption">
No outliers, influential values or high leverage points
</p>
</div>
<p>In the figure above, all of the data points follow the general trend of the rest of the data, so there are no outliers (in the y direction). And, none of the data points are extreme with respect to x, so there are no high leverage points. Overall, none of the data points would appear to be influential with respect to the location of the best fitting line. e.g. if we removed any one point, the line would probably be the same.</p>
</div>
<div id="an-outlier-with-no-leverage" class="section level4 unnumbered">
<h4 class="unnumbered">An outlier with no leverage</h4>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-175-1.png" alt="One outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed " width="672" />
<p class="caption">
One outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed
</p>
</div>
<p>In the figure above, most of the data points follow the general trend of the rest of the data, but there is one clear outlier (one point that is unusual in the y direction). However, no point has an extreme x value, so there are no high leverage points. Overall, none of the data points would appear to be influential with respect to the location of the best fitting line. e.g.when we removed the red point,the line of best fit remains relatively stable.</p>
</div>
<div id="a-high-leverage-point-that-isnt-an-outlier" class="section level4 unnumbered">
<h4 class="unnumbered">A high leverage point that isn’t an outlier</h4>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-176-1.png" alt="No outliers,but one high leverage point. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed" width="672" />
<p class="caption">
No outliers,but one high leverage point. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed
</p>
</div>
<p>In the figure above, most of the data points follow the general trend of the rest of the data, so there are no outliers (in the y direction). But one data points is extreme with respect to x. Overall, none of the data points would appear to be influential with respect to the location of the best fitting line. e.g.when we removed the red point,the line of best fit remained relatively stable.</p>
</div>
<div id="an-influential-high-leverage-outlier" class="section level4 unnumbered">
<h4 class="unnumbered">An influential high leverage outlier</h4>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-177-1.png" alt="One influential high leverage outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed" width="672" />
<p class="caption">
One influential high leverage outlier. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed
</p>
</div>
<p>In the figure above, most of the data points follow the general trend of the rest of the data, with one clear outlier. This point also has high leverage abd appears to be very influential. e.g.when we removed the red point,the line of best fit changes hugely,</p>
<p>Here with a simple regression, we can easily see outliers. This is much harder when we have many predictors. So as well as examining the data by eye, we can use diagnostic plots.</p>
</div>
</div>
<div id="detecting-leverage" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Detecting leverage</h2>
<p>Leverage (<span class="math inline">\(h_{ii}\)</span>): is used for for measuring unusual observations in x-direction (high leverage point). Essentially, the leverage quantifies the influence that the observed response has on its predicted value. That is, if the leverage is small, then the observed response plays only a small role in the value of the predicted/modelled response. On the other hand, if the leverage is large, then the observed response plays a large role in the value of the predicted response.</p>
<p>This quantity is based on</p>
<ul>
<li>The distance of <span class="math inline">\(x_{i}\)</span> from the bulk of the x’s.</li>
<li>The extent tjat the fitted regression line is attracted by the given point.</li>
</ul>
<p>The Leverage, <span class="math inline">\(h_{ii}\)</span> associated with the ith datapoint is:</p>
<p><span class="math display">\[h_{ii}=\frac{1}{n}+\frac{\left(x_i-\overline{\left(x\right)}\right)^2}{\ \left\{\sum_{i=1}^n\left(x_j-\overline{\left\{x\right\}}\right)^2\right\}}\]</span></p>
<p>and is described further in <a href="https://online.stat.psu.edu/stat501/lesson/11/11.2" class="uri">https://online.stat.psu.edu/stat501/lesson/11/11.2</a></p>
<p>You don’t need to remember the equation as R does the calculation for you, but here are some important properties of the leverages:</p>
<ol style="list-style-type: decimal">
<li>The leverage is a measure of the distance between the x value for the data point and the mean of the x values for all n data points.</li>
<li>The leverage is a number between 0 and 1, inclusive.</li>
<li>The sum of the equals p, the number of parameters (regression coefficients including the intercept).</li>
</ol>
<p>A rule of thumb would be to classify classify <span class="math inline">\(x_{i}\)</span> as a high leverage point if</p>
<p><span class="math display">\[h_{ii}&gt;\frac{2p}{n}\]</span> where p = number of regression coefficients (2 for SLR) and n = number of observations</p>
<p>We can calculate and plot the leverage easily for each point in either the base package (<code>hatvalues</code>), or using OLSRR (<code>ols_leverage</code>).</p>
<p>Let’s see how this works for our scenarios above. If you are coding this, you don’t necessarily need the left hand plot - but it’s helpful for me showing you what is going on.</p>
<pre class="r"><code># read the data
data &lt;- read.csv(&quot;neither.csv&quot;)

#calculate the model
model &lt;- lm(y~x,data=data)
leverage &lt;- ols_leverage(model) 

# Set up 2 sub-plots one next to each other
layout(matrix(c(1,2), 1, 2, byrow = TRUE))

# plot 1 (left hand side)
plot(data$x,data$y,pch=16,xlab=&quot;x&quot;,ylab=&quot;y&quot;,main=&quot;Dataset A&quot;); 
abline(model)

# plot 2 (right hand side). Remember to choose your own ylim
plot(data$x,leverage,pch=16,ylim=c(0,.6),
     xlab=&quot;x&quot;,ylab=&quot;y&quot;,type=&quot;h&quot;,
     main=&quot;Dataset A leverage&quot;); 

# Calculate the critical value of leverage and add to plot
n=nrow(data)
p=length(coefficients(model))
cutLev=2*p/n
abline(h=cutLev,col=&quot;blue&quot;,lty=2)</code></pre>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-178-1.png" alt="No outliers, influential values or high leverage points.  Thr highest x point is around the threshold for high leverage, but nothing special here" width="672" />
<p class="caption">
No outliers, influential values or high leverage points. Thr highest x point is around the threshold for high leverage, but nothing special here
</p>
</div>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-179-1.png" alt="No outliers,but one high leverage point. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed" width="672" />
<p class="caption">
No outliers,but one high leverage point. The red-dashed line is the model including all the points. The black-solid line is the model with the red point removed
</p>
</div>
<div id="an-important-distinction" class="section level4 unnumbered">
<h4 class="unnumbered">An important distinction!</h4>
<p>There is such an important distinction between a data point that has high leverage and one that has high influence that it is worth saying it one more time:</p>
<ul>
<li>The leverage merely quantifies the potential for a data point to exert strong influence on the regression analysis.</li>
<li>The leverage depends only on the predictor values.</li>
<li>Whether the data point is influential or not also depends on the observed value of the reponse.</li>
</ul>
</div>
</div>
<div id="detecting-outliers" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Detecting outliers</h2>
<p>In lab 5, we mentioned two measures that we use to help identify outliers. They are:</p>
<ul>
<li>Residuals</li>
<li>Studentized residuals (or internally studentized residuals) (often called standardized residuals)</li>
</ul>
<p>First, briefly review these measures using this page: <a href="https://online.stat.psu.edu/stat501/lesson/11/11.3" class="uri">https://online.stat.psu.edu/stat501/lesson/11/11.3</a></p>
<p>OLSRR also offers several more plots and tests including :</p>
<ul>
<li>Cook’s D Bar Plot</li>
<li>Cook’s D Chart</li>
<li>DFBETAs Panel</li>
<li>DFFITs Plot</li>
<li>Studentized Residual Plot</li>
<li>Standardized Residual Chart</li>
<li>Studentized Residuals vs Leverage Plot</li>
<li>Deleted Studentized Residual vs Fitted Values Plot</li>
<li>Hadi Plot</li>
<li>Potential Residual Plot</li>
</ul>
<p>For now, we will focus on one of the most effective ways to assess residuals, the studentized residual/fits plot.</p>
<p>For example for our test data:</p>
<pre class="r"><code># read the data
data &lt;- read.csv(&quot;neither.csv&quot;)

#calculate the model
model &lt;- lm(y~x,data=data)
leverage &lt;- ols_leverage(model) 

# plot 1 (left hand side)
plot(data$x,data$y,pch=16,xlab=&quot;x&quot;,ylab=&quot;y&quot;,main=&quot;Dataset C&quot;); 
abline(model)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<pre class="r"><code># plot 2 (right hand side). Remember to choose your own ylim
ols_plot_resid_stud(model)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-180-2.png" width="672" /></p>
<p>There should be no absolute cut-off here (around 2-3 is a warning sign). Instead, take these as an opportunity to explore those points further. For example here is our plot with the residual:</p>
<pre class="r"><code># read the data
data1 &lt;- read.csv(&quot;outlier.csv&quot;)

#calculate the model
model1 &lt;- lm(y~x,data=data1)

# plot 1 (left hand side)
plot(data1$x,data1$y,pch=16,xlab=&quot;x&quot;,ylab=&quot;y&quot;,main=&quot;Dataset B&quot;); 
abline(model1)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<pre class="r"><code># plot 2 (right hand side). Remember to choose your own ylim
ols_plot_resid_stand(model1)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-181-2.png" width="672" /></p>
<p>Here the plot is telling me that it thinks row 21 of the dataset might be an outlier</p>
<pre class="r"><code>data1[21,]</code></pre>
<pre><code>##    x  y
## 21 4 40</code></pre>
</div>
<div id="Tutorial.6AC" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Detecting influential points</h2>
<p>If a point is both an outlier AND has leverage, chances are it will be influential over the fit.</p>
<p>OLSRR has a nice way of summarising both statistics. For example here are our four plots together:</p>
<pre class="r"><code># read the data
data &lt;- read.csv(&quot;neither.csv&quot;)
data2 &lt;- read.csv(&quot;outlier.csv&quot;)
data2b &lt;- data2[-21,]
data3 &lt;- read.csv(&quot;leverage.csv&quot;)
data3b &lt;- data3[-25,]
data4 &lt;- read.csv(&quot;influential.csv&quot;)
data4b &lt;- data4[-25,]

#calculate the model
model &lt;- lm(y~x,data=data)
model2 &lt;- lm(y~x,data=data2)
model3 &lt;- lm(y~x,data=data3)
model4 &lt;- lm(y~x,data=data4)

# Set up 4 sub-plots one next to each other
layout(matrix(c(1,2,3,4), 2, 2, byrow = TRUE))

plot(data$x,data$y,pch=16,xlab=&quot;x&quot;,ylab=&quot;y&quot;,main=&quot;Dataset A&quot;,col=&quot;black&quot;) 
abline(model)

plot(data2$x,data2$y,pch=16,xlab=&quot;x&quot;,ylab=&quot;y&quot;,main=&quot;Dataset B&quot;,col=&quot;red&quot;) 
lines(data2b$x,data2b$y,pch=16,type=&quot;p&quot;)
abline(model2)

plot(data3$x,data3$y,pch=16,xlab=&quot;x&quot;,ylab=&quot;y&quot;,main=&quot;Dataset C&quot;,col=&quot;red&quot;) 
lines(data3b$x,data3b$y,pch=16,type=&quot;p&quot;)
abline(model3)

plot(data4$x,data4$y,pch=16,xlab=&quot;x&quot;,ylab=&quot;y&quot;,main=&quot;Dataset D&quot;,col=&quot;red&quot;,ylim=c(0,100)) 
lines(data4b$x,data4b$y,pch=16,type=&quot;p&quot;)
abline(model4)</code></pre>
<div class="figure">
<img src="T1_R_Basics_files/figure-html/unnamed-chunk-183-1.png" alt="Our four examples" width="672" />
<p class="caption">
Our four examples
</p>
</div>
<pre class="r"><code># model A
ols_plot_resid_lev(model)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<pre class="r"><code># model B
ols_plot_resid_lev(model2)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-184-2.png" width="672" /></p>
<pre class="r"><code># model C
ols_plot_resid_lev(model3)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-184-3.png" width="672" /></p>
<pre class="r"><code># model D
ols_plot_resid_lev(model4)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-184-4.png" width="672" /></p>
<p>Cook’s Distance is another method for identifying influential points</p>
<p>Cook’s distance, <span class="math inline">\(D_i\)</span>, is measured by deleting one observation at a time and each time re-fitting the regression line on the remaining observations. By comparing the results from the n observations to the results with ith observation deleted, we can get an idea about the influence from the ith observation on the fitted model.</p>
<p>While there is no set cut-off for flagging a datapoint as an influential point, an observation with <span class="math inline">\(D_i\)</span> would most likely be an influential point.</p>
<p>Again for our four examples:</p>
<pre class="r"><code># model A
ols_plot_cooksd_bar(model)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<pre class="r"><code># model B
ols_plot_cooksd_bar(model2)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-185-2.png" width="672" /></p>
<pre class="r"><code># model C
ols_plot_cooksd_bar(model3)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-185-3.png" width="672" /></p>
<pre class="r"><code># model D
ols_plot_cooksd_bar(model4)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-185-4.png" width="672" /></p>
</div>
<div id="making-a-table-of-your-residual-diagnostics" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Making a table of your residual diagnostics</h2>
<p>If your data is not huge, making a table of your residual diagnostics often makes it much easier to work out which points you are looking at.</p>
<p>In fact we can do this very easily simply by making new columns in our table of data. Let’s try it with our influential dataset.</p>
<pre class="r"><code>testdata &lt;- read.csv(&quot;influential.csv&quot;)
mymodel &lt;- lm(y~x,data=testdata)

# Make a new column with the predicted y value
testdata$y_predicted &lt;- mymodel$fitted.values

# Make a new column with the raw residuals
testdata$residuals_raw &lt;- mymodel$residuals

# Make a new column with the standardisd/studentised residuals
library(MASS)
testdata$residuals_stud &lt;- studres(mymodel)

# Make a new column with the leverage
testdata$x_leverage &lt;- ols_leverage(mymodel)

# Make a new column with the Cook&#39;s distance. OLSRR package
testdata$cooks.distance &lt;- cooks.distance(mymodel)

# Print out the table
head(testdata)</code></pre>
<pre><code>##         x       y y_predicted residuals_raw residuals_stud x_leverage
## 1  7.4359 19.5433    18.86669     0.6766147     0.06528349 0.07647225
## 2 20.2564 30.3125    27.04441     3.2680919     0.31064806 0.04447583
## 3 14.6154 18.3894    23.44622    -5.0568228    -0.48479619 0.05476095
## 4  9.2308  7.2356    20.01159   -12.7759856    -1.27279635 0.07013913
## 5 34.3590 35.3125    36.03994    -0.7274351    -0.06901578 0.04484163
## 6 40.7692 60.3125    40.12876    20.1837353     2.11410204 0.05732357
##   cooks.distance
## 1   0.0001844385
## 2   0.0023377280
## 3   0.0070421925
## 4   0.0594946602
## 5   0.0001168648
## 6   0.1180798516</code></pre>
<p>If you click on the NAME of the table (e.g. testdata in the environment tab) then it will open the table in a new tab which makes it easier to view things.</p>
<div class="figure">
<img src="Figures/Fig06_3Table.png" alt="How to sort the table in R-Studio. click the tiny arrows" width="769" />
<p class="caption">
How to sort the table in R-Studio. click the tiny arrows
</p>
</div>
<p>If you’re sick of looking at things in R, you can save the table to a csv file and open it in excel. If you are running your project, this should save into the folder where your project file is (you can add a different directory if required)</p>
<pre class="r"><code>write.csv(testdata,&quot;Output.csv&quot;,quote=FALSE)</code></pre>
<p>Finally, there might be too much data to look at things manually. You can now use commands like filter on your new table to find which rows are of interest</p>
<pre class="r"><code># Filter rows with high cooks distance
dplyr::filter(testdata,  cooks.distance&gt;1)</code></pre>
<pre><code>##          x  y y_predicted residuals_raw residuals_stud x_leverage
## 1 101.5385 50    78.89125     -28.89125      -7.870108  0.5580226
##   cooks.distance
## 1       10.71394</code></pre>
<p>If you decide to remove an outlier, you can do it in excel! (save the file as something new first, then read that back in).</p>
<p>Or you can remove a specific row with the - symbol</p>
<pre class="r"><code>row_highcooks &lt;- which(testdata$cooks.distance &gt; 1)
print(paste(&quot;Row number: &quot;, row_highcooks))</code></pre>
<pre><code>## [1] &quot;Row number:  25&quot;</code></pre>
<pre class="r"><code>newdata &lt;- testdata[-row_highcooks]

## BE CAREFUL.  AS YOU REMOVE A DATA POINT ALL THE ROW NUMBERS WILL SHIFT AROUND, SO RUN THE WHICH COMMAND EACH TIME</code></pre>
<p>Or you can simply use filter the other way around, but again be careful that you only remove the data you mean to</p>
<pre class="r"><code># Filter rows with high cooks distance
newdata &lt;- dplyr::filter(testdata,  cooks.distance &lt;= 1)</code></pre>
<p><br></p>
</div>
</div>
<div id="transformations" class="section level1" number="15">
<h1><span class="header-section-number">15</span> Transformations</h1>
<p>We will talk in the class (or read here! <a href="https://online.stat.psu.edu/stat501/lesson/9" class="uri">https://online.stat.psu.edu/stat501/lesson/9</a> ) about <em>why</em> to apply transformations. Here I will simply show you how.</p>
<p>This is very similar to the method in 6a. We simply make a new column and use maths to fill in the value.</p>
<p>For example:</p>
<pre class="r"><code># read the data
data &lt;- read.csv(&quot;neither.csv&quot;)
head(data)</code></pre>
<pre><code>##         x       y
## 1 10.2564 16.4663
## 2  3.0769  4.9279
## 3 15.1282 26.4663
## 4 27.4359 30.3125
## 5 12.0513 13.7740
## 6 23.0769 13.7740</code></pre>
<p>To make a column with <span class="math inline">\(\frac{1}{x}\)</span> as the predictor, we do</p>
<pre class="r"><code># Note I am trying to avoid spaces  or special characters in my data
data$transform_1overx &lt;- 1/data$x</code></pre>
<p>To make a column with <span class="math inline">\(x^2\)</span> as the predictor, we do</p>
<pre class="r"><code># Note I am trying to avoid spaces  or special characters in my data
data$transform_xsquare &lt;- data$x^2</code></pre>
<p>To make a column with <span class="math inline">\(\log(x)\)</span> as the predictor, we do (this is the NATURAL LOG)</p>
<pre class="r"><code># Note I am trying to avoid spaces  or special characters in my data
data$transform_lnx &lt;- log(data$x)</code></pre>
<p>To make a column with <span class="math inline">\(\log_{10}(x)\)</span> as the predictor, we do</p>
<pre class="r"><code># Note I am trying to avoid spaces  or special characters in my data
data$transform_logx &lt;- log(data$x,base=10)</code></pre>
<p>To make a column with <span class="math inline">\(\sqrt{x}\)</span> as the predictor, we do</p>
<pre class="r"><code># Note I am trying to avoid spaces  or special characters in my data
data$transform_sqrtx &lt;- sqrt(data$x)</code></pre>
<p>And let’s see the output</p>
<pre class="r"><code>head(data)</code></pre>
<pre><code>##         x       y transform_1overx transform_xsquare transform_lnx
## 1 10.2564 16.4663       0.09750010        105.193741      2.327902
## 2  3.0769  4.9279       0.32500244          9.467314      1.123923
## 3 15.1282 26.4663       0.06610172        228.862435      2.716561
## 4 27.4359 30.3125       0.03644859        752.728609      3.311852
## 5 12.0513 13.7740       0.08297860        145.233832      2.489173
## 6 23.0769 13.7740       0.04333338        532.543314      3.138832
##   transform_logx transform_sqrtx
## 1      1.0109950        3.202561
## 2      0.4881134        1.754109
## 3      1.1797873        3.889499
## 4      1.4383192        5.237929
## 5      1.0810339        3.471498
## 6      1.3631775        4.803842</code></pre>
<p>We could now perform our linear regression with any of these as our predictor. For example</p>
<pre class="r"><code>newmodel &lt;- lm(y~transform_sqrtx,data=data)
plot(data$y~data$transform_sqrtx,xlab=&quot;Sqrt(x) UNITS&quot;,ylab=&quot;y UNITS&quot;)</code></pre>
<p><img src="T1_R_Basics_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<p>You don’t <em>have</em> to make a new column in advance, you can do the maths within the regression itself:</p>
<pre class="r"><code>newmodel2 &lt;- lm(y~sqrt(x),data=data)

# For Polynomial regression you can use the poly command e.g. X+X^2 

newmodel3 &lt;- lm(y ~ poly(x,2),data=data)</code></pre>
<pre class="r"><code>summary(newmodel3)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ poly(x, 2), data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.945  -6.344   1.280   6.887  15.652 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   56.823      1.936  29.352  &lt; 2e-16 ***
## poly(x, 2)1  144.687     10.244  14.124 2.03e-13 ***
## poly(x, 2)2   -7.937     10.244  -0.775    0.446    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.24 on 25 degrees of freedom
## Multiple R-squared:  0.8889, Adjusted R-squared:  0.8801 
## F-statistic:   100 on 2 and 25 DF,  p-value: 1.174e-12</code></pre>
<pre class="r"><code>equatiomatic::extract_eq(newmodel3)</code></pre>
<p><span class="math display">\[
\operatorname{y} = \alpha + \beta_{1}(\operatorname{x}) + \beta_{2}(\operatorname{x^2}) + \epsilon
\]</span></p>
</div>
<div id="basic-model-comparisons" class="section level1" number="16">
<h1><span class="header-section-number">16</span> Basic model comparisons</h1>
<p>You are now being asked to assess two (or more) models and decide “which is best”.</p>
<p>We will talk about this in more detail later in the semester, but for now, there are two easy ways we can compare different models.</p>
<div id="coefficient-of-determination-r2" class="section level5 unnumbered">
<h5 class="unnumbered">Coefficient of Determination <span class="math inline">\(R^2\)</span></h5>
<p>We could look first at the coefficient of variation for each model in the model summary. e.g. which model explains more variation in your response variable.</p>
</div>
<div id="aic" class="section level5 unnumbered">
<h5 class="unnumbered">AIC</h5>
<p>There is another measure called AIC (read more here: <a href="https://online.stat.psu.edu/stat501/lesson/10/10.5" class="uri">https://online.stat.psu.edu/stat501/lesson/10/10.5</a>). For now, know that the lower the AIC, the “better” the model. This is a non parametric test that takes into account the number of predictors and the amount of data, so is often more robust to bad linear fits than <span class="math inline">\(R^2\)</span> (which needs LINE to be true)</p>
<p>Let’s compare two models now, using our transformed data:</p>
<pre class="r"><code>model1 &lt;- lm(y~x,data=data)
model2 &lt;- lm(y~sqrt(x),data=data)

model1summary &lt;- summary(model1)
model2summary &lt;- summary(model2)

# Adjusted R2
paste(&quot;Model 1:&quot;,round(model1summary$adj.r.squared,2) )</code></pre>
<pre><code>## [1] &quot;Model 1: 0.88&quot;</code></pre>
<pre class="r"><code>paste(&quot;Model 2:&quot;,round(model2summary$adj.r.squared,2) )</code></pre>
<pre><code>## [1] &quot;Model 2: 0.87&quot;</code></pre>
<pre class="r"><code># AIC
AIC(model1,model2)</code></pre>
<pre><code>##        df      AIC
## model1  3 213.2457
## model2  3 216.4706</code></pre>
<p>We can see here that although <span class="math inline">\(adj-R^2\)</span> is higher for model 2, the AIC suggests that model 1 does a better job.</p>
<p>YOU SHOULD NEVER USE THESE NUMBERS IN ISOLATION. Also look at the data and use your common sense. Use them as guidelines.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
